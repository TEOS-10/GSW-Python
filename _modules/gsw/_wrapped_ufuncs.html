

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>gsw._wrapped_ufuncs &mdash; gsw 3.6.21 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=9edc463e" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=b536254c"></script>
      <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            gsw
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gsw.html">Subpackages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gsw_flat.html">All functions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">gsw</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">gsw._wrapped_ufuncs</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for gsw._wrapped_ufuncs</h1><div class="highlight"><pre>
<span></span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Auto-generated wrapper for C ufunc extension; do not edit!</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">_gsw_ufuncs</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">._utilities</span><span class="w"> </span><span class="kn">import</span> <span class="n">match_args_return</span>


<div class="viewcode-block" id="adiabatic_lapse_rate_from_CT">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.adiabatic_lapse_rate_from_CT">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">adiabatic_lapse_rate_from_CT</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the adiabatic lapse rate of sea water from Conservative</span>
<span class="sd">    Temperature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    adiabatic_lapse_rate : array-like, K/Pa</span>
<span class="sd">        adiabatic lapse rate</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See Eqn. (2.22.1) of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">adiabatic_lapse_rate_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">adiabatic_lapse_rate_from_CT</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">adiabatic_lapse_rate_from_ct</span><span class="o">.</span><span class="n">types</span>
<span class="n">adiabatic_lapse_rate_from_CT</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">adiabatic_lapse_rate_from_CT</span><span class="p">)</span>

<div class="viewcode-block" id="adiabatic_lapse_rate_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.adiabatic_lapse_rate_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">adiabatic_lapse_rate_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the adiabatic lapse rate of ice.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    adiabatic_lapse_rate_ice : array-like, K/Pa</span>
<span class="sd">        adiabatic lapse rate</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">adiabatic_lapse_rate_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">adiabatic_lapse_rate_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">adiabatic_lapse_rate_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">adiabatic_lapse_rate_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">adiabatic_lapse_rate_ice</span><span class="p">)</span>

<div class="viewcode-block" id="alpha">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.alpha">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">alpha</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the thermal expansion coefficient of seawater with respect to</span>
<span class="sd">    Conservative Temperature using the computationally-efficient expression</span>
<span class="sd">    for specific volume in terms of SA, CT and p (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    alpha : array-like, 1/K</span>
<span class="sd">        thermal expansion coefficient</span>
<span class="sd">        with respect to Conservative Temperature</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqn. (2.18.3) of this TEOS-10 manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">alpha</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">alpha</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">alpha</span><span class="o">.</span><span class="n">types</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>

<div class="viewcode-block" id="alpha_on_beta">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.alpha_on_beta">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">alpha_on_beta</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates alpha divided by beta, where alpha is the thermal expansion</span>
<span class="sd">    coefficient and beta is the saline contraction coefficient of seawater</span>
<span class="sd">    from Absolute Salinity and Conservative Temperature.  This function uses</span>
<span class="sd">    the computationally-efficient expression for specific volume in terms of</span>
<span class="sd">    SA, CT and p (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    alpha_on_beta : array-like, g kg^-1 K^-1</span>
<span class="sd">        thermal expansion coefficient with respect to</span>
<span class="sd">        Conservative Temperature divided by the saline</span>
<span class="sd">        contraction coefficient at constant Conservative</span>
<span class="sd">        Temperature</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix A.20 and appendix K of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2014: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">alpha_on_beta</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">alpha_on_beta</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">alpha_on_beta</span><span class="o">.</span><span class="n">types</span>
<span class="n">alpha_on_beta</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">alpha_on_beta</span><span class="p">)</span>

<div class="viewcode-block" id="alpha_wrt_t_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.alpha_wrt_t_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">alpha_wrt_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the thermal expansion coefficient of seawater with respect to</span>
<span class="sd">    in-situ temperature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    alpha_wrt_t_exact : array-like, 1/K</span>
<span class="sd">        thermal expansion coefficient</span>
<span class="sd">        with respect to in-situ temperature</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See Eqn. (2.18.1) of this TEOS-10 manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">alpha_wrt_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">alpha_wrt_t_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">alpha_wrt_t_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">alpha_wrt_t_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">alpha_wrt_t_exact</span><span class="p">)</span>

<div class="viewcode-block" id="alpha_wrt_t_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.alpha_wrt_t_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">alpha_wrt_t_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the thermal expansion coefficient of ice with respect to</span>
<span class="sd">    in-situ temperature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    alpha_wrt_t_ice : array-like, 1/K</span>
<span class="sd">        thermal expansion coefficient of ice with respect</span>
<span class="sd">        to in-situ temperature</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See Eqn. (2.18.1) of this TEOS-10 manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">alpha_wrt_t_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">alpha_wrt_t_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">alpha_wrt_t_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">alpha_wrt_t_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">alpha_wrt_t_ice</span><span class="p">)</span>

<div class="viewcode-block" id="beta">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.beta">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">beta</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the saline (i.e. haline) contraction coefficient of seawater</span>
<span class="sd">    at constant Conservative Temperature using the computationally-efficient</span>
<span class="sd">    75-term expression for specific volume in terms of SA, CT and p</span>
<span class="sd">    (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    beta : array-like, kg/g</span>
<span class="sd">        saline contraction coefficient</span>
<span class="sd">        at constant Conservative Temperature</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqn. (2.19.3) of this TEOS-10 manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">beta</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">types</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>

<div class="viewcode-block" id="beta_const_t_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.beta_const_t_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">beta_const_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the saline (i.e. haline) contraction coefficient of seawater</span>
<span class="sd">    at constant in-situ temperature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    beta_const_t_exact : array-like, kg/g</span>
<span class="sd">        saline contraction coefficient</span>
<span class="sd">        at constant in-situ temperature</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqn. (2.19.1) of this TEOS-10 manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">beta_const_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">beta_const_t_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">beta_const_t_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">beta_const_t_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">beta_const_t_exact</span><span class="p">)</span>

<div class="viewcode-block" id="C_from_SP">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.C_from_SP">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">C_from_SP</span><span class="p">(</span><span class="n">SP</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates conductivity, C, from (SP,t,p) using PSS-78 in the range</span>
<span class="sd">    2 &lt; SP &lt; 42.  If the input Practical Salinity is less than 2 then a</span>
<span class="sd">    modified form of the Hill et al. (1986) formula is used for Practical</span>
<span class="sd">    Salinity.  The modification of the Hill et al. (1986) expression is to</span>
<span class="sd">    ensure that it is exactly consistent with PSS-78 at SP = 2.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SP : array-like</span>
<span class="sd">        Practical Salinity (PSS-78), unitless</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    C : array-like, mS/cm</span>
<span class="sd">        conductivity</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The conductivity ratio returned by this function is consistent with the</span>
<span class="sd">    input value of Practical Salinity, SP, to 2x10^-14 psu over the full</span>
<span class="sd">    range of input parameters (from pure fresh water up to SP = 42 psu).</span>
<span class="sd">    This error of 2x10^-14 psu is machine precision at typical seawater</span>
<span class="sd">    salinities.  This accuracy is achieved by having four different</span>
<span class="sd">    polynomials for the starting value of Rtx (the square root of Rt) in</span>
<span class="sd">    four different ranges of SP, and by using one and a half iterations of</span>
<span class="sd">    a computationally efficient modified Newton-Raphson technique (McDougall</span>
<span class="sd">    and Wotherspoon, 2013) to find the root of the equation.</span>

<span class="sd">    Note that strictly speaking PSS-78 (Unesco, 1983) defines Practical</span>
<span class="sd">    Salinity in terms of the conductivity ratio, R, without actually</span>
<span class="sd">    specifying the value of C(35,15,0) (which we currently take to be</span>
<span class="sd">    42.9140 mS/cm).</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    Hill, K.D., T.M. Dauphinee and D.J. Woods, 1986: The extension of the</span>
<span class="sd">    Practical Salinity Scale 1978 to low salinities. IEEE J. Oceanic Eng.,</span>
<span class="sd">    OE-11, 1, 109 - 112.</span>

<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix E of this TEOS-10 Manual.</span>

<span class="sd">    McDougall T. J. and S. J. Wotherspoon, 2013: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>

<span class="sd">    Unesco, 1983: Algorithms for computation of fundamental properties of</span>
<span class="sd">    seawater. Unesco Technical Papers in Marine Science, 44, 53 pp.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">c_from_sp</span><span class="p">(</span><span class="n">SP</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">C_from_SP</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">c_from_sp</span><span class="o">.</span><span class="n">types</span>
<span class="n">C_from_SP</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">C_from_SP</span><span class="p">)</span>

<div class="viewcode-block" id="cabbeling">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.cabbeling">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">cabbeling</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the cabbeling coefficient of seawater with respect to</span>
<span class="sd">    Conservative Temperature.  This function uses the computationally-</span>
<span class="sd">    efficient expression for specific volume in terms of SA, CT and p</span>
<span class="sd">    (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cabbeling : array-like, 1/K^2</span>
<span class="sd">        cabbeling coefficient with respect to</span>
<span class="sd">        Conservative Temperature.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqns. (3.9.2) and (P.4) of this TEOS-10 manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">cabbeling</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">cabbeling</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">cabbeling</span><span class="o">.</span><span class="n">types</span>
<span class="n">cabbeling</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">cabbeling</span><span class="p">)</span>

<div class="viewcode-block" id="chem_potential_water_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.chem_potential_water_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">chem_potential_water_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the chemical potential of water in ice from in-situ</span>
<span class="sd">    temperature and pressure.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    chem_potential_water_ice : array-like, J/kg</span>
<span class="sd">        chemical potential of ice</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">chem_potential_water_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">chem_potential_water_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">chem_potential_water_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">chem_potential_water_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">chem_potential_water_ice</span><span class="p">)</span>

<div class="viewcode-block" id="chem_potential_water_t_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.chem_potential_water_t_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">chem_potential_water_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the chemical potential of water in seawater.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    chem_potential_water_t_exact : array-like, J/g</span>
<span class="sd">        chemical potential of water in seawater</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">chem_potential_water_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">chem_potential_water_t_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">chem_potential_water_t_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">chem_potential_water_t_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">chem_potential_water_t_exact</span><span class="p">)</span>

<div class="viewcode-block" id="cp_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.cp_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">cp_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the isobaric heat capacity of ice.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cp_ice : array-like, J kg^-1 K^-1</span>
<span class="sd">        heat capacity of ice</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">cp_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">cp_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">cp_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">cp_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">cp_ice</span><span class="p">)</span>

<div class="viewcode-block" id="cp_t_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.cp_t_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">cp_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the isobaric heat capacity of seawater.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cp_t_exact : array-like, J/(kg*K)</span>
<span class="sd">        heat capacity of seawater</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">cp_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">cp_t_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">cp_t_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">cp_t_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">cp_t_exact</span><span class="p">)</span>

<div class="viewcode-block" id="CT_first_derivatives">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.CT_first_derivatives">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">CT_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">pt</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following two derivatives of Conservative Temperature</span>
<span class="sd">    (1) CT_SA, the derivative with respect to Absolute Salinity at</span>
<span class="sd">    constant potential temperature (with pr = 0 dbar), and</span>
<span class="sd">    2) CT_pt, the derivative with respect to potential temperature</span>
<span class="sd">    (the regular potential temperature which is referenced to 0 dbar)</span>
<span class="sd">    at constant Absolute Salinity.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    pt : array-like</span>
<span class="sd">        Potential temperature referenced to a sea pressure, degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CT_SA : array-like, K/(g/kg)</span>
<span class="sd">        The derivative of Conservative Temperature with respect to</span>
<span class="sd">        Absolute Salinity at constant potential temperature</span>
<span class="sd">        (the regular potential temperature which has reference</span>
<span class="sd">        sea pressure of 0 dbar).</span>
<span class="sd">    CT_pt : array-like, unitless</span>
<span class="sd">        The derivative of Conservative Temperature with respect to</span>
<span class="sd">        potential temperature (the regular one with pr = 0 dbar)</span>
<span class="sd">        at constant SA. CT_pt is dimensionless.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See Eqns. (A.12.3a,b) and (A.15.8) of this TEOS-10 Manual.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span></div>

<span class="n">CT_first_derivatives</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_first_derivatives</span><span class="o">.</span><span class="n">types</span>
<span class="n">CT_first_derivatives</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">CT_first_derivatives</span><span class="p">)</span>

<div class="viewcode-block" id="CT_first_derivatives_wrt_t_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.CT_first_derivatives_wrt_t_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">CT_first_derivatives_wrt_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following three derivatives of Conservative Temperature.</span>
<span class="sd">    These derivatives are done with respect to in-situ temperature t (in the</span>
<span class="sd">    case of CT_T_wrt_t) or at constant in-situ tempertature (in the cases of</span>
<span class="sd">    CT_SA_wrt_t and CT_P_wrt_t).</span>
<span class="sd">    (1) CT_SA_wrt_t, the derivative of CT with respect to Absolute Salinity</span>
<span class="sd">    at constant t and p, and</span>
<span class="sd">    (2) CT_T_wrt_t, derivative of CT with respect to in-situ temperature t</span>
<span class="sd">    at constant SA and p.</span>
<span class="sd">    (3) CT_P_wrt_t, derivative of CT with respect to pressure P (in Pa) at</span>
<span class="sd">    constant SA and t.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CT_SA_wrt_t : array-like, K kg/g</span>
<span class="sd">        The first derivative of Conservative Temperature with</span>
<span class="sd">        respect to Absolute Salinity at constant t and p.</span>
<span class="sd">        [ K/(g/kg)]  i.e.</span>
<span class="sd">    CT_T_wrt_t : array-like, unitless</span>
<span class="sd">        The first derivative of Conservative Temperature with</span>
<span class="sd">        respect to in-situ temperature, t, at constant SA and p.</span>
<span class="sd">    CT_P_wrt_t : array-like, K/Pa</span>
<span class="sd">        The first derivative of Conservative Temperature with</span>
<span class="sd">        respect to pressure P (in Pa) at constant SA and t.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function uses the full Gibbs function. Note that this function</span>
<span class="sd">    avoids the NaN that would exist in CT_SA_wrt_t at SA = 0 if it were</span>
<span class="sd">    evaluated in the straightforward way from the derivatives of the Gibbs</span>
<span class="sd">    function function.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See Eqns. (A.15.3) and (A.15.8) of this TEOS-10 Manual for</span>
<span class="sd">    CT_T_wrt_t and CT_SA_wrt_t respectively.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_first_derivatives_wrt_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">CT_first_derivatives_wrt_t_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_first_derivatives_wrt_t_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">CT_first_derivatives_wrt_t_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">CT_first_derivatives_wrt_t_exact</span><span class="p">)</span>

<div class="viewcode-block" id="CT_freezing">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.CT_freezing">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">CT_freezing</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Conservative Temperature at which seawater freezes.  The</span>
<span class="sd">    Conservative Temperature freezing point is calculated from the exact</span>
<span class="sd">    in-situ freezing temperature which is found by a modified Newton-Raphson</span>
<span class="sd">    iteration (McDougall and Wotherspoon, 2014) of the equality of the</span>
<span class="sd">    chemical potentials of water in seawater and in ice.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    saturation_fraction : array-like</span>
<span class="sd">        Saturation fraction of dissolved air in seawater. (0..1)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CT_freezing : array-like, deg C</span>
<span class="sd">        Conservative Temperature at freezing of seawater</span>
<span class="sd">        That is, the freezing temperature expressed in terms of</span>
<span class="sd">        Conservative Temperature (ITS-90).</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    An alternative GSW function, gsw_CT_freezing_poly, it is based on a</span>
<span class="sd">    computationally-efficient polynomial, and is accurate to within -5e-4 K</span>
<span class="sd">    and 6e-4 K, when compared with this function.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., and S.J. Wotherspoon, 2014: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_freezing</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">)</span></div>

<span class="n">CT_freezing</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_freezing</span><span class="o">.</span><span class="n">types</span>
<span class="n">CT_freezing</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">CT_freezing</span><span class="p">)</span>

<div class="viewcode-block" id="CT_freezing_first_derivatives">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.CT_freezing_first_derivatives">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">CT_freezing_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the first derivatives of the Conservative Temperature at</span>
<span class="sd">    which seawater freezes, with respect to Absolute Salinity SA and</span>
<span class="sd">    pressure P (in Pa).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    saturation_fraction : array-like</span>
<span class="sd">        Saturation fraction of dissolved air in seawater. (0..1)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CTfreezing_SA : array-like, K kg/g</span>
<span class="sd">        the derivative of the Conservative Temperature at</span>
<span class="sd">        freezing (ITS-90) with respect to Absolute Salinity at</span>
<span class="sd">        fixed pressure              [ K/(g/kg) ] i.e.</span>
<span class="sd">    CTfreezing_P : array-like, K/Pa</span>
<span class="sd">        the derivative of the Conservative Temperature at</span>
<span class="sd">        freezing (ITS-90) with respect to pressure (in Pa) at</span>
<span class="sd">        fixed Absolute Salinity</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_freezing_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">)</span></div>

<span class="n">CT_freezing_first_derivatives</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_freezing_first_derivatives</span><span class="o">.</span><span class="n">types</span>
<span class="n">CT_freezing_first_derivatives</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">CT_freezing_first_derivatives</span><span class="p">)</span>

<div class="viewcode-block" id="CT_freezing_first_derivatives_poly">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.CT_freezing_first_derivatives_poly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">CT_freezing_first_derivatives_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the first derivatives of the Conservative Temperature at</span>
<span class="sd">    which seawater freezes, with respect to Absolute Salinity SA and</span>
<span class="sd">    pressure P (in Pa) of the comptationally efficient polynomial fit of the</span>
<span class="sd">    freezing temperature (McDougall et al., 2014).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    saturation_fraction : array-like</span>
<span class="sd">        Saturation fraction of dissolved air in seawater. (0..1)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CTfreezing_SA : array-like, K kg/g</span>
<span class="sd">        the derivative of the Conservative Temperature at</span>
<span class="sd">        freezing (ITS-90) with respect to Absolute Salinity at</span>
<span class="sd">        fixed pressure              [ K/(g/kg) ] i.e.</span>
<span class="sd">    CTfreezing_P : array-like, K/Pa</span>
<span class="sd">        the derivative of the Conservative Temperature at</span>
<span class="sd">        freezing (ITS-90) with respect to pressure (in Pa) at</span>
<span class="sd">        fixed Absolute Salinity</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_freezing_first_derivatives_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">)</span></div>

<span class="n">CT_freezing_first_derivatives_poly</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_freezing_first_derivatives_poly</span><span class="o">.</span><span class="n">types</span>
<span class="n">CT_freezing_first_derivatives_poly</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">CT_freezing_first_derivatives_poly</span><span class="p">)</span>

<div class="viewcode-block" id="CT_freezing_poly">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.CT_freezing_poly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">CT_freezing_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Conservative Temperature at which seawater freezes.</span>
<span class="sd">    The error of this fit ranges between -5e-4 K and 6e-4 K when compared</span>
<span class="sd">    with the Conservative Temperature calculated from the exact in-situ</span>
<span class="sd">    freezing temperature which is found by a Newton-Raphson iteration of the</span>
<span class="sd">    equality of the chemical potentials of water in seawater and in ice.</span>
<span class="sd">    Note that the Conservative Temperature freezing temperature can be found</span>
<span class="sd">    by this exact method using the function gsw_CT_freezing.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    saturation_fraction : array-like</span>
<span class="sd">        Saturation fraction of dissolved air in seawater. (0..1)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CT_freezing : array-like, deg C</span>
<span class="sd">        Conservative Temperature at freezing of seawater</span>
<span class="sd">        That is, the freezing temperature expressed in</span>
<span class="sd">        terms of Conservative Temperature (ITS-90).</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_freezing_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">)</span></div>

<span class="n">CT_freezing_poly</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_freezing_poly</span><span class="o">.</span><span class="n">types</span>
<span class="n">CT_freezing_poly</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">CT_freezing_poly</span><span class="p">)</span>

<div class="viewcode-block" id="CT_from_enthalpy">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.CT_from_enthalpy">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">CT_from_enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Conservative Temperature of seawater, given the Absolute</span>
<span class="sd">    Salinity, specific enthalpy, h, and pressure p.  The specific enthalpy</span>
<span class="sd">    input is the one calculated from the computationally-efficient</span>
<span class="sd">    expression for specific volume in terms of SA, CT and p (Roquet et al.,</span>
<span class="sd">    2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    h : array-like</span>
<span class="sd">        Specific enthalpy, J/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CT : array-like, deg C</span>
<span class="sd">        Conservative Temperature ( ITS-90)</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="sd">    variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="sd">    Physical Oceanography, 33, 945-963.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    McDougall, T.J., and S.J. Wotherspoon, 2014: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_from_enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">CT_from_enthalpy</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_from_enthalpy</span><span class="o">.</span><span class="n">types</span>
<span class="n">CT_from_enthalpy</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">CT_from_enthalpy</span><span class="p">)</span>

<div class="viewcode-block" id="CT_from_enthalpy_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.CT_from_enthalpy_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">CT_from_enthalpy_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Conservative Temperature of seawater, given the Absolute</span>
<span class="sd">    Salinity, SA, specific enthalpy, h, and pressure p.  The specific</span>
<span class="sd">    enthalpy input is calculated from the full Gibbs function of seawater,</span>
<span class="sd">    gsw_enthalpy_t_exact.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    h : array-like</span>
<span class="sd">        Specific enthalpy, J/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CT : array-like, deg C</span>
<span class="sd">        Conservative Temperature ( ITS-90)</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this function uses the full Gibbs function.  There is an</span>
<span class="sd">    alternative to calling this function, namely</span>
<span class="sd">    gsw_CT_from_enthalpy(SA,h,p), which uses the computationally</span>
<span class="sd">    efficient 75-term expression for specific volume in terms of SA, CT</span>
<span class="sd">    and p (Roquet et al., 2015).</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="sd">    variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="sd">    Physical Oceanography, 33, 945-963.</span>

<span class="sd">    McDougall T.J. and S.J. Wotherspoon, 2013: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_from_enthalpy_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">CT_from_enthalpy_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_from_enthalpy_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">CT_from_enthalpy_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">CT_from_enthalpy_exact</span><span class="p">)</span>

<div class="viewcode-block" id="CT_from_entropy">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.CT_from_entropy">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">CT_from_entropy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">entropy</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Conservative Temperature with entropy as an input variable.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    entropy : array-like</span>
<span class="sd">        Specific entropy, J/(kg*K)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CT : array-like, deg C</span>
<span class="sd">        Conservative Temperature (ITS-90)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix  A.10 of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_from_entropy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">entropy</span><span class="p">)</span></div>

<span class="n">CT_from_entropy</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_from_entropy</span><span class="o">.</span><span class="n">types</span>
<span class="n">CT_from_entropy</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">CT_from_entropy</span><span class="p">)</span>

<div class="viewcode-block" id="CT_from_pt">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.CT_from_pt">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">CT_from_pt</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">pt</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Conservative Temperature of seawater from potential</span>
<span class="sd">    temperature (whose reference sea pressure is zero dbar).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    pt : array-like</span>
<span class="sd">        Potential temperature referenced to a sea pressure, degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CT : array-like, deg C</span>
<span class="sd">        Conservative Temperature (ITS-90)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 3.3 of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_from_pt</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span></div>

<span class="n">CT_from_pt</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_from_pt</span><span class="o">.</span><span class="n">types</span>
<span class="n">CT_from_pt</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">CT_from_pt</span><span class="p">)</span>

<div class="viewcode-block" id="CT_from_rho">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.CT_from_rho">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">CT_from_rho</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Conservative Temperature of a seawater sample, for given</span>
<span class="sd">    values of its density, Absolute Salinity and sea pressure (in dbar),</span>
<span class="sd">    using the computationally-efficient expression for specific volume in</span>
<span class="sd">    terms of SA, CT and p (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rho : array-like</span>
<span class="sd">        Seawater density (not anomaly) in-situ, e.g., 1026 kg/m^3.</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CT : array-like, deg C</span>
<span class="sd">        Conservative Temperature  (ITS-90)</span>
<span class="sd">    CT_multiple : array-like, deg C</span>
<span class="sd">        Conservative Temperature  (ITS-90)</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling, 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_from_rho</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">CT_from_rho</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_from_rho</span><span class="o">.</span><span class="n">types</span>
<span class="n">CT_from_rho</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">CT_from_rho</span><span class="p">)</span>

<div class="viewcode-block" id="CT_from_t">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.CT_from_t">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">CT_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Conservative Temperature of seawater from in-situ</span>
<span class="sd">    temperature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CT : array-like, deg C</span>
<span class="sd">        Conservative Temperature (ITS-90)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 3.3 of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">CT_from_t</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_from_t</span><span class="o">.</span><span class="n">types</span>
<span class="n">CT_from_t</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">CT_from_t</span><span class="p">)</span>

<div class="viewcode-block" id="CT_maxdensity">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.CT_maxdensity">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">CT_maxdensity</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Conservative Temperature of maximum density of seawater.</span>
<span class="sd">    This function returns the Conservative temperature at which the density</span>
<span class="sd">    of seawater is a maximum, at given Absolute Salinity, SA, and sea</span>
<span class="sd">    pressure, p (in dbar).  This function uses the computationally-efficient</span>
<span class="sd">    expression for specific volume in terms of SA, CT and p</span>
<span class="sd">    (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CT_maxdensity : array-like, deg C</span>
<span class="sd">        Conservative Temperature at which</span>
<span class="sd">        the density of seawater is a maximum for</span>
<span class="sd">        given Absolute Salinity and pressure.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 3.42 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall T. J. and S. J. Wotherspoon, 2013: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_maxdensity</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">CT_maxdensity</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_maxdensity</span><span class="o">.</span><span class="n">types</span>
<span class="n">CT_maxdensity</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">CT_maxdensity</span><span class="p">)</span>

<div class="viewcode-block" id="CT_second_derivatives">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.CT_second_derivatives">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">CT_second_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">pt</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following three, second-order derivatives of Conservative</span>
<span class="sd">    Temperature</span>
<span class="sd">    (1) CT_SA_SA, the second derivative with respect to Absolute Salinity</span>
<span class="sd">    at constant potential temperature (with p_ref = 0 dbar),</span>
<span class="sd">    (2) CT_SA_pt, the derivative with respect to potential temperature</span>
<span class="sd">    (the regular potential temperature which is referenced to 0 dbar)</span>
<span class="sd">    and Absolute Salinity, and</span>
<span class="sd">    (3) CT_pt_pt, the second derivative with respect to potential</span>
<span class="sd">    temperature (the regular potential temperature which is referenced</span>
<span class="sd">    to 0 dbar) at constant Absolute Salinity.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    pt : array-like</span>
<span class="sd">        Potential temperature referenced to a sea pressure, degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CT_SA_SA : array-like, K/((g/kg)^2)</span>
<span class="sd">        The second derivative of Conservative Temperature with</span>
<span class="sd">        respect to Absolute Salinity at constant potential</span>
<span class="sd">        temperature (the regular potential temperature which</span>
<span class="sd">        has reference sea pressure of 0 dbar).</span>
<span class="sd">    CT_SA_pt : array-like,</span>
<span class="sd">        The derivative of Conservative Temperature with</span>
<span class="sd">        respect to potential temperature (the regular one with</span>
<span class="sd">    p_ref : array-like, 1/(g/kg)</span>
<span class="sd">        0 dbar) and Absolute Salinity.</span>
<span class="sd">    CT_pt_pt : array-like,</span>
<span class="sd">        The second derivative of Conservative Temperature with</span>
<span class="sd">        respect to potential temperature (the regular one with</span>
<span class="sd">    p_ref : array-like, 1/K</span>
<span class="sd">        0 dbar) at constant SA.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See appendix A.12 of this TEOS-10 Manual.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_second_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span></div>

<span class="n">CT_second_derivatives</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ct_second_derivatives</span><span class="o">.</span><span class="n">types</span>
<span class="n">CT_second_derivatives</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">CT_second_derivatives</span><span class="p">)</span>

<div class="viewcode-block" id="deltaSA_atlas">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.deltaSA_atlas">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">deltaSA_atlas</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Absolute Salinity Anomaly atlas value, SA - SR, in</span>
<span class="sd">    the open ocean by spatially interpolating the global reference data set</span>
<span class="sd">    of deltaSA_atlas to the location of the seawater sample.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    lon : array-like</span>
<span class="sd">        Longitude, -360 to 360 degrees</span>
<span class="sd">    lat : array-like</span>
<span class="sd">        Latitude, -90 to 90 degrees</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    deltaSA_atlas : array-like, g/kg</span>
<span class="sd">        Absolute Salinity Anomaly atlas value</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The Absolute Salinity Anomaly atlas value in the Baltic Sea is</span>
<span class="sd">    evaluated separately, since it is a function of Practical Salinity, not</span>
<span class="sd">    of space.  The present function returns a deltaSA_atlas of zero for</span>
<span class="sd">    data in the Baltic Sea.  The correct way of calculating Absolute</span>
<span class="sd">    Salinity in the Baltic Sea is by calling gsw_SA_from_SP.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="sd">    P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="sd">    Ocean Science, 8, 1123-1134.</span>
<span class="sd">    https://os.copernicus.org/articles/8/1123/2012/os-8-1123-2012.pdf</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">deltasa_atlas</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span></div>

<span class="n">deltaSA_atlas</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">deltasa_atlas</span><span class="o">.</span><span class="n">types</span>
<span class="n">deltaSA_atlas</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">deltaSA_atlas</span><span class="p">)</span>

<div class="viewcode-block" id="deltaSA_from_SP">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.deltaSA_from_SP">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">deltaSA_from_SP</span><span class="p">(</span><span class="n">SP</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Absolute Salinity Anomaly from Practical Salinity.  Since SP</span>
<span class="sd">    is non-negative by definition, this function changes any negative input</span>
<span class="sd">    values of SP to be zero.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SP : array-like</span>
<span class="sd">        Practical Salinity (PSS-78), unitless</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    lon : array-like</span>
<span class="sd">        Longitude, -360 to 360 degrees</span>
<span class="sd">    lat : array-like</span>
<span class="sd">        Latitude, -90 to 90 degrees</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    deltaSA : array-like, g/kg</span>
<span class="sd">        Absolute Salinity Anomaly</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 2.5 and appendices A.4 and A.5 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="sd">    P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="sd">    Ocean Science, 8, 1117-1128.</span>
<span class="sd">    https://os.copernicus.org/articles/8/1117/2012/os-8-1117-2012.pdf</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">deltasa_from_sp</span><span class="p">(</span><span class="n">SP</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span></div>

<span class="n">deltaSA_from_SP</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">deltasa_from_sp</span><span class="o">.</span><span class="n">types</span>
<span class="n">deltaSA_from_SP</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">deltaSA_from_SP</span><span class="p">)</span>

<div class="viewcode-block" id="dilution_coefficient_t_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.dilution_coefficient_t_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">dilution_coefficient_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the dilution coefficient of seawater.  The dilution</span>
<span class="sd">    coefficient of seawater is defined as the Absolute Salinity times the</span>
<span class="sd">    second derivative of the Gibbs function with respect to Absolute</span>
<span class="sd">    Salinity, that is, SA.*g_SA_SA.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dilution_coefficient_t_exact : array-like, (J/kg)(kg/g)</span>
<span class="sd">        dilution coefficient</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">dilution_coefficient_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">dilution_coefficient_t_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">dilution_coefficient_t_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">dilution_coefficient_t_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">dilution_coefficient_t_exact</span><span class="p">)</span>

<div class="viewcode-block" id="dynamic_enthalpy">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.dynamic_enthalpy">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">dynamic_enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates dynamic enthalpy of seawater using the computationally-</span>
<span class="sd">    efficient expression for specific volume in terms of SA, CT and p</span>
<span class="sd">    (Roquet et al., 2015).  Dynamic enthalpy is defined as enthalpy minus</span>
<span class="sd">    potential enthalpy (Young, 2010).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dynamic_enthalpy : array-like, J/kg</span>
<span class="sd">        dynamic enthalpy</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 3.2 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T. J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="sd">    variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="sd">    Physical Oceanography, 33, 945-963.</span>
<span class="sd">    See Eqns. (18) and (22)</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>

<span class="sd">    Young, W.R., 2010: Dynamic enthalpy, Conservative Temperature, and the</span>
<span class="sd">    seawater Boussinesq approximation. Journal of Physical Oceanography,</span>
<span class="sd">    40, 394-400.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">dynamic_enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">dynamic_enthalpy</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">dynamic_enthalpy</span><span class="o">.</span><span class="n">types</span>
<span class="n">dynamic_enthalpy</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">dynamic_enthalpy</span><span class="p">)</span>

<div class="viewcode-block" id="enthalpy">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.enthalpy">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates specific enthalpy of seawater using the computationally-</span>
<span class="sd">    efficient expression for specific volume in terms of SA, CT and p</span>
<span class="sd">    (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    enthalpy : array-like, J/kg</span>
<span class="sd">        specific enthalpy</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqn. (A.30.6) of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="sd">    variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="sd">    Physical Oceanography, 33, 945-963.</span>
<span class="sd">    See Eqns. (18) and (22)</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">enthalpy</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy</span><span class="o">.</span><span class="n">types</span>
<span class="n">enthalpy</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">enthalpy</span><span class="p">)</span>

<div class="viewcode-block" id="enthalpy_CT_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.enthalpy_CT_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">enthalpy_CT_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates specific enthalpy of seawater from Absolute Salinity and</span>
<span class="sd">    Conservative Temperature and pressure.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    enthalpy_CT_exact : array-like, J/kg</span>
<span class="sd">        specific enthalpy</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this function uses the full Gibbs function.  There is an</span>
<span class="sd">    alternative to calling this function, namely gsw_enthalpy(SA,CT,p),</span>
<span class="sd">    which uses the computationally-efficient 75-term expression for specific</span>
<span class="sd">    volume in terms of SA, CT and p (Roquet et al., 2015).</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix A.11 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T. J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="sd">    variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="sd">    Physical Oceanography, 33, 945-963.</span>
<span class="sd">    See Eqns. (18) and (22)</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_ct_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">enthalpy_CT_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_ct_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">enthalpy_CT_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">enthalpy_CT_exact</span><span class="p">)</span>

<div class="viewcode-block" id="enthalpy_diff">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.enthalpy_diff">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">enthalpy_diff</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p_shallow</span><span class="p">,</span> <span class="n">p_deep</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the difference of the specific enthalpy of seawater between</span>
<span class="sd">    two different pressures, p_deep (the deeper pressure) and p_shallow</span>
<span class="sd">    (the shallower pressure), at the same values of SA and CT.  This</span>
<span class="sd">    function uses the computationally-efficient expression for specific</span>
<span class="sd">    volume in terms of SA, CT and p (Roquet et al., 2015).  The output</span>
<span class="sd">    (enthalpy_diff) is the specific enthalpy evaluated at (SA,CT,p_deep)</span>
<span class="sd">    minus the specific enthalpy at (SA,CT,p_shallow).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p_shallow : array-like</span>
<span class="sd">        Upper sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    p_deep : array-like</span>
<span class="sd">        Lower sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    enthalpy_diff : array-like, J/kg</span>
<span class="sd">        difference of specific enthalpy</span>
<span class="sd">        (deep minus shallow)</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqns. (3.32.2) and (A.30.6) of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="sd">    variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="sd">    Physical Oceanography, 33, 945-963.</span>
<span class="sd">    See Eqns. (18) and (22)</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_diff</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p_shallow</span><span class="p">,</span> <span class="n">p_deep</span><span class="p">)</span></div>

<span class="n">enthalpy_diff</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_diff</span><span class="o">.</span><span class="n">types</span>
<span class="n">enthalpy_diff</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">enthalpy_diff</span><span class="p">)</span>

<div class="viewcode-block" id="enthalpy_first_derivatives">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.enthalpy_first_derivatives">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">enthalpy_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following two derivatives of specific enthalpy (h) of</span>
<span class="sd">    seawater using the computationally-efficient expression for</span>
<span class="sd">    specific volume in terms of SA, CT and p (Roquet et al., 2015).</span>
<span class="sd">    (1) h_SA, the derivative with respect to Absolute Salinity at</span>
<span class="sd">    constant CT and p, and</span>
<span class="sd">    (2) h_CT, derivative with respect to CT at constant SA and p.</span>
<span class="sd">    Note that h_P is specific volume (1/rho) it can be calculated by calling</span>
<span class="sd">    gsw_specvol(SA,CT,p).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    h_SA : array-like, J/g</span>
<span class="sd">        The first derivative of specific enthalpy with respect to</span>
<span class="sd">        Absolute Salinity at constant CT and p.</span>
<span class="sd">        [ J/(kg (g/kg))]  i.e.</span>
<span class="sd">    h_CT : array-like, J/(kg K)</span>
<span class="sd">        The first derivative of specific enthalpy with respect to</span>
<span class="sd">        CT at constant SA and p.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See Eqns. (A.11.18), (A.11.15) and (A.11.12) of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="sd">    variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="sd">    Physical Oceanography, 33, 945-963.</span>
<span class="sd">    See Eqns. (18) and (22)</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling, 90, pp. 29-43.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">enthalpy_first_derivatives</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_first_derivatives</span><span class="o">.</span><span class="n">types</span>
<span class="n">enthalpy_first_derivatives</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">enthalpy_first_derivatives</span><span class="p">)</span>

<div class="viewcode-block" id="enthalpy_first_derivatives_CT_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.enthalpy_first_derivatives_CT_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">enthalpy_first_derivatives_CT_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following two derivatives of specific enthalpy, h,</span>
<span class="sd">    (1) h_SA, the derivative with respect to Absolute Salinity at</span>
<span class="sd">    constant CT and p, and</span>
<span class="sd">    (2) h_CT, derivative with respect to CT at constant SA and p.</span>
<span class="sd">    Note that h_P is specific volume, v, it can be calculated by calling</span>
<span class="sd">    gsw_specvol_CT_exact(SA,CT,p).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    h_SA : array-like, J/g</span>
<span class="sd">        The first derivative of specific enthalpy with respect to</span>
<span class="sd">        Absolute Salinity at constant CT and p.</span>
<span class="sd">        [ J/(kg (g/kg))]  i.e.</span>
<span class="sd">    h_CT : array-like, J/(kg K)</span>
<span class="sd">        The first derivative of specific enthalpy with respect to</span>
<span class="sd">        CT at constant SA and p.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this function uses the full Gibbs function.  There is an</span>
<span class="sd">    alternative to calling this function, namely</span>
<span class="sd">    gsw_enthalpy_first_derivatives(SA,CT,p) which uses the computationally</span>
<span class="sd">    efficient 75-term expression for specific volume in terms of SA, CT and</span>
<span class="sd">    p (Roquet et al., 2015).</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See Eqns. (A.11.18), (A.11.15) and (A.11.12) of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="sd">    variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="sd">    Physical Oceanography, 33, 945-963.</span>
<span class="sd">    See Eqns. (18) and (22)</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_first_derivatives_ct_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">enthalpy_first_derivatives_CT_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_first_derivatives_ct_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">enthalpy_first_derivatives_CT_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">enthalpy_first_derivatives_CT_exact</span><span class="p">)</span>

<div class="viewcode-block" id="enthalpy_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.enthalpy_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">enthalpy_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the specific enthalpy of ice (h_Ih).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    enthalpy_ice : array-like, J/kg</span>
<span class="sd">        specific enthalpy of ice</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">enthalpy_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">enthalpy_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">enthalpy_ice</span><span class="p">)</span>

<div class="viewcode-block" id="enthalpy_second_derivatives">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.enthalpy_second_derivatives">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">enthalpy_second_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following three second-order derivatives of specific</span>
<span class="sd">    enthalpy (h),using the computationally-efficient expression for</span>
<span class="sd">    specific volume in terms of SA, CT and p (Roquet et al., 2015).</span>
<span class="sd">    (1) h_SA_SA, second-order derivative with respect to Absolute Salinity</span>
<span class="sd">    at constant CT &amp; p.</span>
<span class="sd">    (2) h_SA_CT, second-order derivative with respect to SA &amp; CT at</span>
<span class="sd">    constant p.</span>
<span class="sd">    (3) h_CT_CT, second-order derivative with respect to CT at constant SA</span>
<span class="sd">    and p.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    h_SA_SA : array-like, J/(kg (g/kg)^2)</span>
<span class="sd">        The second derivative of specific enthalpy with respect to</span>
<span class="sd">        Absolute Salinity at constant CT &amp; p.</span>
<span class="sd">    h_SA_CT : array-like, J/(kg K(g/kg))</span>
<span class="sd">        The second derivative of specific enthalpy with respect to</span>
<span class="sd">        SA and CT at constant p.</span>
<span class="sd">    h_CT_CT : array-like, J/(kg K^2)</span>
<span class="sd">        The second derivative of specific enthalpy with respect to</span>
<span class="sd">        CT at constant SA and p.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="sd">    variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="sd">    Physical Oceanography, 33, 945-963.</span>
<span class="sd">    See Eqns. (18) and (22)</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_second_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">enthalpy_second_derivatives</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_second_derivatives</span><span class="o">.</span><span class="n">types</span>
<span class="n">enthalpy_second_derivatives</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">enthalpy_second_derivatives</span><span class="p">)</span>

<div class="viewcode-block" id="enthalpy_second_derivatives_CT_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.enthalpy_second_derivatives_CT_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">enthalpy_second_derivatives_CT_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following three second-order derivatives of specific</span>
<span class="sd">    enthalpy (h),</span>
<span class="sd">    (1) h_SA_SA, second-order derivative with respect to Absolute Salinity</span>
<span class="sd">    at constant CT &amp; p.</span>
<span class="sd">    (2) h_SA_CT, second-order derivative with respect to SA &amp; CT at</span>
<span class="sd">    constant p.</span>
<span class="sd">    (3) h_CT_CT, second-order derivative with respect to CT at constant SA</span>
<span class="sd">    and p.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    h_SA_SA : array-like, J/(kg (g/kg)^2)</span>
<span class="sd">        The second derivative of specific enthalpy with respect to</span>
<span class="sd">        Absolute Salinity at constant CT &amp; p.</span>
<span class="sd">    h_SA_CT : array-like, J/(kg K(g/kg))</span>
<span class="sd">        The second derivative of specific enthalpy with respect to</span>
<span class="sd">        SA and CT at constant p.</span>
<span class="sd">    h_CT_CT : array-like, J/(kg K^2)</span>
<span class="sd">        The second derivative of specific enthalpy with respect to</span>
<span class="sd">        CT at constant SA and p.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this function uses the full Gibbs function.  There is an</span>
<span class="sd">    alternative to calling this function, namely</span>
<span class="sd">    gsw_enthalpy_second_derivatives(SA,CT,p) which uses the computationally</span>
<span class="sd">    efficient 75-term expression for specific volume in terms of SA, CT and</span>
<span class="sd">    p (Roquet et al., 2015).</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T. J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="sd">    variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="sd">    Physical Oceanography, 33, 945-963.</span>
<span class="sd">    See Eqns. (18) and (22)</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_second_derivatives_ct_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">enthalpy_second_derivatives_CT_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_second_derivatives_ct_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">enthalpy_second_derivatives_CT_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">enthalpy_second_derivatives_CT_exact</span><span class="p">)</span>

<div class="viewcode-block" id="enthalpy_SSO_0">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.enthalpy_SSO_0">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">enthalpy_SSO_0</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    enthalpy at (SSO,CT=0,p)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    double, array</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    gsw_enthalpy_SSO_0                               enthalpy at (SSO,CT=0,p)</span>
<span class="sd">                                                               (75-term eqn.)</span>
<span class="sd">     This function calculates enthalpy at the Standard Ocean Salinity, SSO,</span>
<span class="sd">     and at a Conservative Temperature of zero degrees C, as a function of</span>
<span class="sd">     pressure, p, in dbar, using a streamlined version of the 75-term</span>
<span class="sd">     computationally-efficient expression for specific volume, that is, a</span>
<span class="sd">     streamlined version of the code &quot;gsw_enthalpy(SA,CT,p)&quot;.</span>

<span class="sd">    VERSION NUMBER: 3.06.12 (25th May, 2020)</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_sso_0</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></div>

<span class="n">enthalpy_SSO_0</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_sso_0</span><span class="o">.</span><span class="n">types</span>
<span class="n">enthalpy_SSO_0</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">enthalpy_SSO_0</span><span class="p">)</span>

<div class="viewcode-block" id="enthalpy_t_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.enthalpy_t_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">enthalpy_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the specific enthalpy of seawater.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    enthalpy_t_exact : array-like, J/kg</span>
<span class="sd">        specific enthalpy</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">enthalpy_t_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">enthalpy_t_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">enthalpy_t_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">enthalpy_t_exact</span><span class="p">)</span>

<div class="viewcode-block" id="entropy_first_derivatives">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.entropy_first_derivatives">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">entropy_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following two partial derivatives of specific entropy</span>
<span class="sd">    (eta)</span>
<span class="sd">    (1) eta_SA, the derivative with respect to Absolute Salinity at</span>
<span class="sd">    constant Conservative Temperature, and</span>
<span class="sd">    (2) eta_CT, the derivative with respect to Conservative Temperature at</span>
<span class="sd">    constant Absolute Salinity.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    eta_SA : array-like, J/(g K)</span>
<span class="sd">        The derivative of specific entropy with respect to</span>
<span class="sd">        Absolute Salinity (in units of g kg^-1) at constant</span>
<span class="sd">        Conservative Temperature.</span>
<span class="sd">    eta_CT : array-like, J/(kg K^2)</span>
<span class="sd">        The derivative of specific entropy with respect to</span>
<span class="sd">        Conservative Temperature at constant Absolute Salinity.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See Eqns. (A.12.8) and (P.14a,c) of this TEOS-10 Manual.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">entropy_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">)</span></div>

<span class="n">entropy_first_derivatives</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">entropy_first_derivatives</span><span class="o">.</span><span class="n">types</span>
<span class="n">entropy_first_derivatives</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">entropy_first_derivatives</span><span class="p">)</span>

<div class="viewcode-block" id="entropy_from_CT">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.entropy_from_CT">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">entropy_from_CT</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates specific entropy of seawater from Conservative Temperature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    entropy : array-like, J/(kg*K)</span>
<span class="sd">        specific entropy</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix A.10 of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">entropy_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">)</span></div>

<span class="n">entropy_from_CT</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">entropy_from_ct</span><span class="o">.</span><span class="n">types</span>
<span class="n">entropy_from_CT</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">entropy_from_CT</span><span class="p">)</span>

<div class="viewcode-block" id="entropy_from_pt">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.entropy_from_pt">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">entropy_from_pt</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">pt</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates specific entropy of seawater as a function of potential</span>
<span class="sd">    temperature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    pt : array-like</span>
<span class="sd">        Potential temperature referenced to a sea pressure, degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    entropy : array-like, J/(kg*K)</span>
<span class="sd">        specific entropy</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix A.10 of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">entropy_from_pt</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span></div>

<span class="n">entropy_from_pt</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">entropy_from_pt</span><span class="o">.</span><span class="n">types</span>
<span class="n">entropy_from_pt</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">entropy_from_pt</span><span class="p">)</span>

<div class="viewcode-block" id="entropy_from_t">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.entropy_from_t">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">entropy_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates specific entropy of seawater from in-situ temperature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    entropy : array-like, J/(kg*K)</span>
<span class="sd">        specific entropy</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">entropy_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">entropy_from_t</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">entropy_from_t</span><span class="o">.</span><span class="n">types</span>
<span class="n">entropy_from_t</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">entropy_from_t</span><span class="p">)</span>

<div class="viewcode-block" id="entropy_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.entropy_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">entropy_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates specific entropy of ice.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ice_entropy : array-like, J kg^-1 K^-1</span>
<span class="sd">        specific entropy of ice</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">entropy_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">entropy_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">entropy_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">entropy_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">entropy_ice</span><span class="p">)</span>

<div class="viewcode-block" id="entropy_part">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.entropy_part">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">entropy_part</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    entropy minus the terms that are a function of only SA</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    double, array</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    sw_entropy_part    entropy minus the terms that are a function of only SA</span>
<span class="sd">    This function calculates entropy, except that it does not evaluate any</span>
<span class="sd">    terms that are functions of Absolute Salinity alone.  By not calculating</span>
<span class="sd">    these terms, which are a function only of Absolute Salinity, several</span>
<span class="sd">    unnecessary computations are avoided (including saving the computation</span>
<span class="sd">    of a natural logarithm).  These terms are a necessary part of entropy,</span>
<span class="sd">    but are not needed when calculating potential temperature from in-situ</span>
<span class="sd">    temperature.</span>

<span class="sd">    VERSION NUMBER: 3.06.12 (25th May, 2020)</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">entropy_part</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">entropy_part</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">entropy_part</span><span class="o">.</span><span class="n">types</span>
<span class="n">entropy_part</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">entropy_part</span><span class="p">)</span>

<div class="viewcode-block" id="entropy_part_zerop">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.entropy_part_zerop">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">entropy_part_zerop</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">pt0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    entropy_part evaluated at the sea surface</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    pt0 : array-like</span>
<span class="sd">        Potential temperature with reference pressure of 0 dbar, degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    double, array</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    gsw_entropy_part_zerop          entropy_part evaluated at the sea surface</span>
<span class="sd">    This function calculates entropy at a sea pressure of zero, except that</span>
<span class="sd">    it does not evaluate any terms that are functions of Absolute Salinity</span>
<span class="sd">    alone.  By not calculating these terms, which are a function only of</span>
<span class="sd">    Absolute Salinity, several unnecessary computations are avoided</span>
<span class="sd">    (including saving the computation of a natural logarithm). These terms</span>
<span class="sd">    are a necessary part of entropy, but are not needed when calculating</span>
<span class="sd">    potential temperature from in-situ temperature.</span>
<span class="sd">    The inputs to &quot;gsw_entropy_part_zerop(SA,pt0)&quot; are Absolute Salinity</span>
<span class="sd">    and potential temperature with reference sea pressure of zero dbar.</span>

<span class="sd">    VERSION NUMBER: 3.06.12 (25th May, 2020)</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">entropy_part_zerop</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">pt0</span><span class="p">)</span></div>

<span class="n">entropy_part_zerop</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">entropy_part_zerop</span><span class="o">.</span><span class="n">types</span>
<span class="n">entropy_part_zerop</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">entropy_part_zerop</span><span class="p">)</span>

<div class="viewcode-block" id="entropy_second_derivatives">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.entropy_second_derivatives">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">entropy_second_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following three second-order partial derivatives of</span>
<span class="sd">    specific entropy (eta)</span>
<span class="sd">    (1) eta_SA_SA, the second derivative with respect to Absolute</span>
<span class="sd">    Salinity at constant Conservative Temperature, and</span>
<span class="sd">    (2) eta_SA_CT, the derivative with respect to Absolute Salinity and</span>
<span class="sd">    Conservative Temperature.</span>
<span class="sd">    (3) eta_CT_CT, the second derivative with respect to Conservative</span>
<span class="sd">    Temperature at constant Absolute Salinity.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    eta_SA_SA : array-like, J/(kg K(g/kg)^2)</span>
<span class="sd">        The second derivative of specific entropy with respect</span>
<span class="sd">        to Absolute Salinity (in units of g kg^-1) at constant</span>
<span class="sd">        Conservative Temperature.</span>
<span class="sd">    eta_SA_CT : array-like, J/(kg (g/kg) K^2)</span>
<span class="sd">        The second derivative of specific entropy with respect</span>
<span class="sd">        to Conservative Temperature at constant Absolute</span>
<span class="sd">    eta_CT_CT : array-like, J/(kg K^3)</span>
<span class="sd">        The second derivative of specific entropy with respect</span>
<span class="sd">        to Conservative Temperature at constant Absolute</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See Eqns. (P.14b) and (P.15a,b) of this TEOS-10 Manual.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">entropy_second_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">)</span></div>

<span class="n">entropy_second_derivatives</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">entropy_second_derivatives</span><span class="o">.</span><span class="n">types</span>
<span class="n">entropy_second_derivatives</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">entropy_second_derivatives</span><span class="p">)</span>

<div class="viewcode-block" id="Fdelta">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.Fdelta">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">Fdelta</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Fdelta from the Absolute Salinity Anomaly Ratio (SAAR).  It</span>
<span class="sd">    finds SAAR by calling the function &quot;gsw_SAAR(p,long,lat)&quot; and then</span>
<span class="sd">    simply calculates Fdelta from</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    lon : array-like</span>
<span class="sd">        Longitude, -360 to 360 degrees</span>
<span class="sd">    lat : array-like</span>
<span class="sd">        Latitude, -90 to 90 degrees</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Fdelta : array-like, unitless</span>
<span class="sd">        ratio of SA to Sstar, minus 1</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Fdelta = (1 + r1)SAAR/(1 - r1*SAAR)</span>
<span class="sd">    = (SA/Sstar) - 1</span>

<span class="sd">    with r1 being the constant 0.35 based on the work of Pawlowicz et al.</span>
<span class="sd">    (2011). Note that since SAAR is everywhere less than 0.001 in the global</span>
<span class="sd">    ocean, Fdelta is only slightly different to 1.35*SAAR.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 2.5 and appendices A.4 and A.5 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="sd">    P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="sd">    Ocean Science, 8, 1123-1134.</span>
<span class="sd">    https://os.copernicus.org/articles/8/1123/2012/os-8-1123-2012.pdf</span>

<span class="sd">    Pawlawicz, R., D.G. Wright and F.J. Millero, 2011; The effects of</span>
<span class="sd">    biogeochemical processes on oceanic conductivity/salinty/density</span>
<span class="sd">    relationships and the characterization of real seawater. Ocean Science,</span>
<span class="sd">    7, 363-387.  https://os.copernicus.org/articles/7/363/2011/os-7-363-2011.pdf</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">fdelta</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span></div>

<span class="n">Fdelta</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">fdelta</span><span class="o">.</span><span class="n">types</span>
<span class="n">Fdelta</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">Fdelta</span><span class="p">)</span>

<div class="viewcode-block" id="frazil_properties">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.frazil_properties">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">frazil_properties</span><span class="p">(</span><span class="n">SA_bulk</span><span class="p">,</span> <span class="n">h_bulk</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the mass fraction of ice (mass of ice divided by mass of ice</span>
<span class="sd">    plus seawater), w_Ih_final, which results from given values of the bulk</span>
<span class="sd">    Absolute Salinity, SA_bulk, bulk enthalpy, h_bulk, occurring at pressure</span>
<span class="sd">    p.  The final values of Absolute Salinity, SA_final, and Conservative</span>
<span class="sd">    Temperature, CT_final, of the interstitial seawater phase are also</span>
<span class="sd">    returned.  This code assumes that there is no dissolved air in the</span>
<span class="sd">    seawater (that is, saturation_fraction is assumed to be zero</span>
<span class="sd">    throughout the code).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA_bulk : array-like</span>
<span class="sd">        bulk Absolute Salinity of the seawater and ice mixture, g/kg</span>
<span class="sd">    h_bulk : array-like</span>
<span class="sd">        bulk enthalpy of the seawater and ice mixture, J/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SA_final : array-like, g/kg</span>
<span class="sd">        Absolute Salinity of the seawater in the final state,</span>
<span class="sd">        whether or not any ice is present.</span>
<span class="sd">    CT_final : array-like, deg C</span>
<span class="sd">        Conservative Temperature of the seawater in the final</span>
<span class="sd">        state, whether or not any ice is present.</span>
<span class="sd">    w_Ih_final : array-like, unitless</span>
<span class="sd">        mass fraction of ice in the final seawater-ice mixture.</span>
<span class="sd">        If this ice mass fraction is positive, the system is at</span>
<span class="sd">        thermodynamic equilibrium.  If this ice mass fraction is</span>
<span class="sd">        zero there is no ice in the final state which consists</span>
<span class="sd">        only of seawater which is warmer than the freezing</span>
<span class="sd">        temperature.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    When the mass fraction w_Ih_final is calculated as being a positive</span>
<span class="sd">    value, the seawater-ice mixture is at thermodynamic equilibrium.</span>

<span class="sd">    This code returns w_Ih_final = 0 when the input bulk enthalpy, h_bulk,</span>
<span class="sd">    is sufficiently large (i.e. sufficiently &quot;warm&quot;) so that there is no ice</span>
<span class="sd">    present in the final state.  In this case the final state consists of</span>
<span class="sd">    only seawater rather than being an equilibrium mixture of seawater and</span>
<span class="sd">    ice which occurs when w_Ih_final is positive.  Note that when</span>
<span class="sd">    w_Ih_final = 0, the final seawater is not at the freezing temperature.</span>

<span class="sd">    Note that there is another GSW code,</span>
<span class="sd">    gsw_frazil_properties_potential_poly(SA_bulk,h_pot_bulk,p) which</span>
<span class="sd">    treats potential enthalpy as the conservative variable, while, in</span>
<span class="sd">    contrast, the present code treats in situ enthalpy as the conservative</span>
<span class="sd">    variable during the interaction of seawater and ice Ih.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of ice and sea ice into seawater, and frazil ice formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>

<span class="sd">    McDougall, T.J., and S.J. Wotherspoon, 2014: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>

<span class="sd">    Anonymous, 2014: Modelling the interaction between seawater and frazil</span>
<span class="sd">    ice.  Manuscript, March 2015.  See Eqns. (8) - (15) of this manuscript.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">frazil_properties</span><span class="p">(</span><span class="n">SA_bulk</span><span class="p">,</span> <span class="n">h_bulk</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">frazil_properties</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">frazil_properties</span><span class="o">.</span><span class="n">types</span>
<span class="n">frazil_properties</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">frazil_properties</span><span class="p">)</span>

<div class="viewcode-block" id="frazil_properties_potential">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.frazil_properties_potential">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">frazil_properties_potential</span><span class="p">(</span><span class="n">SA_bulk</span><span class="p">,</span> <span class="n">h_pot_bulk</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the mass fraction of ice (mass of ice divided by mass of ice</span>
<span class="sd">    plus seawater), w_Ih_eq, which results from given values of the bulk</span>
<span class="sd">    Absolute Salinity, SA_bulk, bulk potential enthalpy, h_pot_bulk,</span>
<span class="sd">    occurring at pressure p.  The final equilibrium values of Absolute</span>
<span class="sd">    Salinity, SA_eq, and Conservative Temperature, CT_eq, of the</span>
<span class="sd">    interstitial seawater phase are also returned.  This code assumes that</span>
<span class="sd">    there is no dissolved air in the seawater (that is, saturation_fraction</span>
<span class="sd">    is assumed to be zero throughout the code).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA_bulk : array-like</span>
<span class="sd">        bulk Absolute Salinity of the seawater and ice mixture, g/kg</span>
<span class="sd">    h_pot_bulk : array-like</span>
<span class="sd">        bulk enthalpy of the seawater and ice mixture, J/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SA_final : array-like, g/kg</span>
<span class="sd">        Absolute Salinity of the seawater in the final state,</span>
<span class="sd">        whether or not any ice is present.</span>
<span class="sd">    CT_final : array-like, deg C</span>
<span class="sd">        Conservative Temperature of the seawater in the final</span>
<span class="sd">        state, whether or not any ice is present.</span>
<span class="sd">    w_Ih_final : array-like, unitless</span>
<span class="sd">        mass fraction of ice in the final seawater-ice mixture.</span>
<span class="sd">        If this ice mass fraction is positive, the system is at</span>
<span class="sd">        thermodynamic equilibrium.  If this ice mass fraction is</span>
<span class="sd">        zero there is no ice in the final state which consists</span>
<span class="sd">        only of seawater which is warmer than the freezing</span>
<span class="sd">        temperature.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    When the mass fraction w_Ih_final is calculated as being a positive</span>
<span class="sd">    value, the seawater-ice mixture is at thermodynamic equilibrium.</span>

<span class="sd">    This code returns w_Ih_final = 0 when the input bulk enthalpy, h_bulk,</span>
<span class="sd">    is sufficiently large (i.e. sufficiently &quot;warm&quot;) so that there is no ice</span>
<span class="sd">    present in the final state.  In this case the final state consists of</span>
<span class="sd">    only seawater rather than being an equilibrium mixture of seawater and</span>
<span class="sd">    ice which occurs when w_Ih_final is positive.  Note that when</span>
<span class="sd">    w_Ih_final = 0, the final seawater is not at the freezing temperature.</span>

<span class="sd">    Note that this code uses the exact forms of CT_freezing and</span>
<span class="sd">    pot_enthalpy_ice_freezing.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of ice and sea ice into seawater, and frazil ice formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>

<span class="sd">    McDougall, T.J., and S.J. Wotherspoon, 2014: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>

<span class="sd">    Anonymous, 2014: Modelling the interaction between seawater and frazil</span>
<span class="sd">    ice.  Manuscript, March 2015.  See Eqns. (8)-(15) of this  manuscript.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">frazil_properties_potential</span><span class="p">(</span><span class="n">SA_bulk</span><span class="p">,</span> <span class="n">h_pot_bulk</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">frazil_properties_potential</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">frazil_properties_potential</span><span class="o">.</span><span class="n">types</span>
<span class="n">frazil_properties_potential</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">frazil_properties_potential</span><span class="p">)</span>

<div class="viewcode-block" id="frazil_properties_potential_poly">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.frazil_properties_potential_poly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">frazil_properties_potential_poly</span><span class="p">(</span><span class="n">SA_bulk</span><span class="p">,</span> <span class="n">h_pot_bulk</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the mass fraction of ice (mass of ice divided by mass of ice</span>
<span class="sd">    plus seawater), w_Ih_eq, which results from given values of the bulk</span>
<span class="sd">    Absolute Salinity, SA_bulk, bulk potential enthalpy, h_pot_bulk,</span>
<span class="sd">    occurring at pressure p.  The final equilibrium values of Absolute</span>
<span class="sd">    Salinity, SA_eq, and Conservative Temperature, CT_eq, of the</span>
<span class="sd">    interstitial seawater phase are also returned.  This code assumes that</span>
<span class="sd">    there is no dissolved air in the seawater (that is, saturation_fraction</span>
<span class="sd">    is assumed to be zero throughout the code).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA_bulk : array-like</span>
<span class="sd">        bulk Absolute Salinity of the seawater and ice mixture, g/kg</span>
<span class="sd">    h_pot_bulk : array-like</span>
<span class="sd">        bulk enthalpy of the seawater and ice mixture, J/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SA_final : array-like, g/kg</span>
<span class="sd">        Absolute Salinity of the seawater in the final state,</span>
<span class="sd">        whether or not any ice is present.</span>
<span class="sd">    CT_final : array-like, deg C</span>
<span class="sd">        Conservative Temperature of the seawater in the final</span>
<span class="sd">        state, whether or not any ice is present.</span>
<span class="sd">    w_Ih_final : array-like, unitless</span>
<span class="sd">        mass fraction of ice in the final seawater-ice mixture.</span>
<span class="sd">        If this ice mass fraction is positive, the system is at</span>
<span class="sd">        thermodynamic equilibrium.  If this ice mass fraction is</span>
<span class="sd">        zero there is no ice in the final state which consists</span>
<span class="sd">        only of seawater which is warmer than the freezing</span>
<span class="sd">        temperature.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    When the mass fraction w_Ih_final is calculated as being a positive</span>
<span class="sd">    value, the seawater-ice mixture is at thermodynamic equilibrium.</span>

<span class="sd">    This code returns w_Ih_final = 0 when the input bulk enthalpy, h_bulk,</span>
<span class="sd">    is sufficiently large (i.e. sufficiently &quot;warm&quot;) so that there is no ice</span>
<span class="sd">    present in the final state.  In this case the final state consists of</span>
<span class="sd">    only seawater rather than being an equilibrium mixture of seawater and</span>
<span class="sd">    ice which occurs when w_Ih_final is positive.  Note that when</span>
<span class="sd">    w_Ih_final = 0, the final seawater is not at the freezing temperature.</span>

<span class="sd">    Note that this code uses the polynomial forms of CT_freezing and</span>
<span class="sd">    pot_enthalpy_ice_freezing.  This code is intended to be used in ocean</span>
<span class="sd">    models where the model prognostic variables are SA_bulk and h_pot_bulk.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of ice and sea ice into seawater, and frazil ice formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>

<span class="sd">    McDougall, T.J., and S.J. Wotherspoon, 2014: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>

<span class="sd">    Anonymous, 2014: Modelling the interaction between seawater and frazil</span>
<span class="sd">    ice.  Manuscript, March 2015.  See Eqns. (8)-(15) of this  manuscript.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">frazil_properties_potential_poly</span><span class="p">(</span><span class="n">SA_bulk</span><span class="p">,</span> <span class="n">h_pot_bulk</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">frazil_properties_potential_poly</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">frazil_properties_potential_poly</span><span class="o">.</span><span class="n">types</span>
<span class="n">frazil_properties_potential_poly</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">frazil_properties_potential_poly</span><span class="p">)</span>

<div class="viewcode-block" id="frazil_ratios_adiabatic">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.frazil_ratios_adiabatic">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">frazil_ratios_adiabatic</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w_Ih</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the ratios of SA, CT and P changes when frazil ice forms or</span>
<span class="sd">    melts in response to an adiabatic change in pressure of a mixture of</span>
<span class="sd">    seawater and frazil ice crystals.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    w_Ih : array-like</span>
<span class="sd">        mass fraction of ice: the mass of ice divided by the</span>
<span class="sd">        sum of the masses of ice and seawater. 0 &lt;= wIh &lt;= 1. unitless.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dSA_dCT_frazil : array-like, g/(kg K)</span>
<span class="sd">        the ratio of the changes in Absolute Salinity</span>
<span class="sd">        to that of Conservative Temperature</span>
<span class="sd">    dSA_dP_frazil : array-like, g/(kg Pa)</span>
<span class="sd">        the ratio of the changes in Absolute Salinity</span>
<span class="sd">        to that of pressure (in Pa)</span>
<span class="sd">    dCT_dP_frazil : array-like, K/Pa</span>
<span class="sd">        the ratio of the changes in Conservative Temperature</span>
<span class="sd">        to that of pressure (in Pa)</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the first output, dSA_dCT_frazil, is dSA/dCT rather than</span>
<span class="sd">    dCT/dSA.  This is done so that when SA = 0, the output, dSA/dCT, is zero</span>
<span class="sd">    whereas dCT/dSA would then be infinite.</span>

<span class="sd">    Also note that both dSA_dP_frazil and dCT_dP_frazil are the pressure</span>
<span class="sd">    derivatives with the pressure measured in Pa not dbar.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="sd">    See Eqns. (47), (48) and (49) of this manuscript.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">frazil_ratios_adiabatic</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w_Ih</span><span class="p">)</span></div>

<span class="n">frazil_ratios_adiabatic</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">frazil_ratios_adiabatic</span><span class="o">.</span><span class="n">types</span>
<span class="n">frazil_ratios_adiabatic</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">frazil_ratios_adiabatic</span><span class="p">)</span>

<div class="viewcode-block" id="frazil_ratios_adiabatic_poly">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.frazil_ratios_adiabatic_poly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">frazil_ratios_adiabatic_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w_Ih</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the ratios of SA, CT and P changes when frazil ice forms or</span>
<span class="sd">    melts in response to an adiabatic change in pressure of a mixture of</span>
<span class="sd">    seawater and frazil ice crystals.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    w_Ih : array-like</span>
<span class="sd">        mass fraction of ice: the mass of ice divided by the</span>
<span class="sd">        sum of the masses of ice and seawater. 0 &lt;= wIh &lt;= 1. unitless.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dSA_dCT_frazil : array-like, g/(kg K)</span>
<span class="sd">        the ratio of the changes in Absolute Salinity</span>
<span class="sd">        to that of Conservative Temperature</span>
<span class="sd">    dSA_dP_frazil : array-like, g/(kg Pa)</span>
<span class="sd">        the ratio of the changes in Absolute Salinity</span>
<span class="sd">        to that of pressure (in Pa)</span>
<span class="sd">    dCT_dP_frazil : array-like, K/Pa</span>
<span class="sd">        the ratio of the changes in Conservative Temperature</span>
<span class="sd">        to that of pressure (in Pa)</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the first output, dSA_dCT_frazil, is dSA/dCT rather than</span>
<span class="sd">    dCT/dSA.  This is done so that when SA = 0, the output, dSA/dCT, is zero</span>
<span class="sd">    whereas dCT/dSA would then be infinite.</span>

<span class="sd">    Also note that both dSA_dP_frazil and dCT_dP_frazil are the pressure</span>
<span class="sd">    derivatives with the pressure measured in Pa not dbar.</span>

<span class="sd">    This function uses the computationally-efficient expression for specific</span>
<span class="sd">    volume in terms of SA, CT and p (Roquet et al., 2015) and the polynomial</span>
<span class="sd">    expression for freezing temperature based on Conservative Temperature</span>
<span class="sd">    (McDougall et al., 2015).</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="sd">    See Eqns. (47), (48) and (49) of this manuscript.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">frazil_ratios_adiabatic_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w_Ih</span><span class="p">)</span></div>

<span class="n">frazil_ratios_adiabatic_poly</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">frazil_ratios_adiabatic_poly</span><span class="o">.</span><span class="n">types</span>
<span class="n">frazil_ratios_adiabatic_poly</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">frazil_ratios_adiabatic_poly</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">gibbs</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">nt</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates specific Gibbs energy and its derivatives up to order 3 for</span>
<span class="sd">    seawater.  The Gibbs function for seawater is that of TEOS-10</span>
<span class="sd">    (IOC et al., 2010), being the sum of IAPWS-08 for the saline part and</span>
<span class="sd">    IAPWS-09 for the pure water part.  These IAPWS releases are the</span>
<span class="sd">    officially blessed IAPWS descriptions of Feistel (2008) and the pure</span>
<span class="sd">    water part of Feistel (2003).  Absolute Salinity, SA, in all of the GSW</span>
<span class="sd">    routines is expressed on the Reference-Composition Salinity Scale of</span>
<span class="sd">    2008 (RCSS-08) of Millero et al. (2008).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ns : array-like</span>
<span class="sd">        order of SA derivative, integer in (0, 1, 2)</span>
<span class="sd">    nt : array-like</span>
<span class="sd">        order of t derivative, integer in (0, 1, 2)</span>
<span class="sd">    np : array-like</span>
<span class="sd">        order of p derivative, integer in (0, 1, 2)</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gibbs : array-like</span>
<span class="sd">        Specific Gibbs energy or its derivatives.</span>
<span class="sd">        The Gibbs energy (when ns = nt = np = 0) has units of J/kg.</span>
<span class="sd">        The Absolute Salinity derivatives are output in units of (J/kg) (g/kg)^(-ns).</span>
<span class="sd">        The temperature derivatives are output in units of (J/kg) (K)^(-nt).</span>
<span class="sd">        The pressure derivatives are output in units of (J/kg) (Pa)^(-np).</span>
<span class="sd">        The mixed derivatives are output in units of (J/kg) (g/kg)^(-ns) (K)^(-nt) (Pa)^(-np).</span>
<span class="sd">        Note: The derivatives are taken with respect to pressure in Pa, not</span>
<span class="sd">        withstanding that the pressure input into this routine is in dbar.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    Feistel, R., 2003: A new extended Gibbs thermodynamic potential of</span>
<span class="sd">    seawater,  Progr. Oceanogr., 58, 43-114.</span>

<span class="sd">    Feistel, R., 2008: A Gibbs function for seawater thermodynamics</span>
<span class="sd">    for -6 to 80C and salinity up to 120 g kg1, Deep-Sea Res. I,</span>
<span class="sd">    55, 1639-1671.</span>

<span class="sd">    IAPWS, 2008: Release on the IAPWS Formulation 2008 for the</span>
<span class="sd">    Thermodynamic Properties of Seawater. The International Association</span>
<span class="sd">    for the Properties of Water and Steam. Berlin, Germany, September</span>
<span class="sd">    2008, available from https://iapws.org/.  This Release is referred</span>
<span class="sd">    to as IAPWS-08.</span>

<span class="sd">    IAPWS, 2009: Supplementary Release on a Computationally Efficient</span>
<span class="sd">    Thermodynamic Formulation for Liquid Water for Oceanographic Use.</span>
<span class="sd">    The International Association for the Properties of Water and Steam.</span>
<span class="sd">    Doorwerth, The Netherlands, September 2009, available from</span>
<span class="sd">    https://iapws.org/.  This Release is referred to as IAPWS-09.</span>

<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 2.6 and appendices A.6,  G and H of this TEOS-10 Manual.</span>

<span class="sd">    Millero, F.J., R. Feistel, D.G. Wright, and T.J. McDougall, 2008:</span>
<span class="sd">    The composition of Standard Seawater and the definition of the</span>
<span class="sd">    Reference-Composition Salinity Scale, Deep-Sea Res. I, 55, 50-72.</span>

<span class="sd">    Reference page in Help browser</span>
<span class="sd">    &lt;a href=&quot;matlab:doc gsw_gibbs&quot;&gt;doc gsw_gibbs&lt;/a&gt;</span>
<span class="sd">    Note that this reference page includes the code contained in gsw_gibbs.</span>
<span class="sd">    We have opted to encode this programme as it is a global standard and</span>
<span class="sd">    such we cannot allow anyone to change it.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">gibbs</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">nt</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">gibbs</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">gibbs</span><span class="o">.</span><span class="n">types</span>
<span class="n">gibbs</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">gibbs</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">gibbs_ice</span><span class="p">(</span><span class="n">nt</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ice specific Gibbs energy and derivatives up to order 2.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nt : array-like</span>
<span class="sd">        order of t derivative, integer in (0, 1, 2)</span>
<span class="sd">    np : array-like</span>
<span class="sd">        order of p derivative, integer in (0, 1, 2)</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gibbs_ice : array-like</span>
<span class="sd">        Specific Gibbs energy of ice or its derivatives.</span>
<span class="sd">        The Gibbs energy (when nt = np = 0) has units of J/kg.</span>
<span class="sd">        The temperature derivatives are output in units of (J/kg) (K)^(-nt).</span>
<span class="sd">        The pressure derivatives are output in units of (J/kg) (Pa)^(-np).</span>
<span class="sd">        The mixed derivatives are output in units of (J/kg) (K)^(-nt) (Pa)^(-np).</span>
<span class="sd">        Note. The derivatives are taken with respect to pressure in Pa, not</span>
<span class="sd">        withstanding that the pressure input into this routine is in dbar.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IAPWS, 2009: Revised release on the Equation of State 2006 for H2O Ice</span>
<span class="sd">    Ih. The International Association for the Properties of Water and</span>
<span class="sd">    Steam. Doorwerth, The Netherlands, September 2009.</span>

<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See appendix I.</span>

<span class="sd">    Reference page in Help browser</span>
<span class="sd">    &lt;a href=&quot;matlab:doc gsw_gibbs_ice&quot;&gt;doc gsw_gibbs_ice&lt;/a&gt;</span>
<span class="sd">    Note that this reference page includes the code contained in</span>
<span class="sd">    gsw_gibbs_ice.  We have opted to encode this programme as it is a global</span>
<span class="sd">    standard and such we cannot allow anyone to change it.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">gibbs_ice</span><span class="p">(</span><span class="n">nt</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">gibbs_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">gibbs_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">gibbs_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">gibbs_ice</span><span class="p">)</span>

<div class="viewcode-block" id="gibbs_ice_part_t">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.gibbs_ice_part_t">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">gibbs_ice_part_t</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    part of the first temperature derivative of Gibbs energy of ice</span>
<span class="sd">    that is the output is gibbs_ice(1,0,t,p) + S0</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gibbs_ice_part_t : array-like, J kg^-1 K^-1</span>
<span class="sd">        part of temperature derivative</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IAPWS, 2009: Revised Release on the Equation of State 2006 for H2O Ice</span>
<span class="sd">    Ih. The International Association for the Properties of Water and</span>
<span class="sd">    Steam. Doorwerth, The Netherlands, September 2009.</span>

<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See appendix I.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">gibbs_ice_part_t</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">gibbs_ice_part_t</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">gibbs_ice_part_t</span><span class="o">.</span><span class="n">types</span>
<span class="n">gibbs_ice_part_t</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">gibbs_ice_part_t</span><span class="p">)</span>

<div class="viewcode-block" id="gibbs_ice_pt0">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.gibbs_ice_pt0">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">gibbs_ice_pt0</span><span class="p">(</span><span class="n">pt0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    part of the first temperature derivative of Gibbs energy of ice</span>
<span class="sd">    that is the output is &quot;gibbs_ice(1,0,pt0,0) + s0&quot;</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pt0 : array-like</span>
<span class="sd">        Potential temperature with reference pressure of 0 dbar, degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gibbs_ice_part_pt0 : array-like, J kg^-1 K^-1</span>
<span class="sd">        part of temperature derivative</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IAPWS, 2009: Revised Release on the Equation of State 2006 for H2O Ice</span>
<span class="sd">    Ih. The International Association for the Properties of Water and</span>
<span class="sd">    Steam. Doorwerth, The Netherlands, September 2009.</span>

<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See appendix I.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">gibbs_ice_pt0</span><span class="p">(</span><span class="n">pt0</span><span class="p">)</span></div>

<span class="n">gibbs_ice_pt0</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">gibbs_ice_pt0</span><span class="o">.</span><span class="n">types</span>
<span class="n">gibbs_ice_pt0</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">gibbs_ice_pt0</span><span class="p">)</span>

<div class="viewcode-block" id="gibbs_ice_pt0_pt0">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.gibbs_ice_pt0_pt0">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">gibbs_ice_pt0_pt0</span><span class="p">(</span><span class="n">pt0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The second temperature derivative of Gibbs energy of ice at the</span>
<span class="sd">    potential temperature with reference sea pressure of zero dbar.  That is</span>
<span class="sd">    the output is gibbs_ice(2,0,pt0,0).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pt0 : array-like</span>
<span class="sd">        Potential temperature with reference pressure of 0 dbar, degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gibbs_ice_pt0_pt0 : array-like, J kg^-1 K^-2</span>
<span class="sd">        temperature second derivative at pt0</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IAPWS, 2009: Revised Release on the Equation of State 2006 for H2O Ice</span>
<span class="sd">    Ih. The International Association for the Properties of Water and</span>
<span class="sd">    Steam. Doorwerth, The Netherlands, September 2009.</span>

<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See appendix I.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">gibbs_ice_pt0_pt0</span><span class="p">(</span><span class="n">pt0</span><span class="p">)</span></div>

<span class="n">gibbs_ice_pt0_pt0</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">gibbs_ice_pt0_pt0</span><span class="o">.</span><span class="n">types</span>
<span class="n">gibbs_ice_pt0_pt0</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">gibbs_ice_pt0_pt0</span><span class="p">)</span>

<div class="viewcode-block" id="gibbs_pt0_pt0">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.gibbs_pt0_pt0">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">gibbs_pt0_pt0</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">pt0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    gibbs_tt at (SA,pt,0)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    pt0 : array-like</span>
<span class="sd">        Potential temperature with reference pressure of 0 dbar, degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    double, array</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    gsw_gibbs_pt0_pt0                                   gibbs_tt at (SA,pt,0)</span>
<span class="sd">    This function calculates the second derivative of the specific Gibbs</span>
<span class="sd">    function with respect to temperature at zero sea pressure.  The inputs</span>
<span class="sd">    are Absolute Salinity and potential temperature with reference sea</span>
<span class="sd">    pressure of zero dbar.</span>

<span class="sd">    VERSION NUMBER: 3.06.13 (7th September, 2020)</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">gibbs_pt0_pt0</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">pt0</span><span class="p">)</span></div>

<span class="n">gibbs_pt0_pt0</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">gibbs_pt0_pt0</span><span class="o">.</span><span class="n">types</span>
<span class="n">gibbs_pt0_pt0</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">gibbs_pt0_pt0</span><span class="p">)</span>

<div class="viewcode-block" id="grav">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.grav">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">grav</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates acceleration due to gravity as a function of latitude and as</span>
<span class="sd">    a function of pressure in the ocean.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lat : array-like</span>
<span class="sd">        Latitude, -90 to 90 degrees</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    grav : array-like, m s^-2</span>
<span class="sd">        gravitational acceleration</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix D of this TEOS-10 Manual.</span>

<span class="sd">    Moritz, H., 2000: Geodetic reference system 1980. J. Geodesy, 74,</span>
<span class="sd">    pp. 128-133.</span>

<span class="sd">    Saunders, P.M., and N.P. Fofonoff, 1976: Conversion of pressure to</span>
<span class="sd">    depth in the ocean. Deep-Sea Res., pp. 109-111.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">grav</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">grav</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">grav</span><span class="o">.</span><span class="n">types</span>
<span class="n">grav</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">grav</span><span class="p">)</span>

<div class="viewcode-block" id="Helmholtz_energy_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.Helmholtz_energy_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">Helmholtz_energy_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Helmholtz energy of ice.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Helmholtz_energy_ice : array-like, J/kg</span>
<span class="sd">        Helmholtz energy of ice</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">helmholtz_energy_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">Helmholtz_energy_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">helmholtz_energy_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">Helmholtz_energy_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">Helmholtz_energy_ice</span><span class="p">)</span>

<div class="viewcode-block" id="Hill_ratio_at_SP2">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.Hill_ratio_at_SP2">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">Hill_ratio_at_SP2</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Hill ratio, which is the adjustment needed to apply for</span>
<span class="sd">    Practical Salinities smaller than 2.  This ratio is defined at a</span>
<span class="sd">    Practical Salinity = 2 and in-situ temperature, t using PSS-78. The Hill</span>
<span class="sd">    ratio is the ratio of 2 to the output of the Hill et al. (1986) formula</span>
<span class="sd">    for Practical Salinity at the conductivity ratio, Rt, at which Practical</span>
<span class="sd">    Salinity on the PSS-78 scale is exactly 2.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Hill_ratio : array-like, unitless</span>
<span class="sd">        Hill ratio at SP of 2</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    Hill, K.D., T.M. Dauphinee &amp; D.J. Woods, 1986: The extension of the</span>
<span class="sd">    Practical Salinity Scale 1978 to low salinities. IEEE J. Oceanic Eng.,</span>
<span class="sd">    11, 109 - 112.</span>

<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix E of this TEOS-10 Manual.</span>

<span class="sd">    McDougall T.J. and S.J. Wotherspoon, 2013: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>

<span class="sd">    Unesco, 1983: Algorithms for computation of fundamental properties of</span>
<span class="sd">    seawater. Unesco Technical Papers in Marine Science, 44, 53 pp.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">hill_ratio_at_sp2</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></div>

<span class="n">Hill_ratio_at_SP2</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">hill_ratio_at_sp2</span><span class="o">.</span><span class="n">types</span>
<span class="n">Hill_ratio_at_SP2</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">Hill_ratio_at_SP2</span><span class="p">)</span>

<div class="viewcode-block" id="ice_fraction_to_freeze_seawater">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.ice_fraction_to_freeze_seawater">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">ice_fraction_to_freeze_seawater</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">t_Ih</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the mass fraction of ice (mass of ice divided by mass of ice</span>
<span class="sd">    plus seawater), which, when melted into seawater having (SA,CT,p) causes</span>
<span class="sd">    the final dilute seawater to be at the freezing temperature.  The other</span>
<span class="sd">    outputs are the Absolute Salinity and Conservative Temperature of the</span>
<span class="sd">    final diluted seawater.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    t_Ih : array-like</span>
<span class="sd">        In-situ temperature of ice (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SA_freeze : array-like, g/kg</span>
<span class="sd">        Absolute Salinity of seawater after the mass fraction of</span>
<span class="sd">        ice, ice_fraction, at temperature t_Ih has melted into the</span>
<span class="sd">        original seawater, and the final mixture is at the freezing</span>
<span class="sd">        temperature of seawater.</span>
<span class="sd">    CT_freeze : array-like, deg C</span>
<span class="sd">        Conservative Temperature of seawater after the mass</span>
<span class="sd">        fraction, w_Ih, of ice at temperature t_Ih has melted into</span>
<span class="sd">        the original seawater, and the final mixture is at the</span>
<span class="sd">        freezing temperature of seawater.</span>
<span class="sd">    w_Ih : array-like, unitless</span>
<span class="sd">        mass fraction of ice, having in-situ temperature t_Ih,</span>
<span class="sd">        which, when melted into seawater at (SA,CT,p) leads to the</span>
<span class="sd">        final diluted seawater being at the freezing temperature.</span>
<span class="sd">        This output must be between 0 and 1.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., and S.J. Wotherspoon, 2013: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="sd">    See Eqn. (9) of this manuscript.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ice_fraction_to_freeze_seawater</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">t_Ih</span><span class="p">)</span></div>

<span class="n">ice_fraction_to_freeze_seawater</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">ice_fraction_to_freeze_seawater</span><span class="o">.</span><span class="n">types</span>
<span class="n">ice_fraction_to_freeze_seawater</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">ice_fraction_to_freeze_seawater</span><span class="p">)</span>

<div class="viewcode-block" id="infunnel">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.infunnel">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">infunnel</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;oceanographic funnel&quot; check for the 75-term equation</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    in_funnel : array-like,</span>
<span class="sd">        0, if SA, CT and p are outside the &quot;funnel&quot;</span>
<span class="sd">        =  1, if SA, CT and p are inside the &quot;funnel&quot;</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    gsw_infunnel        &quot;oceanographic funnel&quot; check for the 75-term equation</span>

<span class="sd">    USAGE:</span>
<span class="sd">    in_funnel = gsw_infunnel(SA,CT,p)</span>

<span class="sd">    INPUT:</span>
<span class="sd">     SA  =  Absolute Salinity                                     [ g kg^-1 ]</span>
<span class="sd">     CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="sd">     p   =  sea pressure                                             [ dbar ]</span>
<span class="sd">            ( i.e. absolute pressure - 10.1325 dbar )</span>

<span class="sd">     SA &amp; CT need to have the same dimensions.</span>
<span class="sd">     p may have dimensions 1x1 or Mx1 or 1xN or MxN, where SA &amp; CT are MxN.</span>

<span class="sd">    OUTPUT:</span>
<span class="sd">     in_funnel  =  0, if SA, CT and p are outside the &quot;funnel&quot;</span>
<span class="sd">                =  1, if SA, CT and p are inside the &quot;funnel&quot;</span>
<span class="sd">     Note. The term &quot;funnel&quot; (McDougall et al., 2003) describes the range of</span>
<span class="sd">       SA, CT and p over which the error in the fit of the computationally</span>
<span class="sd">       efficient 75-term expression for specific volume in terms of SA, CT</span>
<span class="sd">       and p was calculated (Roquet et al., 2015).</span>

<span class="sd">    AUTHOR:</span>
<span class="sd">     Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>

<span class="sd">    VERSION NUMBER: 3.06.13 (23rd May, 2021)</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">infunnel</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">infunnel</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">infunnel</span><span class="o">.</span><span class="n">types</span>
<span class="n">infunnel</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">infunnel</span><span class="p">)</span>

<div class="viewcode-block" id="internal_energy">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.internal_energy">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">internal_energy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates specific internal energy of seawater using the</span>
<span class="sd">    computationally-efficient expression for specific volume in terms of SA,</span>
<span class="sd">    CT and p (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    internal_energy : array-like, J/kg</span>
<span class="sd">        specific internal energy</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">internal_energy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">internal_energy</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">internal_energy</span><span class="o">.</span><span class="n">types</span>
<span class="n">internal_energy</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">internal_energy</span><span class="p">)</span>

<div class="viewcode-block" id="internal_energy_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.internal_energy_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">internal_energy_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the specific internal energy of ice.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    internal_energy_ice : array-like, J/kg</span>
<span class="sd">        specific internal energy (u)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">internal_energy_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">internal_energy_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">internal_energy_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">internal_energy_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">internal_energy_ice</span><span class="p">)</span>

<div class="viewcode-block" id="kappa">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.kappa">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">kappa</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the isentropic compressibility of seawater.  This function</span>
<span class="sd">    has inputs of Absolute Salinity and Conservative Temperature.  This</span>
<span class="sd">    function uses the computationally-efficient expression for</span>
<span class="sd">    specific volume in terms of SA, CT and p (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    kappa : array-like, 1/Pa</span>
<span class="sd">        isentropic compressibility of seawater</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqn. (2.17.1) of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">kappa</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">kappa</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">kappa</span><span class="o">.</span><span class="n">types</span>
<span class="n">kappa</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">kappa</span><span class="p">)</span>

<div class="viewcode-block" id="kappa_const_t_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.kappa_const_t_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">kappa_const_t_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates isothermal compressibility of ice.</span>
<span class="sd">    Note. This is the compressibility of ice AT CONSTANT IN-SITU</span>
<span class="sd">    TEMPERATURE</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    kappa_const_t_ice : array-like, 1/Pa</span>
<span class="sd">        isothermal compressibility</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">kappa_const_t_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">kappa_const_t_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">kappa_const_t_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">kappa_const_t_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">kappa_const_t_ice</span><span class="p">)</span>

<div class="viewcode-block" id="kappa_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.kappa_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">kappa_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the isentropic compressibility of ice.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    kappa_ice : array-like, 1/Pa</span>
<span class="sd">        isentropic compressibility</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">kappa_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">kappa_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">kappa_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">kappa_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">kappa_ice</span><span class="p">)</span>

<div class="viewcode-block" id="kappa_t_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.kappa_t_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">kappa_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the isentropic compressibility of seawater.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    kappa_t_exact : array-like, 1/Pa</span>
<span class="sd">        isentropic compressibility</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqns. (2.16.1) and the row for kappa in Table P.1 of appendix P</span>
<span class="sd">    of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">kappa_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">kappa_t_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">kappa_t_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">kappa_t_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">kappa_t_exact</span><span class="p">)</span>

<div class="viewcode-block" id="latentheat_evap_CT">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.latentheat_evap_CT">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">latentheat_evap_CT</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates latent heat, or enthalpy, of evaporation at p = 0 (the</span>
<span class="sd">    surface).  It is defined as a function of Absolute Salinity, SA, and</span>
<span class="sd">    Conservative Temperature, CT, and is valid in the ranges</span>
<span class="sd">    0 &lt; SA &lt; 42 g/kg and 0 &lt; CT &lt; 40 deg C.  The errors range between</span>
<span class="sd">    -0.4 and 0.6 J/kg.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    latentheat_evap : array-like, J/kg</span>
<span class="sd">        latent heat of evaporation</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 3.39 of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">latentheat_evap_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">)</span></div>

<span class="n">latentheat_evap_CT</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">latentheat_evap_ct</span><span class="o">.</span><span class="n">types</span>
<span class="n">latentheat_evap_CT</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">latentheat_evap_CT</span><span class="p">)</span>

<div class="viewcode-block" id="latentheat_evap_t">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.latentheat_evap_t">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">latentheat_evap_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates latent heat, or enthalpy, of evaporation at p = 0 (the</span>
<span class="sd">    surface).  It is defined as a function of Absolute Salinity, SA, and</span>
<span class="sd">    in-situ temperature, t, and is valid in the ranges 0 &lt; SA &lt; 40 g/kg</span>
<span class="sd">    and 0 &lt; CT &lt; 42 deg C. The errors range between -0.4 and 0.6 J/kg.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    latentheat_evap : array-like, J/kg</span>
<span class="sd">        latent heat of evaporation</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 3.39 of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">latentheat_evap_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span></div>

<span class="n">latentheat_evap_t</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">latentheat_evap_t</span><span class="o">.</span><span class="n">types</span>
<span class="n">latentheat_evap_t</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">latentheat_evap_t</span><span class="p">)</span>

<div class="viewcode-block" id="latentheat_melting">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.latentheat_melting">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">latentheat_melting</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates latent heat, or enthalpy, of melting.  It is defined in terms</span>
<span class="sd">    of Absolute Salinity, SA, and sea pressure, p, and is valid in the</span>
<span class="sd">    ranges 0 &lt; SA &lt; 42 g kg^-1 and 0 &lt; p &lt; 10,000 dbar.  This is based on</span>
<span class="sd">    the IAPWS Releases IAPWS-09 (for pure water), IAPWS-08 (for the saline</span>
<span class="sd">    compoonent of seawater and IAPWS-06 for ice Ih.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    latentheat_melting : array-like, J/kg</span>
<span class="sd">        latent heat of melting</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IAPWS, 2008: Release on the IAPWS Formulation 2008 for the Thermodynamic</span>
<span class="sd">    Properties of Seawater. The International Association for the Properties</span>
<span class="sd">    of Water and Steam. Berlin, Germany, September 2008.  This Release is</span>
<span class="sd">    known as IAPWS-09.</span>

<span class="sd">    IAPWS, 2009a: Revised Release on the Equation of State 2006 for H2O Ice</span>
<span class="sd">    Ih. The International Association for the Properties of Water and Steam.</span>
<span class="sd">    Doorwerth, The Netherlands, September 2009. This Release is known as</span>
<span class="sd">    IAPWS-06</span>

<span class="sd">    IAPWS, 2009b: Supplementary Release on a Computationally Efficient</span>
<span class="sd">    Thermodynamic Formulation for Liquid Water for Oceanographic Use. The</span>
<span class="sd">    International Association for the Properties of Water and Steam.</span>
<span class="sd">    Doorwerth, The Netherlands, September 2009.  This Release is known as</span>
<span class="sd">    IAPWS-09.</span>

<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 3.34 of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">latentheat_melting</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">latentheat_melting</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">latentheat_melting</span><span class="o">.</span><span class="n">types</span>
<span class="n">latentheat_melting</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">latentheat_melting</span><span class="p">)</span>

<div class="viewcode-block" id="melting_ice_equilibrium_SA_CT_ratio">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.melting_ice_equilibrium_SA_CT_ratio">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">melting_ice_equilibrium_SA_CT_ratio</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the ratio of SA to CT changes when ice melts into seawater</span>
<span class="sd">    with both the seawater and the seaice temperatures being almost equal to</span>
<span class="sd">    the equilibrium freezing temperature.  It is assumed that a small mass</span>
<span class="sd">    of ice melts into an infinite mass of seawater.  If indeed the</span>
<span class="sd">    temperature of the seawater and the ice were both equal to the freezing</span>
<span class="sd">    temperature, then no melting or freezing would occur; an imbalance</span>
<span class="sd">    between these three temperatures is needed for freezing or melting to</span>
<span class="sd">    occur (the three temperatures being (1) the seawater temperature,</span>
<span class="sd">    (2) the ice temperature, and (3) the freezing temperature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    melting_ice_equilibrium_SA_CT_ratio : array-like, g/(kg K)</span>
<span class="sd">        the ratio dSA/dCT of SA to CT</span>
<span class="sd">        changes when ice melts into seawater, with</span>
<span class="sd">        the seawater and seaice being close to the</span>
<span class="sd">        freezing temperature.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The output, melting_ice_equilibrium_SA_CT_ratio, is dSA/dCT rather than</span>
<span class="sd">    dCT/dSA.  This is done so that when SA = 0, the output, dSA/dCT is zero</span>
<span class="sd">    whereas dCT/dSA would be infinite.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="sd">    See Eqn. (16) of this manuscript.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_ice_equilibrium_sa_ct_ratio</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">melting_ice_equilibrium_SA_CT_ratio</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_ice_equilibrium_sa_ct_ratio</span><span class="o">.</span><span class="n">types</span>
<span class="n">melting_ice_equilibrium_SA_CT_ratio</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">melting_ice_equilibrium_SA_CT_ratio</span><span class="p">)</span>

<div class="viewcode-block" id="melting_ice_equilibrium_SA_CT_ratio_poly">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.melting_ice_equilibrium_SA_CT_ratio_poly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">melting_ice_equilibrium_SA_CT_ratio_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the ratio of SA to CT changes when ice melts into seawater</span>
<span class="sd">    with both the seawater and the seaice temperatures being almost equal to</span>
<span class="sd">    the equilibrium freezing temperature.  It is assumed that a small mass</span>
<span class="sd">    of ice melts into an infinite mass of seawater.  If indeed the</span>
<span class="sd">    temperature of the seawater and the ice were both equal to the freezing</span>
<span class="sd">    temperature, then no melting or freezing would occur; an imbalance</span>
<span class="sd">    between these three temperatures is needed for freezing or melting to</span>
<span class="sd">    occur (the three temperatures being (1) the seawater temperature,</span>
<span class="sd">    (2) the ice temperature, and (3) the freezing temperature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    melting_ice_equilibrium_SA_CT_ratio : array-like, g/(kg K)</span>
<span class="sd">        the ratio dSA/dCT of SA to CT</span>
<span class="sd">        changes when ice melts into seawater, with</span>
<span class="sd">        the seawater and seaice being close to the</span>
<span class="sd">        freezing temperature.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The output, melting_ice_equilibrium_SA_CT_ratio, is dSA/dCT rather than</span>
<span class="sd">    dCT/dSA.  This is done so that when SA = 0, the output, dSA/dCT is zero</span>
<span class="sd">    whereas dCT/dSA would be infinite.</span>

<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="sd">    See Eqn. (16) of this manuscript.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_ice_equilibrium_sa_ct_ratio_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">melting_ice_equilibrium_SA_CT_ratio_poly</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_ice_equilibrium_sa_ct_ratio_poly</span><span class="o">.</span><span class="n">types</span>
<span class="n">melting_ice_equilibrium_SA_CT_ratio_poly</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">melting_ice_equilibrium_SA_CT_ratio_poly</span><span class="p">)</span>

<div class="viewcode-block" id="melting_ice_into_seawater">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.melting_ice_into_seawater">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">melting_ice_into_seawater</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w_Ih</span><span class="p">,</span> <span class="n">t_Ih</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the final Absolute Salinity, final Conservative Temperature</span>
<span class="sd">    and final ice mass fraction that results when a given mass fraction of</span>
<span class="sd">    ice melts and is mixed into seawater whose properties are (SA,CT,p).</span>
<span class="sd">    This code takes the seawater to contain no dissolved air.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    w_Ih : array-like</span>
<span class="sd">        mass fraction of ice: the mass of ice divided by the</span>
<span class="sd">        sum of the masses of ice and seawater. 0 &lt;= wIh &lt;= 1. unitless.</span>
<span class="sd">    t_Ih : array-like</span>
<span class="sd">        In-situ temperature of ice (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SA_final : array-like, g/kg</span>
<span class="sd">        Absolute Salinity of the seawater in the final state,</span>
<span class="sd">        whether or not any ice is present.</span>
<span class="sd">    CT_final : array-like, deg C</span>
<span class="sd">        Conservative Temperature of the seawater in the final</span>
<span class="sd">        state, whether or not any ice is present.</span>
<span class="sd">    w_Ih_final : array-like, unitless</span>
<span class="sd">        mass fraction of ice in the final seawater-ice mixture.</span>
<span class="sd">        If this ice mass fraction is positive, the system is at</span>
<span class="sd">        thermodynamic equilibrium.  If this ice mass fraction is</span>
<span class="sd">        zero there is no ice in the final state which consists</span>
<span class="sd">        only of seawater which is warmer than the freezing</span>
<span class="sd">        temperature.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    When the mass fraction w_Ih_final is calculated as being a positive</span>
<span class="sd">    value, the seawater-ice mixture is at thermodynamic equilibrium.</span>

<span class="sd">    This code returns w_Ih_final = 0 when the input bulk enthalpy, h_bulk,</span>
<span class="sd">    is sufficiently large (i.e. sufficiently &quot;warm&quot;) so that there is no ice</span>
<span class="sd">    present in the final state.  In this case the final state consists of</span>
<span class="sd">    only seawater rather than being an equilibrium mixture of seawater and</span>
<span class="sd">    ice which occurs when w_Ih_final is positive.  Note that when</span>
<span class="sd">    w_Ih_final = 0, the final seawater is not at the freezing temperature.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of ice and sea ice into seawater, and frazil ice formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_ice_into_seawater</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w_Ih</span><span class="p">,</span> <span class="n">t_Ih</span><span class="p">)</span></div>

<span class="n">melting_ice_into_seawater</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_ice_into_seawater</span><span class="o">.</span><span class="n">types</span>
<span class="n">melting_ice_into_seawater</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">melting_ice_into_seawater</span><span class="p">)</span>

<div class="viewcode-block" id="melting_ice_SA_CT_ratio">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.melting_ice_SA_CT_ratio">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">melting_ice_SA_CT_ratio</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">t_Ih</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the ratio of SA to CT changes when ice melts into seawater.</span>
<span class="sd">    It is assumed that a small mass of ice melts into an infinite mass of</span>
<span class="sd">    seawater.  Because of the infinite mass of seawater, the ice will always</span>
<span class="sd">    melt.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    t_Ih : array-like</span>
<span class="sd">        In-situ temperature of ice (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    melting_ice_SA_CT_ratio : array-like, g kg^-1 K^-1</span>
<span class="sd">        the ratio of SA to CT changes when ice melts</span>
<span class="sd">        into a large mass of seawater</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The output, melting_seaice_SA_CT_ratio, is dSA/dCT rather than dCT/dSA.</span>
<span class="sd">    This is done so that when SA = 0, the output, dSA/dCT is zero whereas</span>
<span class="sd">    dCT/dSA would be infinite.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="sd">    See Eqn. (13) of this manuscript.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_ice_sa_ct_ratio</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">t_Ih</span><span class="p">)</span></div>

<span class="n">melting_ice_SA_CT_ratio</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_ice_sa_ct_ratio</span><span class="o">.</span><span class="n">types</span>
<span class="n">melting_ice_SA_CT_ratio</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">melting_ice_SA_CT_ratio</span><span class="p">)</span>

<div class="viewcode-block" id="melting_ice_SA_CT_ratio_poly">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.melting_ice_SA_CT_ratio_poly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">melting_ice_SA_CT_ratio_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">t_Ih</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the ratio of SA to CT changes when ice melts into seawater.</span>
<span class="sd">    It is assumed that a small mass of ice melts into an infinite mass of</span>
<span class="sd">    seawater.  Because of the infinite mass of seawater, the ice will always</span>
<span class="sd">    melt.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    t_Ih : array-like</span>
<span class="sd">        In-situ temperature of ice (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    melting_ice_SA_CT_ratio : array-like, g kg^-1 K^-1</span>
<span class="sd">        the ratio of SA to CT changes when ice melts</span>
<span class="sd">        into a large mass of seawater</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The output, melting_seaice_SA_CT_ratio, is dSA/dCT rather than dCT/dSA.</span>
<span class="sd">    This is done so that when SA = 0, the output, dSA/dCT is zero whereas</span>
<span class="sd">    dCT/dSA would be infinite.</span>

<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="sd">    See Eqn. (13) of this manuscript.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_ice_sa_ct_ratio_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">t_Ih</span><span class="p">)</span></div>

<span class="n">melting_ice_SA_CT_ratio_poly</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_ice_sa_ct_ratio_poly</span><span class="o">.</span><span class="n">types</span>
<span class="n">melting_ice_SA_CT_ratio_poly</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">melting_ice_SA_CT_ratio_poly</span><span class="p">)</span>

<div class="viewcode-block" id="melting_seaice_equilibrium_SA_CT_ratio">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.melting_seaice_equilibrium_SA_CT_ratio">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">melting_seaice_equilibrium_SA_CT_ratio</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the ratio of SA to CT changes when sea ice melts into</span>
<span class="sd">    seawater with both the seawater and the sea ice temperatures being</span>
<span class="sd">    almost equal to the equilibrium freezing temperature.  It is assumed</span>
<span class="sd">    that a small mass of seaice melts into an infinite mass of seawater.  If</span>
<span class="sd">    indeed the temperature of the seawater and the sea ice were both equal</span>
<span class="sd">    to the freezing temperature, then no melting or freezing would occur; an</span>
<span class="sd">    imbalance between these three temperatures is needed for freezing or</span>
<span class="sd">    melting to occur (the three temperatures being (1) the seawater</span>
<span class="sd">    temperature, (2) the sea ice temperature, and (3) the freezing</span>
<span class="sd">    temperature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    melting_seaice_equilibrium_SA_CT_ratio : array-like, g/(kg K)</span>
<span class="sd">        the ratio dSA/dCT of SA to CT</span>
<span class="sd">        changes when sea ice melts into seawater, with</span>
<span class="sd">        the seawater and sea ice being close to the</span>
<span class="sd">        freezing temperature.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the output of this function, dSA/dCT is independent of the</span>
<span class="sd">    sea ice salinity, SA_seaice.  That is, the output applies equally to</span>
<span class="sd">    pure ice Ih and to sea ice with seaice salinity, SA_seaice.  This result</span>
<span class="sd">    is proven in McDougall et al. (2014).</span>

<span class="sd">    The output, melting_seaice_equilibrium_SA_CT_ratio, is dSA/dCT rather</span>
<span class="sd">    than dCT/dSA.  This is done so that when SA = 0, the output, dSA/dCT is</span>
<span class="sd">    zero whereas dCT/dSA would be infinite.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="sd">    See Eqn. (29) of this manuscript.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_seaice_equilibrium_sa_ct_ratio</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">melting_seaice_equilibrium_SA_CT_ratio</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_seaice_equilibrium_sa_ct_ratio</span><span class="o">.</span><span class="n">types</span>
<span class="n">melting_seaice_equilibrium_SA_CT_ratio</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">melting_seaice_equilibrium_SA_CT_ratio</span><span class="p">)</span>

<div class="viewcode-block" id="melting_seaice_equilibrium_SA_CT_ratio_poly">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.melting_seaice_equilibrium_SA_CT_ratio_poly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">melting_seaice_equilibrium_SA_CT_ratio_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the ratio of SA to CT changes when sea ice melts into</span>
<span class="sd">    seawater with both the seawater and the sea ice temperatures being</span>
<span class="sd">    almost equal to the equilibrium freezing temperature.  It is assumed</span>
<span class="sd">    that a small mass of seaice melts into an infinite mass of seawater.  If</span>
<span class="sd">    indeed the temperature of the seawater and the sea ice were both equal</span>
<span class="sd">    to the freezing temperature, then no melting or freezing would occur; an</span>
<span class="sd">    imbalance between these three temperatures is needed for freezing or</span>
<span class="sd">    melting to occur (the three temperatures being (1) the seawater</span>
<span class="sd">    temperature, (2) the sea ice temperature, and (3) the freezing</span>
<span class="sd">    temperature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    melting_seaice_equilibrium_SA_CT_ratio : array-like, g/(kg K)</span>
<span class="sd">        the ratio dSA/dCT of SA to CT</span>
<span class="sd">        changes when sea ice melts into seawater, with</span>
<span class="sd">        the seawater and sea ice being close to the</span>
<span class="sd">        freezing temperature.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the output of this function, dSA/dCT is independent of the</span>
<span class="sd">    sea ice salinity, SA_seaice.  That is, the output applies equally to</span>
<span class="sd">    pure ice Ih and to sea ice with seaice salinity, SA_seaice.  This result</span>
<span class="sd">    is proven in McDougall et al. (2014).</span>

<span class="sd">    The output, melting_seaice_equilibrium_SA_CT_ratio, is dSA/dCT rather</span>
<span class="sd">    than dCT/dSA.  This is done so that when SA = 0, the output, dSA/dCT is</span>
<span class="sd">    zero whereas dCT/dSA would be infinite.</span>

<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="sd">    See Eqn. (29) of this manuscript.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_seaice_equilibrium_sa_ct_ratio_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">melting_seaice_equilibrium_SA_CT_ratio_poly</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_seaice_equilibrium_sa_ct_ratio_poly</span><span class="o">.</span><span class="n">types</span>
<span class="n">melting_seaice_equilibrium_SA_CT_ratio_poly</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">melting_seaice_equilibrium_SA_CT_ratio_poly</span><span class="p">)</span>

<div class="viewcode-block" id="melting_seaice_into_seawater">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.melting_seaice_into_seawater">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">melting_seaice_into_seawater</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w_seaice</span><span class="p">,</span> <span class="n">SA_seaice</span><span class="p">,</span> <span class="n">t_seaice</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Absolute Salinity and Conservative Temperature that</span>
<span class="sd">    results when a given mass of sea ice (or ice) melts and is mixed into a</span>
<span class="sd">    known mass of seawater (whose properties are (SA,CT,p)).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    w_seaice : array-like</span>
<span class="sd">        mass fraction of ice: the mass of sea-ice divided by the sum</span>
<span class="sd">        of the masses of sea-ice and seawater. 0 &lt;= wIh &lt;= 1. unitless.</span>
<span class="sd">    SA_seaice : array-like</span>
<span class="sd">        Absolute Salinity of sea ice: the mass fraction of salt</span>
<span class="sd">        in sea ice, expressed in g of salt per kg of sea ice.</span>
<span class="sd">    t_seaice : array-like</span>
<span class="sd">        In-situ temperature of the sea ice at pressure p (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SA_final : array-like, g/kg</span>
<span class="sd">        Absolute Salinity of the mixture of the melted sea ice</span>
<span class="sd">        (or ice) and the original seawater</span>
<span class="sd">    CT_final : array-like, deg C</span>
<span class="sd">        Conservative Temperature of the mixture of the melted</span>
<span class="sd">        sea ice (or ice) and the original seawater</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    If the ice contains no salt (e.g. if it is of glacial origin), then the</span>
<span class="sd">    input &#39;SA_seaice&#39; should be set to zero.</span>

<span class="sd">    Ice formed at the sea surface (sea ice) typically contains between 2 g/kg</span>
<span class="sd">    and 12 g/kg of salt (defined as the mass of salt divided by the mass of</span>
<span class="sd">    ice Ih plus brine) and this programme returns NaN&#39;s if the input</span>
<span class="sd">    SA_seaice is greater than 15 g/kg.  If the SA_seaice input is not zero,</span>
<span class="sd">    usually this would imply that the pressure p should be zero, as sea ice</span>
<span class="sd">    only occurs near the sea surface.  The code does not impose that p = 0</span>
<span class="sd">    if SA_seaice is non-zero.  Rather, this is left to the user.</span>

<span class="sd">    The Absolute Salinity, SA_brine, of the brine trapped in little pockets</span>
<span class="sd">    in the sea ice, is in thermodynamic equilibrium with the ice Ih that</span>
<span class="sd">    surrounds these pockets.  As the sea ice temperature, t_seaice, may be</span>
<span class="sd">    less than the freezing temperature, SA_brine is usually greater than the</span>
<span class="sd">    Absolute Salinity of the seawater at the time and place when and where</span>
<span class="sd">    the sea ice was formed.  So usually SA_brine will be larger than SA.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="sd">    Eqns. (8) and (9) are the simplifications when SA_seaice = 0.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_seaice_into_seawater</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">w_seaice</span><span class="p">,</span> <span class="n">SA_seaice</span><span class="p">,</span> <span class="n">t_seaice</span><span class="p">)</span></div>

<span class="n">melting_seaice_into_seawater</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_seaice_into_seawater</span><span class="o">.</span><span class="n">types</span>
<span class="n">melting_seaice_into_seawater</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">melting_seaice_into_seawater</span><span class="p">)</span>

<div class="viewcode-block" id="melting_seaice_SA_CT_ratio">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.melting_seaice_SA_CT_ratio">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">melting_seaice_SA_CT_ratio</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">SA_seaice</span><span class="p">,</span> <span class="n">t_seaice</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the ratio of SA to CT changes when sea ice melts into</span>
<span class="sd">    seawater.  It is assumed that a small mass of sea ice melts into an</span>
<span class="sd">    infinite mass of seawater.  Because of the infinite mass of seawater,</span>
<span class="sd">    the sea ice will always melt.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    SA_seaice : array-like</span>
<span class="sd">        Absolute Salinity of sea ice: the mass fraction of salt</span>
<span class="sd">        in sea ice, expressed in g of salt per kg of sea ice.</span>
<span class="sd">    t_seaice : array-like</span>
<span class="sd">        In-situ temperature of the sea ice at pressure p (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    melting_seaice_SA_CT_ratio : array-like, g/(kg K)</span>
<span class="sd">        the ratio dSA/dCT of SA to CT changes when</span>
<span class="sd">        sea ice melts into a large mass of seawater</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Ice formed at the sea surface (sea ice) typically contains between 2 g/kg</span>
<span class="sd">    and 12 g/kg of salt (defined as the mass of salt divided by the mass of</span>
<span class="sd">    ice Ih plus brine) and this programme returns NaN&#39;s if the input</span>
<span class="sd">    SA_seaice is greater than 15 g/kg.  If the SA_seaice input is not zero,</span>
<span class="sd">    usually this would imply that the pressure p should be zero, as sea ice</span>
<span class="sd">    only occurs near the sea surface.  The code does not impose that p = 0</span>
<span class="sd">    if SA_seaice is non-zero.  Rather, this is left to the user.</span>

<span class="sd">    The Absolute Salinity, SA_brine, of the brine trapped in little pockets</span>
<span class="sd">    in the sea ice, is in thermodynamic equilibrium with the ice Ih that</span>
<span class="sd">    surrounds these pockets.  As the seaice temperature, t_seaice, may be</span>
<span class="sd">    less than the freezing temperature, SA_brine is usually greater than the</span>
<span class="sd">    Absolute Salinity of the seawater at the time and place when and where</span>
<span class="sd">    the sea ice was formed.  So usually SA_brine will be larger than SA.</span>

<span class="sd">    The output, melting_seaice_SA_CT_ratio, is dSA/dCT rather than dCT/dSA.</span>
<span class="sd">    This is done so that when (SA - seaice_SA) = 0, the output, dSA/dCT is</span>
<span class="sd">    zero whereas dCT/dSA would be infinite.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="sd">    See Eqn. (28) of this manuscript.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_seaice_sa_ct_ratio</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">SA_seaice</span><span class="p">,</span> <span class="n">t_seaice</span><span class="p">)</span></div>

<span class="n">melting_seaice_SA_CT_ratio</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_seaice_sa_ct_ratio</span><span class="o">.</span><span class="n">types</span>
<span class="n">melting_seaice_SA_CT_ratio</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">melting_seaice_SA_CT_ratio</span><span class="p">)</span>

<div class="viewcode-block" id="melting_seaice_SA_CT_ratio_poly">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.melting_seaice_SA_CT_ratio_poly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">melting_seaice_SA_CT_ratio_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">SA_seaice</span><span class="p">,</span> <span class="n">t_seaice</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the ratio of SA to CT changes when sea ice melts into</span>
<span class="sd">    seawater.  It is assumed that a small mass of sea ice melts into an</span>
<span class="sd">    infinite mass of seawater.  Because of the infinite mass of seawater,</span>
<span class="sd">    the sea ice will always melt.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    SA_seaice : array-like</span>
<span class="sd">        Absolute Salinity of sea ice: the mass fraction of salt</span>
<span class="sd">        in sea ice, expressed in g of salt per kg of sea ice.</span>
<span class="sd">    t_seaice : array-like</span>
<span class="sd">        In-situ temperature of the sea ice at pressure p (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    melting_seaice_SA_CT_ratio : array-like, g/(kg K)</span>
<span class="sd">        the ratio dSA/dCT of SA to CT changes when</span>
<span class="sd">        sea ice melts into a large mass of seawater</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Ice formed at the sea surface (sea ice) typically contains between 2 g/kg</span>
<span class="sd">    and 12 g/kg of salt (defined as the mass of salt divided by the mass of</span>
<span class="sd">    ice Ih plus brine) and this programme returns NaN&#39;s if the input</span>
<span class="sd">    SA_seaice is greater than 15 g/kg.  If the SA_seaice input is not zero,</span>
<span class="sd">    usually this would imply that the pressure p should be zero, as sea ice</span>
<span class="sd">    only occurs near the sea surface.  The code does not impose that p = 0</span>
<span class="sd">    if SA_seaice is non-zero.  Rather, this is left to the user.</span>

<span class="sd">    The Absolute Salinity, SA_brine, of the brine trapped in little pockets</span>
<span class="sd">    in the sea ice, is in thermodynamic equilibrium with the ice Ih that</span>
<span class="sd">    surrounds these pockets.  As the seaice temperature, t_seaice, may be</span>
<span class="sd">    less than the freezing temperature, SA_brine is usually greater than the</span>
<span class="sd">    Absolute Salinity of the seawater at the time and place when and where</span>
<span class="sd">    the sea ice was formed.  So usually SA_brine will be larger than SA.</span>

<span class="sd">    The output, melting_seaice_SA_CT_ratio, is dSA/dCT rather than dCT/dSA.</span>
<span class="sd">    This is done so that when (SA - seaice_SA) = 0, the output, dSA/dCT is</span>
<span class="sd">    zero whereas dCT/dSA would be infinite.</span>

<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="sd">    See Eqn. (31) of this manuscript.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_seaice_sa_ct_ratio_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">SA_seaice</span><span class="p">,</span> <span class="n">t_seaice</span><span class="p">)</span></div>

<span class="n">melting_seaice_SA_CT_ratio_poly</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">melting_seaice_sa_ct_ratio_poly</span><span class="o">.</span><span class="n">types</span>
<span class="n">melting_seaice_SA_CT_ratio_poly</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">melting_seaice_SA_CT_ratio_poly</span><span class="p">)</span>

<div class="viewcode-block" id="O2sol">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.O2sol">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">O2sol</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the oxygen concentration expected at equilibrium with air at</span>
<span class="sd">    an Absolute Pressure of 101325 Pa (sea pressure of 0 dbar) including</span>
<span class="sd">    saturated water vapor.  This function uses the solubility coefficients</span>
<span class="sd">    derived from the data of Benson and Krause (1984), as fitted by Garcia</span>
<span class="sd">    and Gordon (1992, 1993).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    lon : array-like</span>
<span class="sd">        Longitude, -360 to 360 degrees</span>
<span class="sd">    lat : array-like</span>
<span class="sd">        Latitude, -90 to 90 degrees</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    O2sol : array-like, umol/kg</span>
<span class="sd">        solubility of oxygen in micro-moles per kg</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this algorithm has not been approved by IOC and is not work</span>
<span class="sd">    from SCOR/IAPSO Working Group 127.  It is included in the GSW</span>
<span class="sd">    Oceanographic Toolbox as it seems to be oceanographic best practice.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    Benson, B.B., and D. Krause, 1984: The concentration and isotopic</span>
<span class="sd">    fractionation of oxygen dissolved in freshwater and seawater in</span>
<span class="sd">    equilibrium with the atmosphere. Limnology and Oceanography, 29,</span>
<span class="sd">    620-632.</span>

<span class="sd">    Garcia, H.E., and L.I. Gordon, 1992: Oxygen solubility in seawater:</span>
<span class="sd">    Better fitting equations. Limnology and Oceanography, 37, 1307-1312.</span>

<span class="sd">    Garcia, H.E., and L.I. Gordon, 1993: Erratum: Oxygen solubility in</span>
<span class="sd">    seawater: better fitting equations. Limnology and Oceanography, 38,</span>
<span class="sd">    656.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">o2sol</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span></div>

<span class="n">O2sol</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">o2sol</span><span class="o">.</span><span class="n">types</span>
<span class="n">O2sol</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">O2sol</span><span class="p">)</span>

<div class="viewcode-block" id="O2sol_SP_pt">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.O2sol_SP_pt">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">O2sol_SP_pt</span><span class="p">(</span><span class="n">SP</span><span class="p">,</span> <span class="n">pt</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the oxygen concentration expected at equilibrium with air at</span>
<span class="sd">    an Absolute Pressure of 101325 Pa (sea pressure of 0 dbar) including</span>
<span class="sd">    saturated water vapor.  This function uses the solubility coefficients</span>
<span class="sd">    derived from the data of Benson and Krause (1984), as fitted by Garcia</span>
<span class="sd">    and Gordon (1992, 1993).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SP : array-like</span>
<span class="sd">        Practical Salinity (PSS-78), unitless</span>
<span class="sd">    pt : array-like</span>
<span class="sd">        Potential temperature referenced to a sea pressure, degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    O2sol : array-like, umol/kg</span>
<span class="sd">        solubility of oxygen in micro-moles per kg</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this algorithm has not been approved by IOC and is not work</span>
<span class="sd">    from SCOR/IAPSO Working Group 127. It is included in the GSW</span>
<span class="sd">    Oceanographic Toolbox as it seems to be oceanographic best practice.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    Benson, B.B., and D. Krause, 1984: The concentration and isotopic</span>
<span class="sd">    fractionation of oxygen dissolved in freshwater and seawater in</span>
<span class="sd">    equilibrium with the atmosphere. Limnology and Oceanography, 29,</span>
<span class="sd">    620-632.</span>

<span class="sd">    Garcia, H.E., and L.I. Gordon, 1992: Oxygen solubility in seawater:</span>
<span class="sd">    Better fitting equations. Limnology and Oceanography, 37, 1307-1312.</span>

<span class="sd">    Garcia, H.E., and L.I. Gordon, 1993: Erratum: Oxygen solubility in</span>
<span class="sd">    seawater: better fitting equations. Limnology and Oceanography, 38,</span>
<span class="sd">    656.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">o2sol_sp_pt</span><span class="p">(</span><span class="n">SP</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span></div>

<span class="n">O2sol_SP_pt</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">o2sol_sp_pt</span><span class="o">.</span><span class="n">types</span>
<span class="n">O2sol_SP_pt</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">O2sol_SP_pt</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">p_from_z</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">geo_strf_dyn_height</span><span class="p">,</span> <span class="n">sea_surface_geopotential</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates sea pressure from height using computationally-efficient</span>
<span class="sd">    75-term expression for density, in terms of SA, CT and p (Roquet et al.,</span>
<span class="sd">    2015).  Dynamic height anomaly, geo_strf_dyn_height, if provided,</span>
<span class="sd">    must be computed with its p_ref = 0 (the surface). Also if provided,</span>
<span class="sd">    sea_surface_geopotental is the geopotential at zero sea pressure. This</span>
<span class="sd">    function solves Eqn.(3.32.3) of IOC et al. (2010) iteratively for p.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    z : array-like</span>
<span class="sd">        Depth, positive up, m</span>
<span class="sd">    lat : array-like</span>
<span class="sd">        Latitude, -90 to 90 degrees</span>
<span class="sd">    geo_strf_dyn_height : array-like</span>
<span class="sd">        dynamic height anomaly, m^2/s^2</span>
<span class="sd">            Note that the reference pressure, p_ref, of geo_strf_dyn_height must</span>
<span class="sd">            be zero (0) dbar.</span>
<span class="sd">    sea_surface_geopotential : array-like</span>
<span class="sd">        geopotential at zero sea pressure,  m^2/s^2</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    p : array-like, dbar</span>
<span class="sd">        sea pressure</span>
<span class="sd">        ( i.e. absolute pressure - 10.1325 dbar )</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note. Height (z) is NEGATIVE in the ocean.  Depth is -z.</span>
<span class="sd">    Depth is not used in the GSW computer software library.</span>

<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    McDougall, T.J., and S.J. Wotherspoon, 2013: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, pp. 20-25.</span>

<span class="sd">    Moritz, H., 2000: Geodetic reference system 1980. J. Geodesy, 74,</span>
<span class="sd">    pp. 128-133.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling, 90, pp. 29-43.</span>

<span class="sd">    Saunders, P.M., 1981: Practical conversion of pressure to depth.</span>
<span class="sd">    Journal of Physical Oceanography, 11, pp. 573-574.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">p_from_z</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">geo_strf_dyn_height</span><span class="p">,</span> <span class="n">sea_surface_geopotential</span><span class="p">)</span>
<span class="n">p_from_z</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">p_from_z</span><span class="o">.</span><span class="n">types</span>
<span class="n">p_from_z</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">p_from_z</span><span class="p">)</span>

<div class="viewcode-block" id="pot_enthalpy_from_pt_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.pot_enthalpy_from_pt_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pot_enthalpy_from_pt_ice</span><span class="p">(</span><span class="n">pt0_ice</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the potential enthalpy of ice from potential temperature of</span>
<span class="sd">    ice (whose reference sea pressure is zero dbar).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pt0_ice : array-like</span>
<span class="sd">        Potential temperature of ice (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pot_enthalpy_ice : array-like, J/kg</span>
<span class="sd">        potential enthalpy of ice</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pot_enthalpy_from_pt_ice</span><span class="p">(</span><span class="n">pt0_ice</span><span class="p">)</span></div>

<span class="n">pot_enthalpy_from_pt_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pot_enthalpy_from_pt_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">pot_enthalpy_from_pt_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pot_enthalpy_from_pt_ice</span><span class="p">)</span>

<div class="viewcode-block" id="pot_enthalpy_from_pt_ice_poly">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.pot_enthalpy_from_pt_ice_poly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pot_enthalpy_from_pt_ice_poly</span><span class="p">(</span><span class="n">pt0_ice</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the potential enthalpy of ice from potential temperature of</span>
<span class="sd">    ice (whose reference sea pressure is zero dbar).  This is a</span>
<span class="sd">    compuationally efficient polynomial fit to the potential enthalpy of</span>
<span class="sd">    ice.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pt0_ice : array-like</span>
<span class="sd">        Potential temperature of ice (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pot_enthalpy_ice : array-like, J/kg</span>
<span class="sd">        potential enthalpy of ice</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pot_enthalpy_from_pt_ice_poly</span><span class="p">(</span><span class="n">pt0_ice</span><span class="p">)</span></div>

<span class="n">pot_enthalpy_from_pt_ice_poly</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pot_enthalpy_from_pt_ice_poly</span><span class="o">.</span><span class="n">types</span>
<span class="n">pot_enthalpy_from_pt_ice_poly</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pot_enthalpy_from_pt_ice_poly</span><span class="p">)</span>

<div class="viewcode-block" id="pot_enthalpy_ice_freezing">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.pot_enthalpy_ice_freezing">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pot_enthalpy_ice_freezing</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the potential enthalpy of ice at which seawater freezes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pot_enthalpy_ice_freezing : array-like, J/kg</span>
<span class="sd">        potential enthalpy of ice at freezing</span>
<span class="sd">        of seawater</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pot_enthalpy_ice_freezing</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">pot_enthalpy_ice_freezing</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pot_enthalpy_ice_freezing</span><span class="o">.</span><span class="n">types</span>
<span class="n">pot_enthalpy_ice_freezing</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pot_enthalpy_ice_freezing</span><span class="p">)</span>

<div class="viewcode-block" id="pot_enthalpy_ice_freezing_first_derivatives">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.pot_enthalpy_ice_freezing_first_derivatives">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pot_enthalpy_ice_freezing_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the first derivatives of the potential enthalpy of ice at</span>
<span class="sd">    which seawater freezes, with respect to Absolute Salinity SA and</span>
<span class="sd">    pressure P (in Pa).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pot_enthalpy_ice_freezing_SA : array-like, K kg/g</span>
<span class="sd">        the derivative of the potential enthalpy</span>
<span class="sd">        of ice at freezing (ITS-90) with respect to Absolute</span>
<span class="sd">        salinity at fixed pressure  [ K/(g/kg) ] i.e.</span>
<span class="sd">    pot_enthalpy_ice_freezing_P : array-like, K/Pa</span>
<span class="sd">        the derivative of the potential enthalpy</span>
<span class="sd">        of ice at freezing (ITS-90) with respect to pressure</span>
<span class="sd">        (in Pa) at fixed Absolute Salinity</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pot_enthalpy_ice_freezing_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">pot_enthalpy_ice_freezing_first_derivatives</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pot_enthalpy_ice_freezing_first_derivatives</span><span class="o">.</span><span class="n">types</span>
<span class="n">pot_enthalpy_ice_freezing_first_derivatives</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pot_enthalpy_ice_freezing_first_derivatives</span><span class="p">)</span>

<div class="viewcode-block" id="pot_enthalpy_ice_freezing_first_derivatives_poly">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.pot_enthalpy_ice_freezing_first_derivatives_poly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pot_enthalpy_ice_freezing_first_derivatives_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the first derivatives of the potential enthalpy of ice Ih at</span>
<span class="sd">    which ice melts into seawater with Absolute Salinity SA and at pressure</span>
<span class="sd">    p.  This code uses the computationally efficient polynomial fit of the</span>
<span class="sd">    freezing potential enthalpy of ice Ih (McDougall et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pot_enthalpy_ice_freezing_SA : array-like, J/g</span>
<span class="sd">        the derivative of the potential enthalpy</span>
<span class="sd">        of ice at freezing (ITS-90) with respect to Absolute</span>
<span class="sd">        salinity at fixed pressure  [ (J/kg)/(g/kg) ] i.e.</span>
<span class="sd">    pot_enthalpy_ice_freezing_P : array-like, (J/kg)/Pa</span>
<span class="sd">        the derivative of the potential enthalpy</span>
<span class="sd">        of ice at freezing (ITS-90) with respect to pressure</span>
<span class="sd">        (in Pa) at fixed Absolute Salinity</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>

<span class="sd">    McDougall et al. 2015: A reference for this polynomial.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pot_enthalpy_ice_freezing_first_derivatives_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">pot_enthalpy_ice_freezing_first_derivatives_poly</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pot_enthalpy_ice_freezing_first_derivatives_poly</span><span class="o">.</span><span class="n">types</span>
<span class="n">pot_enthalpy_ice_freezing_first_derivatives_poly</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pot_enthalpy_ice_freezing_first_derivatives_poly</span><span class="p">)</span>

<div class="viewcode-block" id="pot_enthalpy_ice_freezing_poly">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.pot_enthalpy_ice_freezing_poly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pot_enthalpy_ice_freezing_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the potential enthalpy of ice at which seawater freezes.</span>
<span class="sd">    The error of this fit ranges between -2.5 and 1 J/kg with an rms of</span>
<span class="sd">    1.07, between SA of 0 and 120 g/kg and p between 0 and 10,000 dbar (the</span>
<span class="sd">    error in the fit is between -0.7 and 0.7 with an rms of</span>
<span class="sd">    0.3, between SA of 0 and 120 g/kg and p between 0 and 5,000 dbar) when</span>
<span class="sd">    compared with the potential enthalpy calculated from the exact in-situ</span>
<span class="sd">    freezing temperature which is found by a Newton-Raphson iteration of the</span>
<span class="sd">    equality of the chemical potentials of water in seawater and in ice.</span>
<span class="sd">    Note that the potential enthalpy at freezing can be found</span>
<span class="sd">    by this exact method using the function gsw_pot_enthalpy_ice_freezing.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pot_enthalpy_ice_freezing : array-like, J/kg</span>
<span class="sd">        potential enthalpy of ice at freezing</span>
<span class="sd">        of seawater</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pot_enthalpy_ice_freezing_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">pot_enthalpy_ice_freezing_poly</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pot_enthalpy_ice_freezing_poly</span><span class="o">.</span><span class="n">types</span>
<span class="n">pot_enthalpy_ice_freezing_poly</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pot_enthalpy_ice_freezing_poly</span><span class="p">)</span>

<div class="viewcode-block" id="pot_rho_t_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.pot_rho_t_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pot_rho_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p_ref</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential density of seawater.  Note. This function outputs</span>
<span class="sd">    potential density, not potential density anomaly; that is, 1000 kg/m^3</span>
<span class="sd">    is not subtracted.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    p_ref : array-like</span>
<span class="sd">        Reference pressure, dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pot_rho_t_exact : array-like, kg/m^3</span>
<span class="sd">        potential density (not potential density anomaly)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 3.4 of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pot_rho_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p_ref</span><span class="p">)</span></div>

<span class="n">pot_rho_t_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pot_rho_t_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">pot_rho_t_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pot_rho_t_exact</span><span class="p">)</span>

<div class="viewcode-block" id="pressure_coefficient_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.pressure_coefficient_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pressure_coefficient_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates pressure coefficient of ice.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pressure_coefficient_ice : array-like, Pa/K</span>
<span class="sd">        pressure coefficient of ice</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqn. (2.15.1) of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pressure_coefficient_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">pressure_coefficient_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pressure_coefficient_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">pressure_coefficient_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pressure_coefficient_ice</span><span class="p">)</span>

<div class="viewcode-block" id="pressure_freezing_CT">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.pressure_freezing_CT">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pressure_freezing_CT</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the pressure (in dbar) of seawater at the freezing</span>
<span class="sd">    temperature.  That is, the output is the pressure at which seawater,</span>
<span class="sd">    with Absolute Salinity SA, Conservative Temperature CT, and with</span>
<span class="sd">    saturation_fraction of dissolved air, freezes.  If the input values are</span>
<span class="sd">    such that there is no value of pressure in the range between 0 dbar and</span>
<span class="sd">    10,000 dbar for which seawater is at the freezing temperature, the</span>
<span class="sd">    output, pressure_freezing, is put equal to NaN.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    saturation_fraction : array-like</span>
<span class="sd">        Saturation fraction of dissolved air in seawater. (0..1)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pressure_freezing : array-like, dbar</span>
<span class="sd">        sea pressure at which the seawater freezes</span>
<span class="sd">        ( i.e. absolute pressure - 10.1325 dbar )</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See section 3.33 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall T. J. and S. J. Wotherspoon, 2013: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pressure_freezing_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">)</span></div>

<span class="n">pressure_freezing_CT</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pressure_freezing_ct</span><span class="o">.</span><span class="n">types</span>
<span class="n">pressure_freezing_CT</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pressure_freezing_CT</span><span class="p">)</span>

<div class="viewcode-block" id="pt0_from_t">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.pt0_from_t">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pt0_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential temperature with reference pressure, p_ref = 0 dbar.</span>
<span class="sd">    The present routine is computationally faster than the more general</span>
<span class="sd">    function &quot;gsw_pt_from_t(SA,t,p,p_ref)&quot; which can be used for any</span>
<span class="sd">    reference pressure value.</span>
<span class="sd">    This subroutine calls &quot;gsw_entropy_part(SA,t,p)&quot;,</span>
<span class="sd">    &quot;gsw_entropy_part_zerop(SA,pt0)&quot; and &quot;gsw_gibbs_pt0_pt0(SA,pt0)&quot;.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pt0 : array-like, deg C</span>
<span class="sd">        potential temperature</span>
<span class="sd">        with reference sea pressure (p_ref) = 0 dbar.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 3.1 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall T. J. and S. J. Wotherspoon, 2013: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt0_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">pt0_from_t</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt0_from_t</span><span class="o">.</span><span class="n">types</span>
<span class="n">pt0_from_t</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pt0_from_t</span><span class="p">)</span>

<div class="viewcode-block" id="pt0_from_t_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.pt0_from_t_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pt0_from_t_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential temperature of ice Ih with a reference pressure of</span>
<span class="sd">    0 dbar, from in-situ temperature, t.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pt0_ice : array-like, deg C</span>
<span class="sd">        potential temperature of ice Ih with reference pressure of</span>
<span class="sd">        zero dbar (ITS-90)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix I of this TEOS-10 Manual.</span>

<span class="sd">    McDougall T. J. and S. J. Wotherspoon, 2013: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt0_from_t_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">pt0_from_t_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt0_from_t_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">pt0_from_t_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pt0_from_t_ice</span><span class="p">)</span>

<div class="viewcode-block" id="pt_first_derivatives">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.pt_first_derivatives">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pt_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following two partial derivatives of potential</span>
<span class="sd">    temperature (the regular potential temperature whose reference sea</span>
<span class="sd">    pressure is 0 dbar)</span>
<span class="sd">    (1) pt_SA, the derivative with respect to Absolute Salinity at</span>
<span class="sd">    constant Conservative Temperature, and</span>
<span class="sd">    (2) pt_CT, the derivative with respect to Conservative Temperature at</span>
<span class="sd">    constant Absolute Salinity.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pt_SA : array-like, K/(g/kg)</span>
<span class="sd">        The derivative of potential temperature with respect to</span>
<span class="sd">        Absolute Salinity at constant Conservative Temperature.</span>
<span class="sd">    pt_CT : array-like, unitless</span>
<span class="sd">        The derivative of potential temperature with respect to</span>
<span class="sd">        Conservative Temperature at constant Absolute Salinity.</span>
<span class="sd">        pt_CT is dimensionless.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See Eqns. (A.12.6), (A.12.3), (P.6) and (P.8) of this TEOS-10 Manual.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">)</span></div>

<span class="n">pt_first_derivatives</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt_first_derivatives</span><span class="o">.</span><span class="n">types</span>
<span class="n">pt_first_derivatives</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pt_first_derivatives</span><span class="p">)</span>

<div class="viewcode-block" id="pt_from_CT">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.pt_from_CT">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pt_from_CT</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential temperature (with a reference sea pressure of</span>
<span class="sd">    zero dbar) from Conservative Temperature.  This function uses 1.5</span>
<span class="sd">    iterations through a modified Newton-Raphson (N-R) iterative solution</span>
<span class="sd">    procedure, starting from a rational-function-based initial condition</span>
<span class="sd">    for both pt and dCT_dpt.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pt : array-like, deg C</span>
<span class="sd">        potential temperature referenced to a sea pressure</span>
<span class="sd">        of zero dbar (ITS-90)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See sections 3.1 and 3.3 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., and S.J. Wotherspoon, 2014: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">)</span></div>

<span class="n">pt_from_CT</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt_from_ct</span><span class="o">.</span><span class="n">types</span>
<span class="n">pt_from_CT</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pt_from_CT</span><span class="p">)</span>

<div class="viewcode-block" id="pt_from_entropy">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.pt_from_entropy">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pt_from_entropy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">entropy</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential temperature with reference pressure p_ref = 0 dbar</span>
<span class="sd">    and with entropy as an input variable.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    entropy : array-like</span>
<span class="sd">        Specific entropy, J/(kg*K)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pt : array-like, deg C</span>
<span class="sd">        potential temperature</span>
<span class="sd">        with reference sea pressure (p_ref) = 0 dbar.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix  A.10 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall T. J. and S. J. Wotherspoon, 2013: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt_from_entropy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">entropy</span><span class="p">)</span></div>

<span class="n">pt_from_entropy</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt_from_entropy</span><span class="o">.</span><span class="n">types</span>
<span class="n">pt_from_entropy</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pt_from_entropy</span><span class="p">)</span>

<div class="viewcode-block" id="pt_from_pot_enthalpy_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.pt_from_pot_enthalpy_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pt_from_pot_enthalpy_ice</span><span class="p">(</span><span class="n">pot_enthalpy_ice</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the potential temperature of ice from the potential enthalpy</span>
<span class="sd">    of ice.  The reference sea pressure of both the potential temperature</span>
<span class="sd">    and the potential enthalpy is zero dbar.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pot_enthalpy_ice : array-like</span>
<span class="sd">        Potential enthalpy of ice, J/kg</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pt0_ice : array-like, deg C</span>
<span class="sd">        potential temperature of ice (ITS-90)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>

<span class="sd">    McDougall T. J. and S. J. Wotherspoon, 2014: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt_from_pot_enthalpy_ice</span><span class="p">(</span><span class="n">pot_enthalpy_ice</span><span class="p">)</span></div>

<span class="n">pt_from_pot_enthalpy_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt_from_pot_enthalpy_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">pt_from_pot_enthalpy_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pt_from_pot_enthalpy_ice</span><span class="p">)</span>

<div class="viewcode-block" id="pt_from_pot_enthalpy_ice_poly">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.pt_from_pot_enthalpy_ice_poly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pt_from_pot_enthalpy_ice_poly</span><span class="p">(</span><span class="n">pot_enthalpy_ice</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the potential temperature of ice (whose reference sea</span>
<span class="sd">    pressure is zero dbar) from the potential enthalpy of ice.  This is a</span>
<span class="sd">    compuationally efficient polynomial fit to the potential enthalpy of</span>
<span class="sd">    ice.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pot_enthalpy_ice : array-like</span>
<span class="sd">        Potential enthalpy of ice, J/kg</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pt0_ice : array-like, deg C</span>
<span class="sd">        potential temperature of ice (ITS-90)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt_from_pot_enthalpy_ice_poly</span><span class="p">(</span><span class="n">pot_enthalpy_ice</span><span class="p">)</span></div>

<span class="n">pt_from_pot_enthalpy_ice_poly</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt_from_pot_enthalpy_ice_poly</span><span class="o">.</span><span class="n">types</span>
<span class="n">pt_from_pot_enthalpy_ice_poly</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pt_from_pot_enthalpy_ice_poly</span><span class="p">)</span>

<div class="viewcode-block" id="pt_from_t">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.pt_from_t">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pt_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p_ref</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential temperature with the general reference pressure,</span>
<span class="sd">    p_ref, from in-situ temperature, t.  This function calls</span>
<span class="sd">    &quot;gsw_entropy_part&quot; which evaluates entropy except for the parts which</span>
<span class="sd">    are a function of Absolute Salinity alone.</span>
<span class="sd">    A faster gsw routine exists if p_ref is indeed zero dbar.  This routine</span>
<span class="sd">    is &quot;gsw_pt0_from_t(SA,t,p)&quot;.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    p_ref : array-like</span>
<span class="sd">        Reference pressure, dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pt : array-like, deg C</span>
<span class="sd">        potential temperature with reference pressure, p_ref, on the</span>
<span class="sd">        ITS-90 temperature scale</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 3.1 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall T. J. and S. J. Wotherspoon, 2013: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p_ref</span><span class="p">)</span></div>

<span class="n">pt_from_t</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt_from_t</span><span class="o">.</span><span class="n">types</span>
<span class="n">pt_from_t</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pt_from_t</span><span class="p">)</span>

<div class="viewcode-block" id="pt_from_t_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.pt_from_t_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pt_from_t_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p_ref</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential temperature of ice Ih with the general reference</span>
<span class="sd">    pressure, p_ref, from in-situ temperature, t.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    p_ref : array-like</span>
<span class="sd">        Reference pressure, dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pt_ice : array-like, deg C</span>
<span class="sd">        potential temperature of ice Ih with reference pressure,</span>
<span class="sd">        p_ref, on the ITS-90 temperature scale</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    A faster gsw routine exists if p_ref is indeed zero dbar.  This routine</span>
<span class="sd">    is &quot;gsw_pt0_from_t_ice(t,p)&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix I of this TEOS-10 Manual.</span>

<span class="sd">    McDougall T. J. and S. J. Wotherspoon, 2014: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt_from_t_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p_ref</span><span class="p">)</span></div>

<span class="n">pt_from_t_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt_from_t_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">pt_from_t_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pt_from_t_ice</span><span class="p">)</span>

<div class="viewcode-block" id="pt_second_derivatives">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.pt_second_derivatives">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pt_second_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following three second-order derivatives of potential</span>
<span class="sd">    temperature (the regular potential temperature which has a reference</span>
<span class="sd">    sea pressure of 0 dbar),</span>
<span class="sd">    (1) pt_SA_SA, the second derivative with respect to Absolute Salinity</span>
<span class="sd">    at constant Conservative Temperature,</span>
<span class="sd">    (2) pt_SA_CT, the derivative with respect to Conservative Temperature</span>
<span class="sd">    and Absolute Salinity, and</span>
<span class="sd">    (3) pt_CT_CT, the second derivative with respect to Conservative</span>
<span class="sd">    Temperature at constant Absolute Salinity.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pt_SA_SA : array-like, K/((g/kg)^2)</span>
<span class="sd">        The second derivative of potential temperature (the</span>
<span class="sd">        regular potential temperature which has reference sea</span>
<span class="sd">        pressure of 0 dbar) with respect to Absolute Salinity</span>
<span class="sd">        at constant Conservative Temperature.</span>
<span class="sd">    pt_SA_CT : array-like, 1/(g/kg)</span>
<span class="sd">        The derivative of potential temperature with respect</span>
<span class="sd">        to Absolute Salinity and Conservative Temperature.</span>
<span class="sd">    pt_CT_CT : array-like, 1/K</span>
<span class="sd">        The second derivative of potential temperature (the</span>
<span class="sd">        regular one with p_ref = 0 dbar) with respect to</span>
<span class="sd">        Conservative Temperature at constant SA.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See Eqns. (A.12.9) and (A.12.10) of this TEOS-10 Manual.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt_second_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">)</span></div>

<span class="n">pt_second_derivatives</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">pt_second_derivatives</span><span class="o">.</span><span class="n">types</span>
<span class="n">pt_second_derivatives</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">pt_second_derivatives</span><span class="p">)</span>

<div class="viewcode-block" id="rho">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.rho">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">rho</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates in-situ density from Absolute Salinity and Conservative</span>
<span class="sd">    Temperature, using the computationally-efficient expression for</span>
<span class="sd">    specific volume in terms of SA, CT and p  (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rho : array-like, kg/m^3</span>
<span class="sd">        in-situ density</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that potential density with respect to reference pressure, pr, is</span>
<span class="sd">    obtained by calling this function with the pressure argument being pr</span>
<span class="sd">    (i.e. &quot;gsw_rho(SA,CT,pr)&quot;).</span>

<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix A.20 and appendix K of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling, 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">rho</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">rho</span><span class="o">.</span><span class="n">types</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>

<div class="viewcode-block" id="rho_alpha_beta">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.rho_alpha_beta">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">rho_alpha_beta</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates in-situ density, the appropriate thermal expansion coefficient</span>
<span class="sd">    and the appropriate saline contraction coefficient of seawater from</span>
<span class="sd">    Absolute Salinity and Conservative Temperature.  This function uses the</span>
<span class="sd">    computationally-efficient expression for specific volume in terms of</span>
<span class="sd">    SA, CT and p (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rho : array-like, kg/m^3</span>
<span class="sd">        in-situ density</span>
<span class="sd">    alpha : array-like, 1/K</span>
<span class="sd">        thermal expansion coefficient</span>
<span class="sd">        with respect to Conservative Temperature</span>
<span class="sd">    beta : array-like, kg/g</span>
<span class="sd">        saline (i.e. haline) contraction</span>
<span class="sd">        coefficient at constant Conservative Temperature</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that potential density (pot_rho) with respect to reference pressure</span>
<span class="sd">    p_ref is obtained by calling this function with the pressure argument</span>
<span class="sd">    being p_ref as in [pot_rho, ~, ~] = gsw_rho_alpha_beta(SA,CT,p_ref).</span>

<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix A.20 and appendix K of this TEOS-10 Manual.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">rho_alpha_beta</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">rho_alpha_beta</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">rho_alpha_beta</span><span class="o">.</span><span class="n">types</span>
<span class="n">rho_alpha_beta</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">rho_alpha_beta</span><span class="p">)</span>

<div class="viewcode-block" id="rho_first_derivatives">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.rho_first_derivatives">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">rho_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the three (3) partial derivatives of in-situ density with</span>
<span class="sd">    respect to Absolute Salinity, Conservative Temperature and pressure.</span>
<span class="sd">    Note that the pressure derivative is done with respect to pressure in</span>
<span class="sd">    Pa, not dbar.  This function uses the computationally-efficient</span>
<span class="sd">    expression for specific volume in terms of SA, CT and p (Roquet et al.,</span>
<span class="sd">    2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rho_SA : array-like, (kg/m^3)(g/kg)^-1</span>
<span class="sd">        partial derivative of density</span>
<span class="sd">        with respect to Absolute Salinity</span>
<span class="sd">    rho_CT : array-like, kg/(m^3 K)</span>
<span class="sd">        partial derivative of density</span>
<span class="sd">        with respect to Conservative Temperature</span>
<span class="sd">    rho_P : array-like, kg/(m^3 Pa)</span>
<span class="sd">        partial derivative of density</span>
<span class="sd">        with respect to pressure in Pa</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix A.20 and appendix K of this TEOS-10 Manual.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">rho_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">rho_first_derivatives</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">rho_first_derivatives</span><span class="o">.</span><span class="n">types</span>
<span class="n">rho_first_derivatives</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">rho_first_derivatives</span><span class="p">)</span>

<div class="viewcode-block" id="rho_first_derivatives_wrt_enthalpy">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.rho_first_derivatives_wrt_enthalpy">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">rho_first_derivatives_wrt_enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following two first-order derivatives of rho,</span>
<span class="sd">    (1) rho_SA_wrt_h, first-order derivative with respect to Absolute</span>
<span class="sd">    Salinity at constant h &amp; p.</span>
<span class="sd">    (2) rho_h, first-order derivative with respect to h at</span>
<span class="sd">    constant SA &amp; p.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rho_SA_wrt_h : array-like, ((kg/m^3)(g/kg)^-1</span>
<span class="sd">        The first derivative of rho with respect to</span>
<span class="sd">        Absolute Salinity at constant CT &amp; p.</span>
<span class="sd">    rho_h : array-like, (m^3/kg)(J/kg)^-1</span>
<span class="sd">        The first derivative of rho with respect to</span>
<span class="sd">        SA and CT at constant p.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this function uses the using the computationally-efficient</span>
<span class="sd">    75 term expression for specific volume (Roquet et al., 2015).  There is</span>
<span class="sd">    an alternative to calling this function, namely</span>
<span class="sd">    gsw_specvol_first_derivatives_wrt_enthalpy_CT_exact(SA,CT,p) which uses</span>
<span class="sd">    the full Gibbs function (IOC et al., 2010).</span>

<span class="sd">    This 75-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot; described</span>
<span class="sd">    in McDougall et al. (2010).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">rho_first_derivatives_wrt_enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">rho_first_derivatives_wrt_enthalpy</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">rho_first_derivatives_wrt_enthalpy</span><span class="o">.</span><span class="n">types</span>
<span class="n">rho_first_derivatives_wrt_enthalpy</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">rho_first_derivatives_wrt_enthalpy</span><span class="p">)</span>

<div class="viewcode-block" id="rho_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.rho_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">rho_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates in-situ density of ice from in-situ temperature and pressure.</span>
<span class="sd">    Note that the output, rho_ice, is density, not density anomaly;  that</span>
<span class="sd">    is, 1000 kg/m^3 is not subtracted from it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rho_ice : array-like, kg/m^3</span>
<span class="sd">        in-situ density of ice (not density anomaly)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">rho_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">rho_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">rho_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">rho_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">rho_ice</span><span class="p">)</span>

<div class="viewcode-block" id="rho_second_derivatives">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.rho_second_derivatives">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">rho_second_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following five second-order derivatives of rho,</span>
<span class="sd">    (1) rho_SA_SA, second-order derivative with respect to Absolute</span>
<span class="sd">    Salinity at constant CT &amp; p.</span>
<span class="sd">    (2) rho_SA_CT, second-order derivative with respect to SA &amp; CT at</span>
<span class="sd">    constant p.</span>
<span class="sd">    (3) rho_CT_CT, second-order derivative with respect to CT at</span>
<span class="sd">    constant SA &amp; p.</span>
<span class="sd">    (4) rho_SA_P, second-order derivative with respect to SA &amp; P at</span>
<span class="sd">    constant CT.</span>
<span class="sd">    (5) rho_CT_P, second-order derivative with respect to CT &amp; P at</span>
<span class="sd">    constant SA.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rho_SA_SA : array-like, (kg/m^3)(g/kg)^-2</span>
<span class="sd">        The second-order derivative of rho with respect to</span>
<span class="sd">        Absolute Salinity at constant CT &amp; p.</span>
<span class="sd">    rho_SA_CT : array-like, (kg/m^3)(g/kg)^-1 K^-1</span>
<span class="sd">        The second-order derivative of rho with respect to</span>
<span class="sd">        SA and CT at constant p.</span>
<span class="sd">    rho_CT_CT : array-like, (kg/m^3) K^-2</span>
<span class="sd">        The second-order derivative of rho with respect to CT at</span>
<span class="sd">        constant SA &amp; p</span>
<span class="sd">    rho_SA_P : array-like, (kg/m^3)(g/kg)^-1 Pa^-1</span>
<span class="sd">        The second-order derivative with respect to SA &amp; P at</span>
<span class="sd">        constant CT.</span>
<span class="sd">    rho_CT_P : array-like, (kg/m^3) K^-1 Pa^-1</span>
<span class="sd">        The second-order derivative with respect to CT &amp; P at</span>
<span class="sd">        constant SA.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this function uses the using the computationally-efficient</span>
<span class="sd">    expression for specific volume (Roquet et al., 2015).  There is an</span>
<span class="sd">    alternative to calling this function, namely</span>
<span class="sd">    gsw_rho_second_derivatives_CT_exact(SA,CT,p) which uses the full Gibbs</span>
<span class="sd">    function (IOC et al., 2010).</span>

<span class="sd">    This 75-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot; described</span>
<span class="sd">    in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">rho_second_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">rho_second_derivatives</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">rho_second_derivatives</span><span class="o">.</span><span class="n">types</span>
<span class="n">rho_second_derivatives</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">rho_second_derivatives</span><span class="p">)</span>

<div class="viewcode-block" id="rho_second_derivatives_wrt_enthalpy">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.rho_second_derivatives_wrt_enthalpy">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">rho_second_derivatives_wrt_enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following three second-order derivatives of rho with</span>
<span class="sd">    respect to enthalpy,</span>
<span class="sd">    (1) rho_SA_SA, second-order derivative with respect to Absolute Salinity</span>
<span class="sd">    at constant h &amp; p.</span>
<span class="sd">    (2) rho_SA_h, second-order derivative with respect to SA &amp; h at</span>
<span class="sd">    constant p.</span>
<span class="sd">    (3) rho_h_h, second-order derivative with respect to h at</span>
<span class="sd">    constant SA &amp; p.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rho_SA_SA : array-like, (kg/m^3)(g/kg)^-2</span>
<span class="sd">        The second-order derivative of rho with respect to</span>
<span class="sd">        Absolute Salinity at constant h &amp; p.</span>
<span class="sd">    rho_SA_h : array-like, J/(kg K(g/kg))</span>
<span class="sd">        The second-order derivative of rho with respect to</span>
<span class="sd">        SA and h at constant p.</span>
<span class="sd">    rho_h_h : array-like,</span>
<span class="sd">        The second-order derivative of rho with respect to h at</span>
<span class="sd">        constant SA &amp; p</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this function uses the using the computationally-efficient</span>
<span class="sd">    expression for specific volume (Roquet et al., 2015).  There is an</span>
<span class="sd">    alternative to calling this function, namely</span>
<span class="sd">    gsw_rho_second_derivatives_wrt_enthalpy_CT_exact(SA,CT,p) which uses</span>
<span class="sd">    the full Gibbs function (IOC et al., 2010).</span>

<span class="sd">    This 75-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot; described</span>
<span class="sd">    in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">rho_second_derivatives_wrt_enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">rho_second_derivatives_wrt_enthalpy</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">rho_second_derivatives_wrt_enthalpy</span><span class="o">.</span><span class="n">types</span>
<span class="n">rho_second_derivatives_wrt_enthalpy</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">rho_second_derivatives_wrt_enthalpy</span><span class="p">)</span>

<div class="viewcode-block" id="rho_t_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.rho_t_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">rho_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates in-situ density of seawater from Absolute Salinity and</span>
<span class="sd">    in-situ temperature.  Note that the output, rho, is density,</span>
<span class="sd">    not density anomaly; that is, 1000 kg/m^3 is not subtracted from it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rho_t_exact : array-like, kg/m^3</span>
<span class="sd">        in-situ density (not density anomaly)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 2.8 of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">rho_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">rho_t_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">rho_t_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">rho_t_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">rho_t_exact</span><span class="p">)</span>

<div class="viewcode-block" id="SA_freezing_from_CT">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SA_freezing_from_CT">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SA_freezing_from_CT</span><span class="p">(</span><span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Absolute Salinity of seawater at the freezing temperature.</span>
<span class="sd">    That is, the output is the Absolute Salinity of seawater, with</span>
<span class="sd">    Conservative Temperature CT, pressure p and the fraction</span>
<span class="sd">    saturation_fraction of dissolved air, that is in equilibrium</span>
<span class="sd">    with ice at the same in situ temperature and pressure.  If the input</span>
<span class="sd">    values are such that there is no positive value of Absolute Salinity for</span>
<span class="sd">    which seawater is frozen, the output, SA_freezing, is made a NaN.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    saturation_fraction : array-like</span>
<span class="sd">        Saturation fraction of dissolved air in seawater. (0..1)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SA_freezing : array-like, g/kg</span>
<span class="sd">        Absolute Salinity of seawater when it freezes, for</span>
<span class="sd">        given input values of its Conservative Temperature,</span>
<span class="sd">        pressure and air saturation fraction.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See section 3.33 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>

<span class="sd">    McDougall, T.J., and S.J. Wotherspoon, 2014: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sa_freezing_from_ct</span><span class="p">(</span><span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">)</span></div>

<span class="n">SA_freezing_from_CT</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sa_freezing_from_ct</span><span class="o">.</span><span class="n">types</span>
<span class="n">SA_freezing_from_CT</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SA_freezing_from_CT</span><span class="p">)</span>

<div class="viewcode-block" id="SA_freezing_from_CT_poly">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SA_freezing_from_CT_poly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SA_freezing_from_CT_poly</span><span class="p">(</span><span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Absolute Salinity of seawater at the freezing temperature.</span>
<span class="sd">    That is, the output is the Absolute Salinity of seawater, with the</span>
<span class="sd">    fraction saturation_fraction of dissolved air, that is in equilibrium</span>
<span class="sd">    with ice at Conservative Temperature CT and pressure p.  If the input</span>
<span class="sd">    values are such that there is no positive value of Absolute Salinity for</span>
<span class="sd">    which seawater is frozen, the output, SA_freezing, is put equal to NaN.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    saturation_fraction : array-like</span>
<span class="sd">        Saturation fraction of dissolved air in seawater. (0..1)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SA_freezing : array-like, g/kg</span>
<span class="sd">        Absolute Salinity of seawater when it freezes, for</span>
<span class="sd">        given input values of Conservative Temperature</span>
<span class="sd">        pressure and air saturation fraction.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See section 3.33 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>

<span class="sd">    McDougall T. J. and S. J. Wotherspoon, 2014: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sa_freezing_from_ct_poly</span><span class="p">(</span><span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">)</span></div>

<span class="n">SA_freezing_from_CT_poly</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sa_freezing_from_ct_poly</span><span class="o">.</span><span class="n">types</span>
<span class="n">SA_freezing_from_CT_poly</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SA_freezing_from_CT_poly</span><span class="p">)</span>

<div class="viewcode-block" id="SA_freezing_from_t">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SA_freezing_from_t">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SA_freezing_from_t</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Absolute Salinity of seawater at the freezing temperature.</span>
<span class="sd">    That is, the output is the Absolute Salinity of seawater, with the</span>
<span class="sd">    fraction saturation_fraction of dissolved air, that is in equilibrium</span>
<span class="sd">    with ice at in-situ temperature t and pressure p.  If the input values</span>
<span class="sd">    are such that there is no positive value of Absolute Salinity for which</span>
<span class="sd">    seawater is frozen, the output, SA_freezing, is set to NaN.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    saturation_fraction : array-like</span>
<span class="sd">        Saturation fraction of dissolved air in seawater. (0..1)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SA_freezing : array-like, g/kg</span>
<span class="sd">        Absolute Salinity of seawater when it freezes, for</span>
<span class="sd">        given input values of in situ temperature, pressure and</span>
<span class="sd">        air saturation fraction.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See section 3.33 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>

<span class="sd">    McDougall, T.J., and S.J. Wotherspoon, 2013: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sa_freezing_from_t</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">)</span></div>

<span class="n">SA_freezing_from_t</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sa_freezing_from_t</span><span class="o">.</span><span class="n">types</span>
<span class="n">SA_freezing_from_t</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SA_freezing_from_t</span><span class="p">)</span>

<div class="viewcode-block" id="SA_freezing_from_t_poly">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SA_freezing_from_t_poly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SA_freezing_from_t_poly</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Absolute Salinity of seawater at the freezing temperature.</span>
<span class="sd">    That is, the output is the Absolute Salinity of seawater, with the</span>
<span class="sd">    fraction saturation_fraction of dissolved air, that is in equilibrium</span>
<span class="sd">    with ice at in-situ temperature t and pressure p.  If the input values</span>
<span class="sd">    are such that there is no positive value of Absolute Salinity for which</span>
<span class="sd">    seawater is frozen, the output, SA_freezing, is put equal to NaN.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    saturation_fraction : array-like</span>
<span class="sd">        Saturation fraction of dissolved air in seawater. (0..1)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SA_freezing : array-like, g/kg</span>
<span class="sd">        Absolute Salinity of seawater when it freezes, for</span>
<span class="sd">        given input values of in situ temperature, pressure and</span>
<span class="sd">        air saturation fraction.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See section 3.33 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>

<span class="sd">    McDougall T. J. and S. J. Wotherspoon, 2014: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sa_freezing_from_t_poly</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">)</span></div>

<span class="n">SA_freezing_from_t_poly</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sa_freezing_from_t_poly</span><span class="o">.</span><span class="n">types</span>
<span class="n">SA_freezing_from_t_poly</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SA_freezing_from_t_poly</span><span class="p">)</span>

<div class="viewcode-block" id="SA_from_rho">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SA_from_rho">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SA_from_rho</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Absolute Salinity of a seawater sample, for given values</span>
<span class="sd">    of its density, Conservative Temperature and sea pressure (in dbar).</span>
<span class="sd">    This function uses the computationally-efficient 75-term expression for</span>
<span class="sd">    specific volume in terms of SA, CT and p (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rho : array-like</span>
<span class="sd">        Seawater density (not anomaly) in-situ, e.g., 1026 kg/m^3.</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SA : array-like, g/kg</span>
<span class="sd">        Absolute Salinity.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 2.5 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Millero, F.J., R. Feistel, D.G. Wright, and T.J. McDougall, 2008:</span>
<span class="sd">    The composition of Standard Seawater and the definition of the</span>
<span class="sd">    Reference-Composition Salinity Scale. Deep-Sea Res. I, 55, 50-72.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sa_from_rho</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">SA_from_rho</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sa_from_rho</span><span class="o">.</span><span class="n">types</span>
<span class="n">SA_from_rho</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SA_from_rho</span><span class="p">)</span>

<div class="viewcode-block" id="SA_from_SP">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SA_from_SP">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SA_from_SP</span><span class="p">(</span><span class="n">SP</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Absolute Salinity from Practical Salinity.  Since SP is</span>
<span class="sd">    non-negative by definition, this function changes any negative input</span>
<span class="sd">    values of SP to be zero.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SP : array-like</span>
<span class="sd">        Practical Salinity (PSS-78), unitless</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    lon : array-like</span>
<span class="sd">        Longitude, -360 to 360 degrees</span>
<span class="sd">    lat : array-like</span>
<span class="sd">        Latitude, -90 to 90 degrees</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SA : array-like, g/kg</span>
<span class="sd">        Absolute Salinity</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 2.5 and appendices A.4 and A.5 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="sd">    P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="sd">    Ocean Science, 8, 1123-1134.</span>
<span class="sd">    https://os.copernicus.org/articles/8/1123/2012/os-8-1123-2012.pdf</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sa_from_sp</span><span class="p">(</span><span class="n">SP</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span></div>

<span class="n">SA_from_SP</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sa_from_sp</span><span class="o">.</span><span class="n">types</span>
<span class="n">SA_from_SP</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SA_from_SP</span><span class="p">)</span>

<div class="viewcode-block" id="SA_from_SP_Baltic">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SA_from_SP_Baltic">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SA_from_SP_Baltic</span><span class="p">(</span><span class="n">SP</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Absolute Salinity in the Baltic Sea, from Practical Salinity.</span>
<span class="sd">    Since SP is non-negative by definition, this function changes any</span>
<span class="sd">    negative input values of SP to be zero.</span>
<span class="sd">    Note. This programme will only produce Absolute Salinity values for the</span>
<span class="sd">    Baltic Sea.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SP : array-like</span>
<span class="sd">        Practical Salinity (PSS-78), unitless</span>
<span class="sd">    lon : array-like</span>
<span class="sd">        Longitude, -360 to 360 degrees</span>
<span class="sd">    lat : array-like</span>
<span class="sd">        Latitude, -90 to 90 degrees</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SA_baltic : array-like, g kg^-1</span>
<span class="sd">        Absolute Salinity in the Baltic Sea</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    Feistel, R., S. Weinreben, H. Wolf, S. Seitz, P. Spitzer, B. Adel,</span>
<span class="sd">    G. Nausch, B. Schneider and D. G. Wright, 2010: Density and Absolute</span>
<span class="sd">    Salinity of the Baltic Sea 2006-2009.  Ocean Science, 6, 3-24.</span>
<span class="sd">    https://os.copernicus.org/articles/6/3/2010/os-6-3-2010.pdf</span>

<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="sd">    P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="sd">    Ocean Science, 8, 1123-1134.</span>
<span class="sd">    https://os.copernicus.org/articles/8/1123/2012/os-8-1123-2012.pdf</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sa_from_sp_baltic</span><span class="p">(</span><span class="n">SP</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span></div>

<span class="n">SA_from_SP_Baltic</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sa_from_sp_baltic</span><span class="o">.</span><span class="n">types</span>
<span class="n">SA_from_SP_Baltic</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SA_from_SP_Baltic</span><span class="p">)</span>

<div class="viewcode-block" id="SA_from_Sstar">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SA_from_Sstar">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SA_from_Sstar</span><span class="p">(</span><span class="n">Sstar</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Absolute Salinity from Preformed Salinity.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Sstar : array-like</span>
<span class="sd">        Preformed Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    lon : array-like</span>
<span class="sd">        Longitude, -360 to 360 degrees</span>
<span class="sd">    lat : array-like</span>
<span class="sd">        Latitude, -90 to 90 degrees</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SA : array-like, g/kg</span>
<span class="sd">        Absolute Salinity</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="sd">    P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="sd">    Ocean Science, 8, 1123-1134.</span>
<span class="sd">    https://os.copernicus.org/articles/8/1123/2012/os-8-1123-2012.pdf</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sa_from_sstar</span><span class="p">(</span><span class="n">Sstar</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span></div>

<span class="n">SA_from_Sstar</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sa_from_sstar</span><span class="o">.</span><span class="n">types</span>
<span class="n">SA_from_Sstar</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SA_from_Sstar</span><span class="p">)</span>

<div class="viewcode-block" id="SAAR">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SAAR">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SAAR</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Absolute Salinity Anomaly Ratio, SAAR, in the open ocean</span>
<span class="sd">    by spatially interpolating the global reference data set of SAAR to the</span>
<span class="sd">    location of the seawater sample.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    lon : array-like</span>
<span class="sd">        Longitude, -360 to 360 degrees</span>
<span class="sd">    lat : array-like</span>
<span class="sd">        Latitude, -90 to 90 degrees</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SAAR : array-like, unitless</span>
<span class="sd">        Absolute Salinity Anomaly Ratio</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function uses version 3.0 of the SAAR look up table (15th May 2011).</span>

<span class="sd">    The Absolute Salinity Anomaly Ratio in the Baltic Sea is evaluated</span>
<span class="sd">    separately, since it is a function of Practical Salinity, not of space.</span>
<span class="sd">    The present function returns a SAAR of zero for data in the Baltic Sea.</span>
<span class="sd">    The correct way of calculating Absolute Salinity in the Baltic Sea is by</span>
<span class="sd">    calling gsw_SA_from_SP.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="sd">    P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="sd">    Ocean Science, 8, 1123-1134.</span>
<span class="sd">    https://os.copernicus.org/articles/8/1123/2012/os-8-1123-2012.pdf</span>

<span class="sd">    See also gsw_SA_from_SP, gsw_deltaSA_atlas</span>

<span class="sd">    Reference page in Help browser</span>
<span class="sd">    &lt;a href=&quot;matlab:doc gsw_SAAR&quot;&gt;doc gsw_SAAR&lt;/a&gt;</span>
<span class="sd">    Note that this reference page includes the code contained in gsw_SAAR.</span>
<span class="sd">    We have opted to encode this programme as it is a global standard and</span>
<span class="sd">    such we cannot allow anyone to change it.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">saar</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span></div>

<span class="n">SAAR</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">saar</span><span class="o">.</span><span class="n">types</span>
<span class="n">SAAR</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SAAR</span><span class="p">)</span>

<div class="viewcode-block" id="seaice_fraction_to_freeze_seawater">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.seaice_fraction_to_freeze_seawater">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">seaice_fraction_to_freeze_seawater</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">SA_seaice</span><span class="p">,</span> <span class="n">t_seaice</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the mass fraction of sea ice (mass of sea ice divided by mass</span>
<span class="sd">    of sea ice plus seawater), which, when melted into seawater having the</span>
<span class="sd">    properties (SA,CT,p) causes the final seawater to be at the freezing</span>
<span class="sd">    temperature.  The other outputs are the Absolute Salinity and</span>
<span class="sd">    Conservative Temperature of the final seawater.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    SA_seaice : array-like</span>
<span class="sd">        Absolute Salinity of sea ice: the mass fraction of salt</span>
<span class="sd">        in sea ice, expressed in g of salt per kg of sea ice.</span>
<span class="sd">    t_seaice : array-like</span>
<span class="sd">        In-situ temperature of the sea ice at pressure p (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SA_freeze : array-like, g/kg</span>
<span class="sd">        Absolute Salinity of seawater after the mass fraction of</span>
<span class="sd">        sea ice, w_seaice, at temperature t_seaice has melted into</span>
<span class="sd">        the original seawater, and the final mixture is at the</span>
<span class="sd">        freezing temperature of seawater.</span>
<span class="sd">    CT_freeze : array-like, deg C</span>
<span class="sd">        Conservative Temperature of seawater after the mass</span>
<span class="sd">        fraction, w_seaice, of sea ice at temperature t_seaice has</span>
<span class="sd">        melted into the original seawater, and the final mixture</span>
<span class="sd">        is at the freezing temperature of seawater.</span>
<span class="sd">    w_seaice : array-like, unitless</span>
<span class="sd">        mass fraction of sea ice, at SA_seaice and t_seaice,</span>
<span class="sd">        which, when melted into seawater at (SA,CT,p) leads to the</span>
<span class="sd">        final mixed seawater being at the freezing temperature.</span>
<span class="sd">        This output is between 0 and 1.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall T.J. and S.J. Wotherspoon, 2013: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="sd">    See Eqn. (23) of this manuscript.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">seaice_fraction_to_freeze_seawater</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">SA_seaice</span><span class="p">,</span> <span class="n">t_seaice</span><span class="p">)</span></div>

<span class="n">seaice_fraction_to_freeze_seawater</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">seaice_fraction_to_freeze_seawater</span><span class="o">.</span><span class="n">types</span>
<span class="n">seaice_fraction_to_freeze_seawater</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">seaice_fraction_to_freeze_seawater</span><span class="p">)</span>

<div class="viewcode-block" id="sigma0">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.sigma0">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sigma0</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential density anomaly with reference pressure of 0 dbar,</span>
<span class="sd">    this being this particular potential density minus 1000 kg/m^3.  This</span>
<span class="sd">    function has inputs of Absolute Salinity and Conservative Temperature.</span>
<span class="sd">    This function uses the computationally-efficient expression for</span>
<span class="sd">    specific volume in terms of SA, CT and p (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sigma0 : array-like, kg/m^3</span>
<span class="sd">        potential density anomaly with</span>
<span class="sd">        respect to a reference pressure of 0 dbar,</span>
<span class="sd">        that is, this potential density - 1000 kg/m^3.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqn. (A.30.1) of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sigma0</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">)</span></div>

<span class="n">sigma0</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sigma0</span><span class="o">.</span><span class="n">types</span>
<span class="n">sigma0</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">sigma0</span><span class="p">)</span>

<div class="viewcode-block" id="sigma1">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.sigma1">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sigma1</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential density anomaly with reference pressure of 1000</span>
<span class="sd">    dbar, this being this particular potential density minus 1000 kg/m^3.</span>
<span class="sd">    This function has inputs of Absolute Salinity and Conservative</span>
<span class="sd">    Temperature.  This function uses the computationally-efficient</span>
<span class="sd">    expression for specific volume in terms of SA, CT and p (Roquet et al.,</span>
<span class="sd">    2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sigma1 : array-like, kg/m^3</span>
<span class="sd">        potential density anomaly with</span>
<span class="sd">        respect to a reference pressure of 1000 dbar,</span>
<span class="sd">        that is, this potential density - 1000 kg/m^3.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqn. (A.30.1) of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sigma1</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">)</span></div>

<span class="n">sigma1</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sigma1</span><span class="o">.</span><span class="n">types</span>
<span class="n">sigma1</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">sigma1</span><span class="p">)</span>

<div class="viewcode-block" id="sigma2">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.sigma2">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sigma2</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential density anomaly with reference pressure of 2000</span>
<span class="sd">    dbar, this being this particular potential density minus 1000 kg/m^3.</span>
<span class="sd">    Temperature.  This function uses the computationally-efficient</span>
<span class="sd">    expression for specific volume in terms of SA, CT and p (Roquet et al.,</span>
<span class="sd">    2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sigma2 : array-like, kg/m^3</span>
<span class="sd">        potential density anomaly with</span>
<span class="sd">        respect to a reference pressure of 2000 dbar,</span>
<span class="sd">        that is, this potential density - 1000 kg/m^3.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqn. (A.30.1) of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sigma2</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">)</span></div>

<span class="n">sigma2</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sigma2</span><span class="o">.</span><span class="n">types</span>
<span class="n">sigma2</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">sigma2</span><span class="p">)</span>

<div class="viewcode-block" id="sigma3">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.sigma3">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sigma3</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential density anomaly with reference pressure of 3000</span>
<span class="sd">    dbar, this being this particular potential density minus 1000 kg/m^3.</span>
<span class="sd">    Temperature.  This function uses the computationally-efficient</span>
<span class="sd">    expression for specific volume in terms of SA, CT and p (Roquet et al.,</span>
<span class="sd">    2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sigma3 : array-like, kg/m^3</span>
<span class="sd">        potential density anomaly with</span>
<span class="sd">        respect to a reference pressure of 3000 dbar,</span>
<span class="sd">        that is, this potential density - 1000 kg/m^3.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqn. (A.30.1) of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sigma3</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">)</span></div>

<span class="n">sigma3</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sigma3</span><span class="o">.</span><span class="n">types</span>
<span class="n">sigma3</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">sigma3</span><span class="p">)</span>

<div class="viewcode-block" id="sigma4">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.sigma4">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sigma4</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates potential density anomaly with reference pressure of 4000</span>
<span class="sd">    dbar, this being this particular potential density minus 1000 kg/m^3.</span>
<span class="sd">    Temperature.  This function uses the computationally-efficient</span>
<span class="sd">    expression for specific volume in terms of SA, CT and p (Roquet et al.,</span>
<span class="sd">    2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sigma4 : array-like, kg/m^3</span>
<span class="sd">        potential density anomaly with</span>
<span class="sd">        respect to a reference pressure of 4000 dbar,</span>
<span class="sd">        that is, this potential density - 1000 kg/m^3.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqn. (A.30.1) of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sigma4</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">)</span></div>

<span class="n">sigma4</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sigma4</span><span class="o">.</span><span class="n">types</span>
<span class="n">sigma4</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">sigma4</span><span class="p">)</span>

<div class="viewcode-block" id="sound_speed">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.sound_speed">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sound_speed</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the speed of sound in seawater.  This function has inputs of</span>
<span class="sd">    Absolute Salinity and Conservative Temperature.  This function uses the</span>
<span class="sd">    computationally-efficient expression for specific volume in terms of SA,</span>
<span class="sd">    CT and p (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sound_speed : array-like, m/s</span>
<span class="sd">        speed of sound in seawater</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqn. (2.17.1) of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sound_speed</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">sound_speed</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sound_speed</span><span class="o">.</span><span class="n">types</span>
<span class="n">sound_speed</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">sound_speed</span><span class="p">)</span>

<div class="viewcode-block" id="sound_speed_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.sound_speed_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sound_speed_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the compression speed of sound in ice.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sound_speed_ice : array-like, m/s</span>
<span class="sd">        compression speed of sound in ice</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sound_speed_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">sound_speed_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sound_speed_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">sound_speed_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">sound_speed_ice</span><span class="p">)</span>

<div class="viewcode-block" id="sound_speed_t_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.sound_speed_t_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sound_speed_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the speed of sound in seawater.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sound_speed_t_exact : array-like, m/s</span>
<span class="sd">        speed of sound in seawater</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqn. (2.17.1) of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sound_speed_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">sound_speed_t_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sound_speed_t_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">sound_speed_t_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">sound_speed_t_exact</span><span class="p">)</span>

<div class="viewcode-block" id="SP_from_C">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SP_from_C">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SP_from_C</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Practical Salinity, SP, from conductivity, C, primarily using</span>
<span class="sd">    the PSS-78 algorithm.  Note that the PSS-78 algorithm for Practical</span>
<span class="sd">    Salinity is only valid in the range 2 &lt; SP &lt; 42.  If the PSS-78</span>
<span class="sd">    algorithm produces a Practical Salinity that is less than 2 then the</span>
<span class="sd">    Practical Salinity is recalculated with a modified form of the Hill et</span>
<span class="sd">    al. (1986) formula.  The modification of the Hill et al. (1986)</span>
<span class="sd">    expression is to ensure that it is exactly consistent with PSS-78</span>
<span class="sd">    at SP = 2.  Note that the input values of conductivity need to be in</span>
<span class="sd">    units of mS/cm (not S/m).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    C : array-like</span>
<span class="sd">        Conductivity, mS/cm</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SP : array-like, unitless</span>
<span class="sd">        Practical Salinity on the PSS-78 scale</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    Culkin and Smith, 1980:  Determination of the Concentration of Potassium</span>
<span class="sd">    Chloride Solution Having the Same Electrical Conductivity, at 15C and</span>
<span class="sd">    Infinite Frequency, as Standard Seawater of Salinity 35.0000</span>
<span class="sd">    (Chlorinity 19.37394), IEEE J. Oceanic Eng, 5, 22-23.</span>

<span class="sd">    Hill, K.D., T.M. Dauphinee &amp; D.J. Woods, 1986: The extension of the</span>
<span class="sd">    Practical Salinity Scale 1978 to low salinities. IEEE J. Oceanic Eng.,</span>
<span class="sd">    11, 109 - 112.</span>

<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix E of this TEOS-10 Manual.</span>

<span class="sd">    Unesco, 1983: Algorithms for computation of fundamental properties of</span>
<span class="sd">    seawater. Unesco Technical Papers in Marine Science, 44, 53 pp.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sp_from_c</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">SP_from_C</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sp_from_c</span><span class="o">.</span><span class="n">types</span>
<span class="n">SP_from_C</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SP_from_C</span><span class="p">)</span>

<div class="viewcode-block" id="SP_from_SA">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SP_from_SA">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SP_from_SA</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Practical Salinity from Absolute Salinity.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    lon : array-like</span>
<span class="sd">        Longitude, -360 to 360 degrees</span>
<span class="sd">    lat : array-like</span>
<span class="sd">        Latitude, -90 to 90 degrees</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SP : array-like, unitless</span>
<span class="sd">        Practical Salinity  (PSS-78)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="sd">    P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="sd">    Ocean Science, 8, 1123-1134.</span>
<span class="sd">    https://os.copernicus.org/articles/8/1123/2012/os-8-1123-2012.pdf</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sp_from_sa</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span></div>

<span class="n">SP_from_SA</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sp_from_sa</span><span class="o">.</span><span class="n">types</span>
<span class="n">SP_from_SA</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SP_from_SA</span><span class="p">)</span>

<div class="viewcode-block" id="SP_from_SA_Baltic">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SP_from_SA_Baltic">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SP_from_SA_Baltic</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Practical Salinity for the Baltic Sea, from a value computed</span>
<span class="sd">    analytically from Absolute Salinity.</span>
<span class="sd">    Note. This programme will only produce Practical Salinty values for the</span>
<span class="sd">    Baltic Sea.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    lon : array-like</span>
<span class="sd">        Longitude, -360 to 360 degrees</span>
<span class="sd">    lat : array-like</span>
<span class="sd">        Latitude, -90 to 90 degrees</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SP_baltic : array-like, unitless</span>
<span class="sd">        Practical Salinity</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    Feistel, R., S. Weinreben, H. Wolf, S. Seitz, P. Spitzer, B. Adel,</span>
<span class="sd">    G. Nausch, B. Schneider and D. G. Wright, 2010c: Density and Absolute</span>
<span class="sd">    Salinity of the Baltic Sea 2006-2009.  Ocean Science, 6, 3-24.</span>
<span class="sd">    https://os.copernicus.org/articles/6/3/2010/os-6-3-2010.pdf</span>

<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="sd">    P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="sd">    Ocean Science, 8, 1123-1134.</span>
<span class="sd">    https://os.copernicus.org/articles/8/1123/2012/os-8-1123-2012.pdf</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sp_from_sa_baltic</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span></div>

<span class="n">SP_from_SA_Baltic</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sp_from_sa_baltic</span><span class="o">.</span><span class="n">types</span>
<span class="n">SP_from_SA_Baltic</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SP_from_SA_Baltic</span><span class="p">)</span>

<div class="viewcode-block" id="SP_from_SK">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SP_from_SK">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SP_from_SK</span><span class="p">(</span><span class="n">SK</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Practical Salinity from Knudsen Salinity.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SK : array-like</span>
<span class="sd">        Knudsen Salinity, ppt</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SP : array-like, unitless</span>
<span class="sd">        Practical Salinity  (PSS-78)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Appendix A.3 of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sp_from_sk</span><span class="p">(</span><span class="n">SK</span><span class="p">)</span></div>

<span class="n">SP_from_SK</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sp_from_sk</span><span class="o">.</span><span class="n">types</span>
<span class="n">SP_from_SK</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SP_from_SK</span><span class="p">)</span>

<div class="viewcode-block" id="SP_from_SR">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SP_from_SR">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SP_from_SR</span><span class="p">(</span><span class="n">SR</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Practical Salinity from Reference Salinity.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SR : array-like</span>
<span class="sd">        Reference Salinity, g/kg</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SP : array-like, unitless</span>
<span class="sd">        Practical Salinity  (PSS-78)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sp_from_sr</span><span class="p">(</span><span class="n">SR</span><span class="p">)</span></div>

<span class="n">SP_from_SR</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sp_from_sr</span><span class="o">.</span><span class="n">types</span>
<span class="n">SP_from_SR</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SP_from_SR</span><span class="p">)</span>

<div class="viewcode-block" id="SP_from_Sstar">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SP_from_Sstar">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SP_from_Sstar</span><span class="p">(</span><span class="n">Sstar</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Practical Salinity from Preformed Salinity.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Sstar : array-like</span>
<span class="sd">        Preformed Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    lon : array-like</span>
<span class="sd">        Longitude, -360 to 360 degrees</span>
<span class="sd">    lat : array-like</span>
<span class="sd">        Latitude, -90 to 90 degrees</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SP : array-like, unitless</span>
<span class="sd">        Practical Salinity  (PSS-78)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="sd">    P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="sd">    Ocean Science, 8, 1123-1134.</span>
<span class="sd">    https://os.copernicus.org/articles/8/1123/2012/os-8-1123-2012.pdf</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sp_from_sstar</span><span class="p">(</span><span class="n">Sstar</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span></div>

<span class="n">SP_from_Sstar</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sp_from_sstar</span><span class="o">.</span><span class="n">types</span>
<span class="n">SP_from_Sstar</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SP_from_Sstar</span><span class="p">)</span>

<div class="viewcode-block" id="SP_salinometer">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SP_salinometer">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SP_salinometer</span><span class="p">(</span><span class="n">Rt</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Practical Salinity SP from a salinometer, primarily using the</span>
<span class="sd">    PSS-78 algorithm.  Note that the PSS-78 algorithm for Practical Salinity</span>
<span class="sd">    is only valid in the range 2 &lt; SP &lt; 42.  If the PSS-78 algorithm</span>
<span class="sd">    produces a Practical Salinity that is less than 2 then the Practical</span>
<span class="sd">    Salinity is recalculated with a modified form of the Hill et al. (1986)</span>
<span class="sd">    formula.  The modification of the Hill et al. (1986) expression is to</span>
<span class="sd">    ensure that it is exactly consistent with PSS-78 at SP = 2.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Rt : array-like</span>
<span class="sd">        C(SP,t_68,0)/C(SP=35,t_68,0), unitless</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SP : array-like, unitless</span>
<span class="sd">        Practical Salinity on the PSS-78 scale</span>
<span class="sd">        t may have dimensions 1x1 or Mx1 or 1xN or MxN, where Rt is MxN.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    A laboratory salinometer has the ratio of conductivities, Rt, as an</span>
<span class="sd">    output, and the present function uses this conductivity ratio and the</span>
<span class="sd">    temperature t of the salinometer bath as the two input variables.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    Fofonoff, P. and R.C. Millard Jr. 1983: Algorithms for computation of</span>
<span class="sd">    fundamental properties of seawater. Unesco Tech. Pap. in Mar. Sci., 44,</span>
<span class="sd">    53 pp.</span>

<span class="sd">    Hill, K.D., T.M. Dauphinee &amp; D.J. Woods, 1986: The extension of the</span>
<span class="sd">    Practical Salinity Scale 1978 to low salinities. IEEE J. Oceanic Eng.,</span>
<span class="sd">    11, 109 - 112.</span>

<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix E of this TEOS-10 Manual, and in particular,</span>
<span class="sd">    Eqns. (E.2.1) and (E.2.6).</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sp_salinometer</span><span class="p">(</span><span class="n">Rt</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span></div>

<span class="n">SP_salinometer</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sp_salinometer</span><span class="o">.</span><span class="n">types</span>
<span class="n">SP_salinometer</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SP_salinometer</span><span class="p">)</span>

<div class="viewcode-block" id="specvol">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.specvol">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">specvol</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates specific volume from Absolute Salinity, Conservative</span>
<span class="sd">    Temperature and pressure, using the computationally-efficient 75-term</span>
<span class="sd">    polynomial expression for specific volume (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    specvol : array-like, m^3/kg</span>
<span class="sd">        specific volume</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmos. Ocean. Tech., 20,</span>
<span class="sd">    730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">specvol</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol</span><span class="o">.</span><span class="n">types</span>
<span class="n">specvol</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">specvol</span><span class="p">)</span>

<div class="viewcode-block" id="specvol_alpha_beta">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.specvol_alpha_beta">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">specvol_alpha_beta</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates specific volume, the appropriate thermal expansion coefficient</span>
<span class="sd">    and the appropriate saline contraction coefficient of seawater from</span>
<span class="sd">    Absolute Salinity and Conservative Temperature.  This function uses the</span>
<span class="sd">    computationally-efficient expression for specific volume in terms of</span>
<span class="sd">    SA, CT and p (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    specvol : array-like, m/kg</span>
<span class="sd">        specific volume</span>
<span class="sd">    alpha : array-like, 1/K</span>
<span class="sd">        thermal expansion coefficient</span>
<span class="sd">        with respect to Conservative Temperature</span>
<span class="sd">    beta : array-like, kg/g</span>
<span class="sd">        saline (i.e. haline) contraction</span>
<span class="sd">        coefficient at constant Conservative Temperature</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix A.20 and appendix K of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_alpha_beta</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">specvol_alpha_beta</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_alpha_beta</span><span class="o">.</span><span class="n">types</span>
<span class="n">specvol_alpha_beta</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">specvol_alpha_beta</span><span class="p">)</span>

<div class="viewcode-block" id="specvol_anom_standard">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.specvol_anom_standard">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">specvol_anom_standard</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates specific volume anomaly from Absolute Salinity, Conservative</span>
<span class="sd">    Temperature and pressure. It uses the computationally-efficient</span>
<span class="sd">    expression for specific volume as a function of SA, CT and p (Roquet</span>
<span class="sd">    et al., 2015).  The reference value to which the anomaly is calculated</span>
<span class="sd">    has an Absolute Salinity of SSO and Conservative Temperature equal to</span>
<span class="sd">    0 degrees C.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    specvol_anom : array-like, m^3/kg</span>
<span class="sd">        specific volume anomaly</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqn. (3.7.3) of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_anom_standard</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">specvol_anom_standard</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_anom_standard</span><span class="o">.</span><span class="n">types</span>
<span class="n">specvol_anom_standard</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">specvol_anom_standard</span><span class="p">)</span>

<div class="viewcode-block" id="specvol_first_derivatives">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.specvol_first_derivatives">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">specvol_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following three first-order derivatives of specific</span>
<span class="sd">    volume (v),</span>
<span class="sd">    (1) v_SA, first-order derivative with respect to Absolute Salinity</span>
<span class="sd">    at constant CT &amp; p.</span>
<span class="sd">    (2) v_CT, first-order derivative with respect to CT at</span>
<span class="sd">    constant SA &amp; p.</span>
<span class="sd">    (3) v_P, first-order derivative with respect to P at constant SA</span>
<span class="sd">    and CT.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    v_SA : array-like, (m^3/kg)(g/kg)^-1</span>
<span class="sd">        The first derivative of specific volume with respect to</span>
<span class="sd">        Absolute Salinity at constant CT &amp; p.</span>
<span class="sd">    v_CT : array-like, m^3/(K kg)</span>
<span class="sd">        The first derivative of specific volume with respect to</span>
<span class="sd">        CT at constant SA and p.</span>
<span class="sd">    v_P : array-like, m^3/(Pa kg)</span>
<span class="sd">        The first derivative of specific volume with respect to</span>
<span class="sd">        P at constant SA and CT.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this function uses the using the computationally-efficient</span>
<span class="sd">    75-term expression for specific volume (Roquet et al., 2015).  There is</span>
<span class="sd">    an alternative to calling this function, namely</span>
<span class="sd">    gsw_specvol_first_derivatives_CT_exact(SA,CT,p) which uses the full</span>
<span class="sd">    Gibbs function (IOC et al., 2010).</span>

<span class="sd">    This 75-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot; described</span>
<span class="sd">    in McDougall et al. (2010).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">specvol_first_derivatives</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_first_derivatives</span><span class="o">.</span><span class="n">types</span>
<span class="n">specvol_first_derivatives</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">specvol_first_derivatives</span><span class="p">)</span>

<div class="viewcode-block" id="specvol_first_derivatives_wrt_enthalpy">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.specvol_first_derivatives_wrt_enthalpy">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">specvol_first_derivatives_wrt_enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following two first-order derivatives of specific</span>
<span class="sd">    volume (v),</span>
<span class="sd">    (1) v_SA_wrt_h, first-order derivative with respect to Absolute Salinity</span>
<span class="sd">    at constant h &amp; p.</span>
<span class="sd">    (2) v_h, first-order derivative with respect to h at</span>
<span class="sd">    constant SA &amp; p.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    v_SA_wrt_h : array-like, (m^3/kg)(g/kg)^-1</span>
<span class="sd">        The first derivative of specific volume with respect to</span>
<span class="sd">        Absolute Salinity at constant CT &amp; p.</span>
<span class="sd">    v_h : array-like, (m^3/kg)(J/kg)^-1</span>
<span class="sd">        The first derivative of specific volume with respect to</span>
<span class="sd">        SA and CT at constant p.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this function uses the using the computationally-efficient</span>
<span class="sd">    75 term expression for specific volume (Roquet et al., 2015).  There is</span>
<span class="sd">    an alternative to calling this function, namely</span>
<span class="sd">    gsw_specvol_first_derivatives_wrt_enthalpy_CT_exact(SA,CT,p) which uses</span>
<span class="sd">    the full Gibbs function (IOC et al., 2010).</span>

<span class="sd">    This 75-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot; described</span>
<span class="sd">    in McDougall et al. (2010).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_first_derivatives_wrt_enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">specvol_first_derivatives_wrt_enthalpy</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_first_derivatives_wrt_enthalpy</span><span class="o">.</span><span class="n">types</span>
<span class="n">specvol_first_derivatives_wrt_enthalpy</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">specvol_first_derivatives_wrt_enthalpy</span><span class="p">)</span>

<div class="viewcode-block" id="specvol_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.specvol_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">specvol_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the specific volume of ice.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    specvol_ice : array-like, m^3/kg</span>
<span class="sd">        specific volume</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_ice</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">specvol_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">specvol_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">specvol_ice</span><span class="p">)</span>

<div class="viewcode-block" id="specvol_second_derivatives">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.specvol_second_derivatives">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">specvol_second_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following five second-order derivatives of specific</span>
<span class="sd">    volume (v),</span>
<span class="sd">    (1) v_SA_SA, second-order derivative with respect to Absolute Salinity</span>
<span class="sd">    at constant CT &amp; p.</span>
<span class="sd">    (2) v_SA_CT, second-order derivative with respect to SA &amp; CT at</span>
<span class="sd">    constant p.</span>
<span class="sd">    (3) v_CT_CT, second-order derivative with respect to CT at constant SA</span>
<span class="sd">    and p.</span>
<span class="sd">    (4) v_SA_P, second-order derivative with respect to SA &amp; P at</span>
<span class="sd">    constant CT.</span>
<span class="sd">    (5) v_CT_P, second-order derivative with respect to CT &amp; P at</span>
<span class="sd">    constant SA.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    v_SA_SA : array-like, (m^3/kg)(g/kg)^-2</span>
<span class="sd">        The second derivative of specific volume with respect to</span>
<span class="sd">        Absolute Salinity at constant CT &amp; p.</span>
<span class="sd">    v_SA_CT : array-like, (m^3/kg)(g/kg)^-1 K^-1</span>
<span class="sd">        The second derivative of specific volume with respect to</span>
<span class="sd">        SA and CT at constant p.</span>
<span class="sd">    v_CT_CT : array-like, (m^3/kg) K^-2)</span>
<span class="sd">        The second derivative of specific volume with respect to</span>
<span class="sd">        CT at constant SA and p.</span>
<span class="sd">    v_SA_P : array-like, (m^3/kg)(g/kg)^-1 Pa^-1</span>
<span class="sd">        The second derivative of specific volume with respect to</span>
<span class="sd">        SA and P at constant CT.</span>
<span class="sd">    v_CT_P : array-like, (m^3/kg) K^-1 Pa^-1</span>
<span class="sd">        The second derivative of specific volume with respect to</span>
<span class="sd">        CT and P at constant SA.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this function uses the using the computationally-efficient</span>
<span class="sd">    75-term expression for specific volume (Roquet et al., 2015).  There is</span>
<span class="sd">    an alternative to calling this function, namely</span>
<span class="sd">    gsw_specvol_second_derivatives_CT_exact(SA,CT,p) which uses the full</span>
<span class="sd">    Gibbs function (IOC et al., 2010).</span>

<span class="sd">    Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_second_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">specvol_second_derivatives</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_second_derivatives</span><span class="o">.</span><span class="n">types</span>
<span class="n">specvol_second_derivatives</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">specvol_second_derivatives</span><span class="p">)</span>

<div class="viewcode-block" id="specvol_second_derivatives_wrt_enthalpy">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.specvol_second_derivatives_wrt_enthalpy">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">specvol_second_derivatives_wrt_enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the following three first-order derivatives of specific</span>
<span class="sd">    volume (v) with respect to enthalpy,</span>
<span class="sd">    (1) v_SA_SA_wrt_h, second-order derivative with respect to Absolute Salinity</span>
<span class="sd">    at constant h &amp; p.</span>
<span class="sd">    (2) v_SA_h, second-order derivative with respect to SA &amp; h at</span>
<span class="sd">    constant p.</span>
<span class="sd">    (3) v_h_h, second-order derivative with respect to h at</span>
<span class="sd">    constant SA &amp; p.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    v_SA_SA_wrt_h : array-like, (m^3/kg)(g/kg)^-2</span>
<span class="sd">        The second-order derivative of specific volume with</span>
<span class="sd">        respect to Absolute Salinity at constant h &amp; p.</span>
<span class="sd">    v_SA_h : array-like, (m^3/kg)(g/kg)^-1 (J/kg)^-1</span>
<span class="sd">        The second-order derivative of specific volume with respect to</span>
<span class="sd">        SA and h at constant p.</span>
<span class="sd">    v_h_h : array-like, (m^3/kg)(J/kg)^-2</span>
<span class="sd">        The second-order derivative with respect to h at</span>
<span class="sd">        constant SA &amp; p.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this function uses the using the computationally-efficient</span>
<span class="sd">    75 term expression for specific volume (Roquet et al., 2015).  There is</span>
<span class="sd">    an alternative to calling this function, namely</span>
<span class="sd">    gsw_specvol_second_derivatives_wrt_enthalpy_CT_exact(SA,CT,p) which uses</span>
<span class="sd">    the full Gibbs function (IOC et al., 2010).</span>

<span class="sd">    This 75-term equation has been fitted in a restricted range of parameter</span>
<span class="sd">    space, and is most accurate inside the &quot;oceanographic funnel&quot; described</span>
<span class="sd">    in McDougall et al. (2010).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_second_derivatives_wrt_enthalpy</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">specvol_second_derivatives_wrt_enthalpy</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_second_derivatives_wrt_enthalpy</span><span class="o">.</span><span class="n">types</span>
<span class="n">specvol_second_derivatives_wrt_enthalpy</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">specvol_second_derivatives_wrt_enthalpy</span><span class="p">)</span>

<div class="viewcode-block" id="specvol_SSO_0">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.specvol_SSO_0">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">specvol_SSO_0</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    specific volume at (SSO,CT=0,p)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    double, array</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    sw_specvol_SSO_0                          specific volume at (SSO,CT=0,p)</span>
<span class="sd">                                                           (75-term equation)</span>
<span class="sd">     This function calculates specific volume at the Standard Ocean Salinity,</span>
<span class="sd">     SSO, and at a Conservative Temperature of zero degrees C, as a function</span>
<span class="sd">     of pressure, p, in dbar, using a streamlined version of the 75-term CT</span>
<span class="sd">     version of specific volume, that is, a streamlined version of the code</span>
<span class="sd">     &quot;gsw_specvol(SA,CT,p)&quot;.</span>

<span class="sd">    VERSION NUMBER: 3.06.12 (25th May, 2020)</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_sso_0</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></div>

<span class="n">specvol_SSO_0</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_sso_0</span><span class="o">.</span><span class="n">types</span>
<span class="n">specvol_SSO_0</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">specvol_SSO_0</span><span class="p">)</span>

<div class="viewcode-block" id="specvol_t_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.specvol_t_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">specvol_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the specific volume of seawater.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    specvol_t_exact : array-like, m^3/kg</span>
<span class="sd">        specific volume</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 2.7 of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">specvol_t_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">specvol_t_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">specvol_t_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">specvol_t_exact</span><span class="p">)</span>

<div class="viewcode-block" id="spiciness0">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.spiciness0">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">spiciness0</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates spiciness from Absolute Salinity and Conservative</span>
<span class="sd">    Temperature at a pressure of 0 dbar, as described by McDougall and</span>
<span class="sd">    Krzysik (2015).  This routine is based on the computationally-efficient</span>
<span class="sd">    expression for specific volume in terms of SA, CT and p (Roquet et al.,</span>
<span class="sd">    2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    spiciness0 : array-like, kg/m^3</span>
<span class="sd">        spiciness referenced to a pressure of 0 dbar,</span>
<span class="sd">        i.e. the surface</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    McDougall, T.J., and O.A. Krzysik, 2015: Spiciness. Journal of Marine</span>
<span class="sd">    Research, 73, 141-152.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">spiciness0</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">)</span></div>

<span class="n">spiciness0</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">spiciness0</span><span class="o">.</span><span class="n">types</span>
<span class="n">spiciness0</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">spiciness0</span><span class="p">)</span>

<div class="viewcode-block" id="spiciness1">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.spiciness1">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">spiciness1</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates spiciness from Absolute Salinity and Conservative</span>
<span class="sd">    Temperature at a pressure of 1000 dbar, as described by McDougall and</span>
<span class="sd">    Krzysik (2015).  This routine is based on the computationally-efficient</span>
<span class="sd">    expression for specific volume in terms of SA, CT and p (Roquet et al.,</span>
<span class="sd">    2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    spiciness1 : array-like, kg/m^3</span>
<span class="sd">        spiciness referenced to a pressure of 1000 dbar</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    McDougall, T.J., and O.A. Krzysik, 2015: Spiciness. Journal of Marine</span>
<span class="sd">    Research, 73, 141-152.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">spiciness1</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">)</span></div>

<span class="n">spiciness1</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">spiciness1</span><span class="o">.</span><span class="n">types</span>
<span class="n">spiciness1</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">spiciness1</span><span class="p">)</span>

<div class="viewcode-block" id="spiciness2">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.spiciness2">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">spiciness2</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates spiciness from Absolute Salinity and Conservative</span>
<span class="sd">    Temperature at a pressure of 2000 dbar, as described by McDougall and</span>
<span class="sd">    Krzysik (2015).  This routine is based on the computationally-efficient</span>
<span class="sd">    expression for specific volume in terms of SA, CT and p (Roquet et al.,</span>
<span class="sd">    2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    spiciness2 : array-like, kg/m^3</span>
<span class="sd">        spiciness referenced to a pressure of 2000 dbar</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    McDougall, T.J., and O.A. Krzysik, 2015: Spiciness. Journal of Marine</span>
<span class="sd">    Research, 73, 141-152.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">spiciness2</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">)</span></div>

<span class="n">spiciness2</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">spiciness2</span><span class="o">.</span><span class="n">types</span>
<span class="n">spiciness2</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">spiciness2</span><span class="p">)</span>

<div class="viewcode-block" id="SR_from_SP">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.SR_from_SP">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">SR_from_SP</span><span class="p">(</span><span class="n">SP</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Reference Salinity from Practical Salinity.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SP : array-like</span>
<span class="sd">        Practical Salinity (PSS-78), unitless</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SR : array-like, g/kg</span>
<span class="sd">        Reference Salinity</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sr_from_sp</span><span class="p">(</span><span class="n">SP</span><span class="p">)</span></div>

<span class="n">SR_from_SP</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sr_from_sp</span><span class="o">.</span><span class="n">types</span>
<span class="n">SR_from_SP</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">SR_from_SP</span><span class="p">)</span>

<div class="viewcode-block" id="Sstar_from_SA">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.Sstar_from_SA">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">Sstar_from_SA</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts Preformed Salinity from Absolute Salinity.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    lon : array-like</span>
<span class="sd">        Longitude, -360 to 360 degrees</span>
<span class="sd">    lat : array-like</span>
<span class="sd">        Latitude, -90 to 90 degrees</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Sstar : array-like, g/kg</span>
<span class="sd">        Preformed Salinity</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="sd">    P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="sd">    Ocean Science, 8, 1123-1134.</span>
<span class="sd">    https://os.copernicus.org/articles/8/1123/2012/os-8-1123-2012.pdf</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sstar_from_sa</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span></div>

<span class="n">Sstar_from_SA</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sstar_from_sa</span><span class="o">.</span><span class="n">types</span>
<span class="n">Sstar_from_SA</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">Sstar_from_SA</span><span class="p">)</span>

<div class="viewcode-block" id="Sstar_from_SP">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.Sstar_from_SP">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">Sstar_from_SP</span><span class="p">(</span><span class="n">SP</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Preformed Salinity from Absolute Salinity.</span>
<span class="sd">    Since SP is non-negative by definition, this function changes any</span>
<span class="sd">    negative input values of SP to be zero.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SP : array-like</span>
<span class="sd">        Practical Salinity (PSS-78), unitless</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    lon : array-like</span>
<span class="sd">        Longitude, -360 to 360 degrees</span>
<span class="sd">    lat : array-like</span>
<span class="sd">        Latitude, -90 to 90 degrees</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Sstar : array-like, g/kg</span>
<span class="sd">        Preformed Salinity</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See section 2.5 and appendices A.4 and A.5 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="sd">    P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="sd">    Ocean Science, 8, 1123-1134.</span>
<span class="sd">    https://os.copernicus.org/articles/8/1123/2012/os-8-1123-2012.pdf</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sstar_from_sp</span><span class="p">(</span><span class="n">SP</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span></div>

<span class="n">Sstar_from_SP</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">sstar_from_sp</span><span class="o">.</span><span class="n">types</span>
<span class="n">Sstar_from_SP</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">Sstar_from_SP</span><span class="p">)</span>

<div class="viewcode-block" id="t_deriv_chem_potential_water_t_exact">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.t_deriv_chem_potential_water_t_exact">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">t_deriv_chem_potential_water_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the temperature derivative of the chemical potential of water</span>
<span class="sd">    in seawater so that it is valid at exactly SA = 0.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    t : array-like</span>
<span class="sd">        In-situ temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    chem_potential_water_dt : array-like, J g^-1 K^-1</span>
<span class="sd">        temperature derivative of the chemical</span>
<span class="sd">        potential of water in seawater</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">t_deriv_chem_potential_water_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">t_deriv_chem_potential_water_t_exact</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">t_deriv_chem_potential_water_t_exact</span><span class="o">.</span><span class="n">types</span>
<span class="n">t_deriv_chem_potential_water_t_exact</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">t_deriv_chem_potential_water_t_exact</span><span class="p">)</span>

<div class="viewcode-block" id="t_freezing">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.t_freezing">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">t_freezing</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the in-situ temperature at which seawater freezes. The</span>
<span class="sd">    in-situ temperature freezing point is calculated from the exact</span>
<span class="sd">    in-situ freezing temperature which is found by a modified Newton-Raphson</span>
<span class="sd">    iteration (McDougall and Wotherspoon, 2013) of the equality of the</span>
<span class="sd">    chemical potentials of water in seawater and in ice.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    saturation_fraction : array-like</span>
<span class="sd">        Saturation fraction of dissolved air in seawater. (0..1)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    t_freezing : array-like, deg C</span>
<span class="sd">        in-situ temperature at which seawater freezes.</span>
<span class="sd">        (ITS-90)</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    An alternative GSW function, gsw_t_freezing_poly, it is based on a</span>
<span class="sd">    computationally-efficient polynomial, and is accurate to within -5e-4 K</span>
<span class="sd">    and 6e-4 K, when compared with this function.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall T.J., and S.J. Wotherspoon, 2013: A simple modification of</span>
<span class="sd">    Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="sd">    Mathematics Letters, 29, 20-25.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">t_freezing</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">)</span></div>

<span class="n">t_freezing</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">t_freezing</span><span class="o">.</span><span class="n">types</span>
<span class="n">t_freezing</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">t_freezing</span><span class="p">)</span>

<div class="viewcode-block" id="t_freezing_first_derivatives">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.t_freezing_first_derivatives">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">t_freezing_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the first derivatives of the in-situ temperature at which</span>
<span class="sd">    seawater freezes with respect to Absolute Salinity SA and pressure P (in</span>
<span class="sd">    Pa).  These expressions come from differentiating the expression that</span>
<span class="sd">    defines the freezing temperature, namely the equality between the</span>
<span class="sd">    chemical potentials of water in seawater and in ice.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    saturation_fraction : array-like</span>
<span class="sd">        Saturation fraction of dissolved air in seawater. (0..1)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tfreezing_SA : array-like, K kg/g</span>
<span class="sd">        the derivative of the in-situ freezing temperature</span>
<span class="sd">        (ITS-90) with respect to Absolute Salinity at fixed</span>
<span class="sd">        pressure                     [ K/(g/kg) ] i.e.</span>
<span class="sd">    tfreezing_P : array-like, K/Pa</span>
<span class="sd">        the derivative of the in-situ freezing temperature</span>
<span class="sd">        (ITS-90) with respect to pressure (in Pa) at fixed</span>
<span class="sd">        Absolute Salinity</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">t_freezing_first_derivatives</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">)</span></div>

<span class="n">t_freezing_first_derivatives</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">t_freezing_first_derivatives</span><span class="o">.</span><span class="n">types</span>
<span class="n">t_freezing_first_derivatives</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">t_freezing_first_derivatives</span><span class="p">)</span>

<div class="viewcode-block" id="t_freezing_first_derivatives_poly">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.t_freezing_first_derivatives_poly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">t_freezing_first_derivatives_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the first derivatives of the in-situ temperature at which</span>
<span class="sd">    seawater freezes with respect to Absolute Salinity SA and pressure P (in</span>
<span class="sd">    Pa).  These expressions come from differentiating the expression that</span>
<span class="sd">    defines the freezing temperature, namely the equality between the</span>
<span class="sd">    chemical potentials of water in seawater and in ice.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    saturation_fraction : array-like</span>
<span class="sd">        Saturation fraction of dissolved air in seawater. (0..1)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tfreezing_SA : array-like, K kg/g</span>
<span class="sd">        the derivative of the in-situ freezing temperature</span>
<span class="sd">        (ITS-90) with respect to Absolute Salinity at fixed</span>
<span class="sd">        pressure                     [ K/(g/kg) ] i.e.</span>
<span class="sd">    tfreezing_P : array-like, K/Pa</span>
<span class="sd">        the derivative of the in-situ freezing temperature</span>
<span class="sd">        (ITS-90) with respect to pressure (in Pa) at fixed</span>
<span class="sd">        Absolute Salinity</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">t_freezing_first_derivatives_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">)</span></div>

<span class="n">t_freezing_first_derivatives_poly</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">t_freezing_first_derivatives_poly</span><span class="o">.</span><span class="n">types</span>
<span class="n">t_freezing_first_derivatives_poly</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">t_freezing_first_derivatives_poly</span><span class="p">)</span>

<div class="viewcode-block" id="t_freezing_poly">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.t_freezing_poly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">t_freezing_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the in-situ temperature at which seawater freezes from a</span>
<span class="sd">    comptationally efficient polynomial.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    saturation_fraction : array-like</span>
<span class="sd">        Saturation fraction of dissolved air in seawater. (0..1)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    t_freezing : array-like, deg C</span>
<span class="sd">        in-situ temperature at which seawater freezes.</span>
<span class="sd">        (ITS-90)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/.</span>
<span class="sd">    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>

<span class="sd">    McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="sd">    Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="sd">    Journal of Physical Oceanography, 44, 1751-1775.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">t_freezing_poly</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">saturation_fraction</span><span class="p">)</span></div>

<span class="n">t_freezing_poly</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">t_freezing_poly</span><span class="o">.</span><span class="n">types</span>
<span class="n">t_freezing_poly</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">t_freezing_poly</span><span class="p">)</span>

<div class="viewcode-block" id="t_from_CT">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.t_from_CT">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">t_from_CT</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates in-situ temperature from the Conservative Temperature of</span>
<span class="sd">    seawater.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    t : array-like, deg C</span>
<span class="sd">        in-situ temperature (ITS-90)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See sections 3.1 and 3.3 of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">t_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">t_from_CT</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">t_from_ct</span><span class="o">.</span><span class="n">types</span>
<span class="n">t_from_CT</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">t_from_CT</span><span class="p">)</span>

<div class="viewcode-block" id="t_from_pt0_ice">
<a class="viewcode-back" href="../../ice.html#gsw.conversions.t_from_pt0_ice">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">t_from_pt0_ice</span><span class="p">(</span><span class="n">pt0_ice</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates in-situ temperature from the potential temperature of ice Ih</span>
<span class="sd">    with reference pressure, p_ref, of 0 dbar (the surface), and the</span>
<span class="sd">    in-situ pressure.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pt0_ice : array-like</span>
<span class="sd">        Potential temperature of ice (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    t : array-like, deg C</span>
<span class="sd">        in-situ temperature (ITS-90)</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See appendix I of this TEOS-10 Manual.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">t_from_pt0_ice</span><span class="p">(</span><span class="n">pt0_ice</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">t_from_pt0_ice</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">t_from_pt0_ice</span><span class="o">.</span><span class="n">types</span>
<span class="n">t_from_pt0_ice</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">t_from_pt0_ice</span><span class="p">)</span>

<div class="viewcode-block" id="thermobaric">
<a class="viewcode-back" href="../../gsw_flat.html#gsw.conversions.thermobaric">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">thermobaric</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the thermobaric coefficient of seawater with respect to</span>
<span class="sd">    Conservative Temperature.  This routine is based on the</span>
<span class="sd">    computationally-efficient expression for specific volume in terms of</span>
<span class="sd">    SA, CT and p (Roquet et al., 2015).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    SA : array-like</span>
<span class="sd">        Absolute Salinity, g/kg</span>
<span class="sd">    CT : array-like</span>
<span class="sd">        Conservative Temperature (ITS-90), degrees C</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    thermobaric : array-like, 1/(K Pa)</span>
<span class="sd">        thermobaric coefficient with</span>
<span class="sd">        respect to Conservative Temperature.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>
<span class="sd">    See Eqns. (3.8.2) and (P.2) of this TEOS-10 manual.</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">thermobaric</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<span class="n">thermobaric</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">thermobaric</span><span class="o">.</span><span class="n">types</span>
<span class="n">thermobaric</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">thermobaric</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">z_from_p</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">geo_strf_dyn_height</span><span class="p">,</span> <span class="n">sea_surface_geopotential</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates height from sea pressure using the computationally-efficient</span>
<span class="sd">    75-term expression for specific volume in terms of SA, CT and p</span>
<span class="sd">    (Roquet et al., 2015).  Dynamic height anomaly, geo_strf_dyn_height, if</span>
<span class="sd">    provided, must be computed with its p_ref = 0 (the surface).  Also if</span>
<span class="sd">    provided, sea_surface_geopotental is the geopotential at zero sea</span>
<span class="sd">    pressure. This function solves Eqn.(3.32.3) of IOC et al. (2010).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    p : array-like</span>
<span class="sd">        Sea pressure (absolute pressure minus 10.1325 dbar), dbar</span>
<span class="sd">    lat : array-like</span>
<span class="sd">        Latitude, -90 to 90 degrees</span>
<span class="sd">    geo_strf_dyn_height : array-like</span>
<span class="sd">        dynamic height anomaly, m^2/s^2</span>
<span class="sd">            Note that the reference pressure, p_ref, of geo_strf_dyn_height must</span>
<span class="sd">            be zero (0) dbar.</span>
<span class="sd">    sea_surface_geopotential : array-like</span>
<span class="sd">        geopotential at zero sea pressure,  m^2/s^2</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    z : array-like, m</span>
<span class="sd">        height</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Note. Height z is NEGATIVE in the ocean. i.e. Depth is -z.</span>
<span class="sd">    Depth is not used in the GSW computer software library.</span>

<span class="sd">    Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="sd">    parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="sd">    described in McDougall et al. (2003).  The GSW library function</span>
<span class="sd">    &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="sd">    some of one&#39;s data lies outside this &quot;funnel&quot;.</span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="sd">    seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="sd">    Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="sd">    UNESCO (English), 196 pp.  Available from https://www.teos-10.org/</span>

<span class="sd">    McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="sd">    Accurate and computationally efficient algorithms for potential</span>
<span class="sd">    temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="sd">    pp. 730-741.</span>

<span class="sd">    Moritz, H., 2000: Geodetic reference system 1980. J. Geodesy, 74,</span>
<span class="sd">    pp. 128-133.</span>

<span class="sd">    Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="sd">    polynomial expressions for the density and specific volume of seawater</span>
<span class="sd">    using the TEOS-10 standard. Ocean Modelling, 90, pp. 29-43.</span>

<span class="sd">    This software is available from https://www.teos-10.org/</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">z_from_p</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">geo_strf_dyn_height</span><span class="p">,</span> <span class="n">sea_surface_geopotential</span><span class="p">)</span>
<span class="n">z_from_p</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">_gsw_ufuncs</span><span class="o">.</span><span class="n">z_from_p</span><span class="o">.</span><span class="n">types</span>
<span class="n">z_from_p</span> <span class="o">=</span> <span class="n">match_args_return</span><span class="p">(</span><span class="n">z_from_p</span><span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, TEOS-10 developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>